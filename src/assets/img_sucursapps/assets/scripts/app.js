"use strict";angular.module("SucursApps",["ngTouch","LocalStorageModule","tmh.dynamicLocale","ngResource","ui.router","ngCookies","ngCacheBuster","ngAnimate","autocomplete","sessiontimeout","PumaService","ng-q-timeout","donutChart"]).run(function($rootScope,$location,$window,$http,$state,$templateCache,Auth,Principal,SessionService,PumaService,ENV,SERVICES_URL){$rootScope.ENV=ENV,$rootScope.SERVICES_URL=SERVICES_URL,$rootScope.principal=Principal,$rootScope.currentFlow=null,$rootScope.httpQueue=0,"dev"===ENV&&$rootScope.$on("$viewContentLoaded",function(){$templateCache.removeAll()}),$rootScope.$on("on-kiosk-finish-timeout-redirect",function(event){SessionService.logout(),Principal.authenticate(void 0),$state.go("kiosk.home")}),$rootScope.$on("session-timeout",function(event){Principal.isAuthenticated()&&(SessionService.logout(),Principal.authenticate(void 0),$("#modalSesionTerminada").modal("show"),$rootScope.currentFlow&&"kiosk"===$rootScope.currentFlow?$state.go("kiosk.home"):$state.go("home"))}),$rootScope.$on("$stateChangeStart",function(event,toState,toStateParams){$rootScope.toState=toState,$rootScope.toStateParams=toStateParams}),$rootScope.$on("$stateChangeSuccess",function(event,toState,toParams,fromState,fromParams){$rootScope.previousStateName=fromState.name,$rootScope.previousStateParams=fromParams}),$rootScope.back=function(){"activate"===$rootScope.previousStateName||null===$state.get($rootScope.previousStateName)?$state.go("home"):$state.go($rootScope.previousStateName,$rootScope.previousStateParams)}}).config(function($stateProvider,$urlRouterProvider,$httpProvider,$locationProvider,httpRequestInterceptorCacheBusterProvider){$httpProvider.defaults.xsrfCookieName="CSRF-TOKEN",$httpProvider.defaults.xsrfHeaderName="X-CSRF-TOKEN",$httpProvider.defaults.withCredentials=!0,delete $httpProvider.defaults.headers.common["X-Requested-With"],$httpProvider.defaults.useXDomain=!0,$httpProvider.interceptors.push(["$q","$rootScope","$location",function($q,$rootScope,$location){return{request:function(config){return config||$q.when(config)},response:function(response){return response||$q.when(response)},responseError:function(rejection){return angular.isDefined(rejection)?401===rejection.status&&($rootScope.principal.authenticate(void 0),$("#modalError401").modal("show"),$location.path("/home"),$location.path("/home").search("returnTo",$location.path())):$location.path("/home"),$q.reject(rejection)},requestError:function(rejection){return $q.reject(rejection)}}}]),$urlRouterProvider.otherwise("/home"),$stateProvider.state("site",{"abstract":!0,views:{"navbar@":{templateUrl:"scripts/components/navbar/navbar-empty.html",controller:"NavbarController"}}})}),angular.module("SucursApps").constant("ENV","prod").constant("SERVICES_URL","/sucursapps").constant("BASE_URL","/img_sucursapps/").constant("ENCUESTA_URL","https://15.128.25.221:8443/encuesta/index.html?idCamp=1").constant("SESSION_TIMEOUT",18e4),angular.module("SucursApps").factory("Auth",function($rootScope,$state,$q,$timeout,Principal,AuthServerProvider,Account,SessionService,McaSessionService,PinPadWrapperService,PumaService){return{loginUser:function(credentials){var deferred=$q.defer();return SessionService.uval(credentials).then(function(data){data.sts&&"NOK"===data.sts&&deferred.reject(data),deferred.resolve(data)})["catch"](function(err){SessionService.logout(),Principal.authenticate(null),deferred.reject(err)}),deferred.promise},loginPasswordToken:function(credentials){var deferred=$q.defer();return SessionService.uaut(credentials).then(function(data){data.sts&&"NOK"===data.sts&&deferred.reject(data),data.roles=["cliente"],Principal.identity(data),deferred.resolve(data)})["catch"](function(err){SessionService.logout(),Principal.authenticate(null),deferred.reject(err)}),deferred.promise},loginCardNumber:function(credentials){var deferred=$q.defer();return SessionService.tval(credentials).then(function(data){data.sts&&"NOK"===data.sts&&deferred.reject(data),data.roles=["cliente"],Principal.identity(data),deferred.resolve(data)})["catch"](function(err){SessionService.logout(),Principal.authenticate(null),deferred.reject(err)}),deferred.promise},loginCardNumber2:function(data){var deferred=$q.defer();return McaSessionService.tval(data).then(function(data){data.sts&&"NOK"===data.sts&&deferred.reject(data),data.roles=["cliente"],Principal.identity(data),deferred.resolve(data)})["catch"](function(err){Principal.authenticate(null),deferred.reject(err)}),deferred.promise},loginWincor:function(onCardRead,onPinPadKey,onPinRead){var deferred=$q.defer(),trk2="";return PumaService.connect().timeout(1e4).then(function(){return PumaService.readCard().timeout(1e4,function(inner_deferred){PumaService.cancelReadCard(!0)})}).then(function(result){return trk2=result.data,onCardRead(result),PumaService.readNip(trk2.substring(0,16),onPinPadKey).timeout(1e4,function(inner_deferred){PumaService.cancelReadNip(!0)})}).then(function(result){var data={tr2:trk2.substring(0,32),np:result.data,res:"OK"};return onPinRead(),McaSessionService.tval(data)}).then(function(result){result.roles=["cliente"],Principal.identity(result),deferred.resolve(result)})["catch"](function(err){console.log(err),SessionService.logout(),Principal.authenticate(void 0),deferred.reject(err)})["finally"](function(){PumaService.ejectCard()["finally"](function(){PumaService.disconnect()})}),deferred.promise},cancelLoginWincor:function(){PumaService.cancelReadCard().then(function(){return PumaService.ejectCard()})["finally"](function(){PumaService.disconnect()})},cancelPinBlock:function(){PumaService.cancelReadNip(),PumaService.ejectCard(),PumaService.disconnect()},logout:function(){SessionService.logout(),Principal.authenticate(void 0)},authorize:function(force,homeState){return Principal.identity(force).then(function(){var isAuthenticated=Principal.isAuthenticated();$rootScope.toState.data.roles&&$rootScope.toState.data.roles.length>0&&!Principal.isInAnyRole($rootScope.toState.data.roles)&&(isAuthenticated?$state.go("accessdenied"):($rootScope.returnToState=$rootScope.toState,$rootScope.returnToStateParams=$rootScope.toStateParams,$state.go(homeState||"home")))})}}}),angular.module("SucursApps").factory("Principal",function($q,Account){var _identity,_authenticated=!1;return{isIdentityResolved:function(){return angular.isDefined(_identity)},isFirstAuthenticated:function(){return _authenticated},isAuthenticated:function(){return _authenticated},isInRole:function(role){return _authenticated&&_identity&&_identity.roles?-1!==_identity.roles.indexOf(role):!1},isInAnyRole:function(roles){if(!_authenticated||!_identity.roles)return!1;for(var i=0;i<roles.length;i++)if(this.isInRole(roles[i]))return!0;return!1},authenticate:function(identity){_identity=identity,_authenticated=angular.isDefined(_identity)},identity:function(force){var deferred=$q.defer();return null===force&&(_identity=void 0),angular.isDefined(_identity)?(deferred.resolve(_identity),deferred.promise):(force&&(_identity=force,_authenticated=!0),deferred.resolve(_identity),deferred.promise)}}}),angular.module("SucursApps").factory("Account",function($resource){return $resource("api/account",{},{get:{method:"GET",params:{},isArray:!1,interceptor:{response:function(response){return response}}}})}),angular.module("SucursApps").directive("showValidation",function(){return{restrict:"A",require:"form",link:function(scope,element){element.find(".form-group").each(function(){var $formGroup=$(this),$inputs=$formGroup.find("input[ng-model],textarea[ng-model],select[ng-model]");$inputs.length>0&&$inputs.each(function(){var $input=$(this);scope.$watch(function(){return $input.hasClass("ng-invalid")&&$input.hasClass("ng-dirty")},function(isInvalid){$formGroup.toggleClass("has-error",isInvalid)})})})}}}),angular.module("SucursApps").directive("loadingIndicator",function(loadingCounts,$timeout){return{restrict:"A",link:function(scope,element,attrs){scope.$on("loading-started",function(e){loadingCounts.enable_count++,$timeout(function(){loadingCounts.enable_count>=loadingCounts.disable_count&&(console.log("show wait dialog: "+loadingCounts.enable_count),loadingCounts.modal=$(element).modal("show"))},500)}),scope.$on("loading-complete",function(e){loadingCounts.disable_count++,$timeout(function(){console.log("hide wait dialog: "+loadingCounts.disable_count),$(element).modal("hide")},500)})}}}),angular.module("SucursApps").factory("loadingCounts",function(){return{enable_count:0,disable_count:0,modal:{}}}),angular.module("SucursApps").directive("loadingIndicator2",["$http","$rootScope",function($http,$rootScope){return{link:function(scope,elm,attrs){$rootScope.spinnerActive=!1,scope.isLoading=function(){return $http.pendingRequests.length>0},scope.$watch(scope.isLoading,function(loading){$rootScope.spinnerActive=loading,loading?$(elm).modal("show"):$(elm).modal("hide")})}}}]),angular.module("SucursApps").directive("activeLink",function(location){return{restrict:"A",link:function(scope,element,attrs){var clazz=attrs.activeLink,path=attrs.href;path=path.substring(1),scope.location=location,scope.$watch("location.path()",function(newPath){path===newPath?element.addClass(clazz):element.removeClass(clazz)})}}}),angular.module("SucursApps").controller("NavbarController",function($scope,$location,$state,Auth,Principal,$rootScope){$scope.isAuthenticated=Principal.isAuthenticated,$scope.isInRole=Principal.isInRole,$scope.$state=$state,$scope.path=$location.$$path,$rootScope.$on("$locationChangeSuccess",function(event){$scope.path=$location.$$path}),$scope.logout=function(){Auth.logout(),$state.go("home.user")},$scope.showEncuestaModal=function(){$("#iFrameContenido").attr("src","/encuesta/preview.html?nameCampaign=CAMP_EXP_CLIENTE"),$("#encuestaModal").modal("show")}}).directive("iframeKeyboard",function(){return{restrict:"A",link:function(scope,ele,attrs){$(ele).load(function(){var body=this.contentDocument.body,move=100,elementLoaded=$(body).find("#content");console.log(elementLoaded);var input=$(body).find('input[type="password"], input[type="text"], input[type="tel"]');input.on("focus",function(){var offset=$(this).offset().top;if(offset>100)var bodyPosition=-(offset-move);input.closest(".modal").css("top",bodyPosition+"px"),angular.element(body).css({position:"absolute",top:bodyPosition+"px"})}),input.on("blur",function(){input.closest(".modal").css("top","0"),angular.element(body).css({position:"absolute",top:"0"})})})}}}),angular.module("SucursApps").controller("NavbarBxiController",function($scope,$location,$state,Auth,Principal){$scope.isAuthenticated=Principal.isAuthenticated,$scope.account=Principal.identity(),$scope.$state=$state,$scope.logout=function(){Auth.logout(),$state.go("home")}}),angular.module("SucursApps").controller("NavbarKioskController",function($scope,$location,$state,Auth,Principal,McaDetalleCuentaService){$scope.isAuthenticated=Principal.isAuthenticated,$scope.account=Principal.identity(),$scope.$state=$state,$scope.datosPersonales={},$scope.consultaSaldosBXI={},$scope.logout=function(){Auth.logout(),$state.go("kiosk.home")},Principal.identity().then(function(account){$scope.account=account,$scope.isAuthenticated=Principal.isAuthenticated})}),angular.module("SucursApps").factory("User",function($resource){return $resource("api/users/:login",{},{query:{method:"GET",isArray:!0},get:{method:"GET",transformResponse:function(data){return data=angular.fromJson(data)}}})}),angular.module("SucursApps").filter("characters",function(){return function(input,chars,breakOnWord){if(isNaN(chars))return input;if(0>=chars)return"";if(input&&input.length>chars){if(input=input.substring(0,chars),breakOnWord)for(;" "===input.charAt(input.length-1);)input=input.substr(0,input.length-1);else{var lastspace=input.lastIndexOf(" ");-1!==lastspace&&(input=input.substr(0,lastspace))}return input+"..."}return input}}).filter("words",function(){return function(input,words){if(isNaN(words))return input;if(0>=words)return"";if(input){var inputWords=input.split(/\s+/);inputWords.length>words&&(input=inputWords.slice(0,words).join(" ")+"...")}return input}}),angular.module("SucursApps").filter("accountmask",function(){return function(input){if(void 0!==input){var result="",strLength=input.length-4,lastChars=input.slice(strLength),customChars=Array(strLength).join("*");return result=customChars.concat(lastChars)}}}).filter("trim",function(){return function(value){return angular.isString(value)?value.replace(/^\s+|\s+$/g,""):value}}).directive("currency",["$filter",function($filter){return{require:"ngModel",restrict:"A",link:function(scope,elm,attrs,ngModel){elm.on("blur",function(event){elm.val($filter("currency")(ngModel.$modelValue||ngModel.$$rawModelValue))})}}}]).directive("mobileKeyboard",["$window",function($window){return{restrict:"A",link:function(scope,ele,attrs){var force=!1;if(navigator.userAgent.match(/TABLETHP/)||force){var body=angular.element(document).find("body")[0],move=100;scope.$watch(function(newValue,oldValue){var input=$(ele).find('input[type="password"], input[type="text"], input[type="tel"]');input.on("focus",function(){var offset=$(this).offset().top;if(offset>100)var bodyPosition=-(offset-move);input.closest(".modal").css("top",bodyPosition+"px"),angular.element(body).css({position:"absolute",top:bodyPosition+"px"})}),input.on("keydown keypress",function(event){13===event.which&&event.preventDefault()}),input.on("blur",function(){input.closest(".modal").css("top","0"),angular.element(body).css({position:"absolute",top:"0"})})})}}}}]).directive("ngMin",function(){return{restrict:"A",require:"ngModel",link:function(scope,elem,attr,ctrl){scope.$watch(attr.ngMin,function(){ctrl.$setViewValue(ctrl.$modelValue)});var minValidator=function(value){var min=attr.ngMin||0;return!isEmpty(value)&&min>value?(ctrl.$setValidity("ngMin",!1),value):(ctrl.$setValidity("ngMin",!0),value)},isEmpty=function(value){return angular.isUndefined(value)||""===value||null===value||value!==value};ctrl.$parsers.push(minValidator),ctrl.$formatters.push(minValidator)}}}).directive("ngMax",function(){return{restrict:"A",require:"ngModel",link:function(scope,elem,attr,ctrl){scope.$watch(attr.ngMax,function(){ctrl.$setViewValue(ctrl.$modelValue)});var maxValidator=function(value){var max=attr.ngMax||1/0;return!isEmpty(value)&&value>max?(ctrl.$setValidity("ngMax",!1),value):(ctrl.$setValidity("ngMax",!0),value)},isEmpty=function(value){return angular.isUndefined(value)||""===value||null===value||value!==value};ctrl.$parsers.push(maxValidator),ctrl.$formatters.push(maxValidator)}}}).directive("ngPayeeFieldValidator",["$filter",function($filter){return{restrict:"A",require:"ngModel",link:function($scope,$element,$attrs,ctrl){var longitudValidator=function(value){var longitud=$attrs.ngPayeeFieldValidator.substring(0,2);$attrs.ngPayeeFieldValidator.substring(2,4);return value.length<=longitud?(ctrl.$setValidity("ngPayeeFieldValidator",!0),$filter("numberFixedLen")(value,longitud)):(ctrl.$setValidity("ngPayeeFieldValidator",!1),value)};ctrl.$parsers.push(longitudValidator),ctrl.$formatters.push(longitudValidator)}}}]).filter("numberFixedLen",function(){return function(n,width,z){return z=z||"0",n+="",n.length>=width?n:new Array(width-n.length+1).join(z)+n}}).directive("invalidPopover",function(){return{restrict:"A",require:"ngModel",template:"<span>{{label}}</span>",link:function(scope,elem,attr,ngModel){scope.$watch(function(){return ngModel.$invalid&&ngModel.$dirty},function(newVal,oldVal){ngModel.$invalid&&ngModel.$dirty?($(elem).popover({trigger:"focus",html:!0,content:attr.invalidPopoverHtml,placement:attr.invalidPopoverPlacement}),$(elem).popover("show")):$(elem).popover("destroy")})}}}).directive("ngEnter",function(){return function(scope,element,attrs){element.bind("keydown keypress",function(event){13===event.which&&(attrs.ngEnter&&scope.$apply(function(){scope.$eval(attrs.ngEnter)}),event.preventDefault())})}}).directive("ngMatch",["$parse",function($parse){return{require:"?ngModel",restrict:"A",link:function(scope,elem,attrs,ctrl){function getMatchValue(){var match=matchGetter(scope);return angular.isObject(match)&&match.hasOwnProperty("$viewValue")&&(match=match.$viewValue),match}if(!ctrl)return void(console&&console.warn&&console.warn("Match validation requires ngModel to be on the element"));var matchGetter=$parse(attrs.ngMatch),caselessGetter=$parse(attrs.matchCaseless),noMatchGetter=$parse(attrs.notMatch);scope.$watch(getMatchValue,function(){ctrl.$$parseAndValidate()}),ctrl.$validators.match=function(){var value,match=getMatchValue(),notMatch=noMatchGetter(scope);return value=caselessGetter(scope)?angular.lowercase(ctrl.$viewValue)===angular.lowercase(match):ctrl.$viewValue===match,value^=notMatch,!!value}}}}]).directive("timeoutRedirect",["$rootScope","$timeout",function($rootScope,$timeout){return{restrict:"A",link:function(scope,element,attrs){var REDIRECT_TIMEOUT=5e3;$timeout(function(){$rootScope.$broadcast(attrs.timeoutRedirect)},REDIRECT_TIMEOUT)}}}]),angular.module("SucursApps").service("Base64",function(){var keyStr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";this.encode=function(input){for(var chr1,chr2,enc1,enc2,enc3,output="",chr3="",enc4="",i=0;i<input.length;)chr1=input.charCodeAt(i++),chr2=input.charCodeAt(i++),chr3=input.charCodeAt(i++),enc1=chr1>>2,enc2=(3&chr1)<<4|chr2>>4,enc3=(15&chr2)<<2|chr3>>6,enc4=63&chr3,isNaN(chr2)?enc3=enc4=64:isNaN(chr3)&&(enc4=64),output=output+keyStr.charAt(enc1)+keyStr.charAt(enc2)+keyStr.charAt(enc3)+keyStr.charAt(enc4),chr1=chr2=chr3="",enc1=enc2=enc3=enc4="";return output},this.decode=function(input){var chr1,chr2,enc1,enc2,enc3,output="",chr3="",enc4="",i=0;for(input=input.replace(/[^A-Za-z0-9\+\/\=]/g,"");i<input.length;)enc1=keyStr.indexOf(input.charAt(i++)),enc2=keyStr.indexOf(input.charAt(i++)),enc3=keyStr.indexOf(input.charAt(i++)),enc4=keyStr.indexOf(input.charAt(i++)),chr1=enc1<<2|enc2>>4,chr2=(15&enc2)<<4|enc3>>2,chr3=(3&enc3)<<6|enc4,output+=String.fromCharCode(chr1),64!==enc3&&(output+=String.fromCharCode(chr2)),64!==enc4&&(output+=String.fromCharCode(chr3)),chr1=chr2=chr3="",enc1=enc2=enc3=enc4=""}}).factory("StorageService",function($window){return{get:function(key){return JSON.parse($window.localStorage.getItem(key))},save:function(key,data){$window.localStorage.setItem(key,JSON.stringify(data))},remove:function(key){$window.localStorage.removeItem(key)},clearAll:function(){$window.localStorage.clear()}}}),angular.module("SucursApps").service("ParseLinks",function(){this.parse=function(header){if(0==header.length)throw new Error("input must not be of zero length");var parts=header.split(","),links={};return angular.forEach(parts,function(p){var section=p.split(";");if(2!=section.length)throw new Error("section could not be split on ';'");var url=section[0].replace(/<(.*)>/,"$1").trim(),queryString={};url.replace(new RegExp("([^?=&]+)(=([^&]*))?","g"),function($0,$1,$2,$3){queryString[$1]=$3});var page=queryString.page;angular.isString(page)&&(page=parseInt(page));var name=section[1].replace(/rel="(.*)"/,"$1").trim();links[name]=page}),links}}),angular.module("SucursApps").filter("startFrom",function(){return function(input,start){return input?(start=+start,input.slice(start)):null}});var appx=angular.module("autocomplete",[]);appx.directive("autocomplete",function(){var index=-1;return{restrict:"E",scope:{searchParam:"=ngModel",suggestions:"=data",onType:"=onType",onSelect:"=onSelect",autocompleteRequired:"="},controller:["$scope",function($scope){$scope.selectedIndex=-1,$scope.initLock=!0,$scope.setIndex=function(i){$scope.selectedIndex=parseInt(i)},this.setIndex=function(i){$scope.setIndex(i),$scope.$apply()},$scope.getIndex=function(i){return $scope.selectedIndex};var watching=!0;$scope.completing=!1,$scope.$watch("searchParam",function(newValue,oldValue){oldValue===newValue||!oldValue&&$scope.initLock||(watching&&"undefined"!=typeof $scope.searchParam&&null!==$scope.searchParam&&($scope.completing=!0,$scope.searchFilter=$scope.searchParam,$scope.selectedIndex=-1),$scope.onType&&$scope.onType($scope.searchParam))}),this.preSelect=function(suggestion){watching=!1,$scope.$apply(),watching=!0},$scope.preSelect=this.preSelect,this.preSelectOff=function(){watching=!0},$scope.preSelectOff=this.preSelectOff,$scope.select=function(suggestion){suggestion&&($scope.searchParam=suggestion,$scope.searchFilter=suggestion,$scope.onSelect&&$scope.onSelect(suggestion)),watching=!1,$scope.completing=!1,setTimeout(function(){watching=!0},1e3),$scope.setIndex(-1)}}],link:function(scope,element,attrs){setTimeout(function(){scope.initLock=!1,scope.$apply()},250);var attr="";if(scope.attrs={placeholder:"start typing...","class":"",id:"",inputclass:"",inputid:""},attrs)for(var a in attrs)attr=a.replace("attr","").toLowerCase(),0===a.indexOf("attr")&&(scope.attrs[attr]=attrs[a]);attrs.clickActivation&&(element[0].onclick=function(e){scope.searchParam||setTimeout(function(){scope.completing=!0,scope.$apply()},200)});var key={left:37,up:38,right:39,down:40,enter:13,esc:27,tab:9};document.addEventListener("keydown",function(e){var keycode=e.keyCode||e.which;switch(keycode){case key.esc:scope.select(),scope.setIndex(-1),scope.$apply(),e.preventDefault()}},!0),document.addEventListener("blur",function(e){setTimeout(function(){scope.select(),scope.setIndex(-1),scope.$apply()},150)},!0),element[0].addEventListener("keydown",function(e){var keycode=e.keyCode||e.which,l=angular.element(this).find("li").length;if(scope.completing&&0!=l)switch(keycode){case key.up:if(index=scope.getIndex()-1,-1>index)index=l-1;else if(index>=l){index=-1,scope.setIndex(index),scope.preSelectOff();break}scope.setIndex(index),-1!==index&&scope.preSelect(angular.element(angular.element(this).find("li")[index]).text()),scope.$apply();break;case key.down:if(index=scope.getIndex()+1,-1>index)index=l-1;else if(index>=l){index=-1,scope.setIndex(index),scope.preSelectOff(),scope.$apply();break}scope.setIndex(index),-1!==index&&scope.preSelect(angular.element(angular.element(this).find("li")[index]).text());break;case key.left:break;case key.right:case key.enter:case key.tab:index=scope.getIndex(),-1!==index?(scope.select(angular.element(angular.element(this).find("li")[index]).text()),keycode==key.enter&&e.preventDefault()):keycode==key.enter&&scope.select(),scope.setIndex(-1),scope.$apply();break;case key.esc:scope.select(),scope.setIndex(-1),scope.$apply(),e.preventDefault();break;default:return}})},template:'        <div class="autocomplete {{ attrs.class }}" id="{{ attrs.id }}">          <input            type="text"            ng-model="searchParam"            placeholder="{{ attrs.placeholder }}"            class="{{ attrs.inputclass }}"            id="{{ attrs.inputid }}"            ng-required="{{ autocompleteRequired }}" />          <ul ng-show="completing && (suggestions | startsWith:searchFilter).length > 0">            <li              suggestion              ng-repeat="suggestion in suggestions | startsWith:searchFilter track by $index"              index="{{ $index }}"              val="{{ suggestion }}"              ng-class="{ active: ($index === selectedIndex) }"              ng-click="select(suggestion)"              ng-bind-html="suggestion | element"></li>          </ul>        </div>'}}),appx.filter("highlight",["$sce",function($sce){return function(input,searchParam){if("function"==typeof input)return"";if(searchParam){var words="("+searchParam.split(/\ /).join(" |")+"|"+searchParam.split(/\ /).join("|")+")",exp=new RegExp(words,"gi");words.length&&(input=input.replace(exp,'<span class="highlight">$1</span>'))}return $sce.trustAsHtml(input)}}]),appx.filter("element",["$sce",function($sce){return function(input,searchParam){return"function"==typeof input?"":$sce.trustAsHtml(input)}}]),appx.directive("suggestion",function(){return{restrict:"A",require:"^autocomplete",link:function(scope,element,attrs,autoCtrl){element.bind("mouseenter",function(){autoCtrl.preSelect(attrs.val),autoCtrl.setIndex(attrs.index)}),element.bind("mouseleave",function(){autoCtrl.preSelectOff()})}}}),appx.filter("startsWith",function(){return function(items,prefix,itemProperty){return items.filter(function(item){if(prefix){var findIn=itemProperty?item[itemProperty]:item;return 0===findIn.toString().toLowerCase().indexOf(prefix.toLowerCase())}return!1})}}),angular.module("SucursApps").factory("Utils",function($q,$timeout){return{safeTrim:function(data){return data?data.replace(/^\s+|\s+$/gm,""):""}}}),angular.module("SucursApps").factory("PinPadProvider",function($http,$q){return{getCardInfo:function(){var deferred=$q.defer(),data=null;return data="undefined"==typeof PinPadInterface?{tr2:"4189281040014954=150822110000790",np:"958C34C90BDED210",res:"OK",des:"OK"}:PinPadInterface.getCardInfo(),deferred.resolve(data),deferred.promise}}}),angular.module("donutChart",[]).directive("chart",["$http",function($http){return{restrict:"EA",scope:{canvasWidth:"=canvasWidth",canvasHeight:"=canvasHeight"},link:function($scope,elements,attrs){function relax(){again=!1,labelValueGroup.each(function(d,i){a=this,da=d3.select(a),y1=d3.transform(da.attr("transform")).translate[1],labelValueGroup.each(function(d,j){b=this,a!=b&&(db=d3.select(b),da.attr("text-anchor")==db.attr("text-anchor")&&(y2=d3.transform(db.attr("transform")).translate[1],deltaY=y1-y2,Math.abs(deltaY)>spacing||(again=!0,sign=deltaY>0?1:-1,adjust=sign*alpha,da.attr("transform","translate("+d3.transform(da.attr("transform")).translate[0]+","+(y1+adjust)+")"),db.attr("transform","translate("+d3.transform(db.attr("transform")).translate[0]+","+(y2-adjust)+")"))))})}),again&&(elements=labelValueGroup[0],textLines.attr("y2",function(d,i){return labelForLine=d3.select(elements[i]),d3.transform(labelForLine.attr("transform")).translate[1]}),setTimeout(relax,20))}var data=[{label:"Star Wars",instances:207},{label:"Lost In Space",instances:3},{label:"the Boston Pops",instances:20},{label:"Indiana Jones",instances:150},{label:"Harry Potter",instances:75},{label:"Jaws",instances:5},{label:"Lincoln",instances:1}];svg=d3.select(elements[0]),canvas=svg.append("g"),art=canvas.append("g"),labels=canvas.append("g"),jhw_pie=d3.layout.pie(),jhw_pie.value(function(d,i){return d.instances}),cDim={height:500,width:900,innerRadius:50,outerRadius:150,labelRadius:200},svg.attr({height:cDim.height,width:cDim.width}),canvas.attr("transform","translate("+cDim.width/2+","+cDim.height/2+")"),pied_data=jhw_pie(data),pied_arc=d3.svg.arc().innerRadius(50).outerRadius(150),pied_colors=d3.scale.category10(),enteringArcs=art.selectAll(".wedge").data(pied_data).enter(),enteringArcs.append("path").attr("class","wedge").attr("d",pied_arc).style("fill",function(d,i){return pied_colors(i)}),enteringLabels=labels.selectAll(".label").data(pied_data).enter(),labelGroups=enteringLabels.append("g").attr("class","label"),labelGroups.append("circle").attr({x:0,y:0,r:2,fill:"#000",transform:function(d,i){return centroid=pied_arc.centroid(d),"translate("+pied_arc.centroid(d)+")"},"class":"label-circle"}),textLines=labelGroups.append("line").attr({x1:function(d,i){return pied_arc.centroid(d)[0]},y1:function(d,i){return pied_arc.centroid(d)[1]},x2:function(d,i){return centroid=pied_arc.centroid(d),midAngle=Math.atan2(centroid[1],centroid[0]),x=Math.cos(midAngle)*cDim.labelRadius,x},y2:function(d,i){return centroid=pied_arc.centroid(d),midAngle=Math.atan2(centroid[1],centroid[0]),y=Math.sin(midAngle)*cDim.labelRadius,y},"class":"label-line"}),labelValueGroup=labelGroups.append("g").attr({transform:function(d,i){return centroid=pied_arc.centroid(d),midAngle=Math.atan2(centroid[1],centroid[0]),x=Math.cos(midAngle)*cDim.labelRadius,d.sign=x>0?1:-1,labelX=x+5*d.sign,centroid=pied_arc.centroid(d),midAngle=Math.atan2(centroid[1],centroid[0]),y=Math.sin(midAngle)*cDim.labelRadius,"translate("+labelX+","+y+")"},"text-anchor":function(d,i){return centroid=pied_arc.centroid(d),midAngle=Math.atan2(centroid[1],centroid[0]),x=Math.cos(midAngle)*cDim.labelRadius,x>0?"start":"end"},"class":"label-text"}),nameLabels=labelValueGroup.append("text").text(function(d){return d.data.label}).attr({x:function(d){return 50*d.sign},y:0}),labelValueGroup.append("text").text(function(d){return d.data.label+" - 02"}).attr({x:function(d){return 50*d.sign},y:12}),labelValueGroup.append("rect").attr({x:function(d){return 50*d.sign},y:16,width:30,height:32}),labelValueGroup.append("text").text(function(d){return"EDITAR"}).attr({x:function(d){return 50*d.sign},y:24}),alpha=.5,spacing=32,relax()}}}]),angular.module("donutChart",[]).directive("chartTwo",["$http",function($http){return{restrict:"EA",scope:{canvasWidth:"=canvasWidth",canvasHeight:"=canvasHeight"},link:function($scope,elements,attrs){function randomData(){var labels=color.domain();return labels.map(function(label){return{label:label,value:Math.random()}}).filter(function(){return Math.random()>.5}).sort(function(a,b){return d3.ascending(a.label,b.label)})}function mergeWithFirstEqualZero(first,second){var secondSet=d3.set();second.forEach(function(d){secondSet.add(d.label)});var onlyFirst=first.filter(function(d){return!secondSet.has(d.label)}).map(function(d){return{label:d.label,value:0}});return d3.merge([second,onlyFirst]).sort(function(a,b){return d3.ascending(a.label,b.label)})}function change(data){function midAngle(d){return d.startAngle+(d.endAngle-d.startAngle)/2}var duration=+document.getElementById("duration").value,data0=svg.select(".slices").selectAll("path.slice").data().map(function(d){return d.data});0==data0.length&&(data0=data);var was=mergeWithFirstEqualZero(data,data0),is=mergeWithFirstEqualZero(data0,data),slice=svg.select(".slices").selectAll("path.slice").data(pie(was),key);slice.enter().insert("path").attr("class","slice").style("fill",function(d){return color(d.data.label)}).each(function(d){this._current=d}),slice=svg.select(".slices").selectAll("path.slice").data(pie(is),key),slice.transition().duration(duration).attrTween("d",function(d){var interpolate=d3.interpolate(this._current,d),_this=this;return function(t){return _this._current=interpolate(t),arc(_this._current)}}),slice=svg.select(".slices").selectAll("path.slice").data(pie(data),key),slice.exit().transition().delay(duration).duration(0).remove();var text=svg.select(".labels").selectAll("text").data(pie(was),key);text.enter().append("text").attr("dy",".35em").style("opacity",0).text(function(d){return d.data.label}).each(function(d){this._current=d}),text=svg.select(".labels").selectAll("text").data(pie(is),key),text.transition().duration(duration).style("opacity",function(d){return 0==d.data.value?0:1}).attrTween("transform",function(d){var interpolate=d3.interpolate(this._current,d),_this=this;return function(t){var d2=interpolate(t);_this._current=d2;var pos=outerArc.centroid(d2);return pos[0]=radius*(midAngle(d2)<Math.PI?1:-1),"translate("+pos+")"}}).styleTween("text-anchor",function(d){var interpolate=d3.interpolate(this._current,d);return function(t){var d2=interpolate(t);return midAngle(d2)<Math.PI?"start":"end"}}),text=svg.select(".labels").selectAll("text").data(pie(data),key),text.exit().transition().delay(duration).remove();var polyline=svg.select(".lines").selectAll("polyline").data(pie(was),key);polyline.enter().append("polyline").style("opacity",0).each(function(d){this._current=d}),polyline=svg.select(".lines").selectAll("polyline").data(pie(is),key),polyline.transition().duration(duration).style("opacity",function(d){return 0==d.data.value?0:.5}).attrTween("points",function(d){this._current=this._current;var interpolate=d3.interpolate(this._current,d),_this=this;return function(t){var d2=interpolate(t);_this._current=d2;var pos=outerArc.centroid(d2);return pos[0]=.95*radius*(midAngle(d2)<Math.PI?1:-1),[arc.centroid(d2),outerArc.centroid(d2),pos]}}),polyline=svg.select(".lines").selectAll("polyline").data(pie(data),key),polyline.exit().transition().delay(duration).remove()}var svg=d3.select(elements[0]).append("svg").append("g");
svg.append("g").attr("class","slices"),svg.append("g").attr("class","labels"),svg.append("g").attr("class","lines");var width=960,height=450,radius=Math.min(width,height)/2,pie=d3.layout.pie().sort(null).value(function(d){return d.value}),arc=d3.svg.arc().outerRadius(.8*radius).innerRadius(.4*radius),outerArc=d3.svg.arc().innerRadius(.9*radius).outerRadius(.9*radius);svg.attr("transform","translate("+width/2+","+height/2+")");var key=function(d){return d.data.label},color=d3.scale.category20().domain(["Lorem ipsum","dolor sit","amet","consectetur","adipisicing","elit","sed","do","eiusmod","tempor","incididunt"]);change(randomData()),d3.select(".randomize").on("click",function(){change(randomData())})}}}]),angular.module("donutChart",[]).directive("chartThree",["$http",function($http){return{restrict:"EA",scope:{canvasWidth:"=canvasWidth",canvasHeight:"=canvasHeight",chartData:"=chartData",onClick:"&"},link:function($scope,elements,attrs){$scope.svg=d3.select(elements[0]).append("svg").append("g"),$scope.factor=.6,$scope.percentageFormat=d3.format("%"),$scope.svg.append("g").attr("class","slices"),$scope.svg.append("g").attr("class","labels"),$scope.svg.append("g").attr("class","lines"),$scope.svg.append("g").attr("class","legend"),$scope.width=800,$scope.height=250,$scope.radius=Math.min($scope.width,$scope.height)/2,$scope.pie=d3.layout.pie().sort(null).value(function(d){return d.porcentajeBenef}),$scope.arc=d3.svg.arc().outerRadius(.9*$scope.radius).innerRadius(.3*$scope.radius),$scope.outerArc=d3.svg.arc().innerRadius(.9*$scope.radius).outerRadius(.95*$scope.radius),$scope.svg.attr("transform","translate("+$scope.width/2+","+$scope.height/2+")"),$scope.key=function(d){return d.data.numeroConsecutiv},$scope.midAngle=function(d){return d.startAngle+(d.endAngle-d.startAngle)/2},$scope.color=d3.scale.category10(),$scope.$watch("chartData",function(newValue,oldValue){newValue&&$scope.init(newValue)}),$scope.onElementClick=function(d,i){return $scope.onClick({data:d.data})},$scope.init=function(data){data.forEach(function(d){console.log("porcentajeBenef: "+d.porcentajeBenef),d.percentage=d.porcentajeBenef/100}),$scope.slice=$scope.svg.select(".slices").selectAll("path.slice").data($scope.pie(data),$scope.key),$scope.slice.enter().insert("path").style("fill",function(d,i){return $scope.color(i)}).attr("class","slice"),$scope.slice.transition().duration(1e3).attrTween("d",function(d){this._current=this._current||d;var interpolate=d3.interpolate(this._current,d);return this._current=interpolate(0),function(t){return $scope.arc(interpolate(t))}}),$scope.slice.exit().remove(),$scope.text=$scope.svg.select(".labels").selectAll("text").data($scope.pie(data),$scope.key),$scope.label=$scope.text.enter().append("g").style("fill","#646677").attr("class","label"),$scope.buttons=$scope.text.append("rect"),$scope.text.append("text").attr("dy","1.35em").text(function(d){return d.data.nombreBeneficia.trim()+" "+d.data.apPaternoBenef.trim()+" "+d.data.apMaternoBenef.trim()}),$scope.text.append("text").attr("dy","4em").attr("class","editar").style("fill","#FFFFFF").text(function(d){return"EDITAR"}).each(function(d){d.editBBox=this.getBBox()}),$scope.text.attr("transform",function(d){var pos=$scope.outerArc.centroid(d);return pos[0]=$scope.radius*($scope.midAngle(d)<Math.PI?1:-1),"translate("+pos+")"}).style("text-anchor",function(d){return d.anchor=$scope.midAngle(d)<Math.PI?"start":"end",d.anchor}),$scope.buttons.style("fill","#B01657").attr("x",function(d){return"start"===d.anchor?d.editBBox.x-10:d.editBBox.x-d.editBBox.width-10}).attr("y",function(d){return d.editBBox.y-10}).attr("width",function(d){return d.editBBox.width+20}).attr("height",function(d){return d.editBBox.height+20}),$scope.text.append("text").attr("dy",".35em").style("font-weight","bold").text(function(d){return console.log("percentage-format: "+d.data.percentage),$scope.percentageFormat(d.data.percentage)}),$scope.label.on("click",$scope.onElementClick),$scope.text.exit().remove();var legendHeight=46,actualLegendHeight=data.length*legendHeight,availableLegendHeight=$scope.radius*$scope.factor*2.9,polyline=((availableLegendHeight-actualLegendHeight)/2-$scope.radius*$scope.factor,$scope.svg.select(".lines").selectAll("polyline").data($scope.pie(data),$scope.key));polyline.enter().append("polyline"),polyline.attr("points",function(d){var pos=$scope.outerArc.centroid(d);return pos[0]=.95*$scope.radius*($scope.midAngle(d)<Math.PI?1:-1),[$scope.arc.centroid(d),$scope.outerArc.centroid(d),pos]}),polyline.exit().remove()}}}}]),angular.module("ui.bootstrap",["ui.bootstrap.tpls","ui.bootstrap.collapse","ui.bootstrap.accordion","ui.bootstrap.alert","ui.bootstrap.bindHtml","ui.bootstrap.buttons","ui.bootstrap.carousel","ui.bootstrap.dateparser","ui.bootstrap.position","ui.bootstrap.datepicker","ui.bootstrap.dropdown","ui.bootstrap.modal","ui.bootstrap.pagination","ui.bootstrap.tooltip","ui.bootstrap.popover","ui.bootstrap.progressbar","ui.bootstrap.rating","ui.bootstrap.tabs","ui.bootstrap.timepicker","ui.bootstrap.transition","ui.bootstrap.typeahead"]),angular.module("ui.bootstrap.tpls",["template/accordion/accordion-group.html","template/accordion/accordion.html","template/alert/alert.html","template/carousel/carousel.html","template/carousel/slide.html","template/datepicker/datepicker.html","template/datepicker/day.html","template/datepicker/month.html","template/datepicker/popup.html","template/datepicker/year.html","template/modal/backdrop.html","template/modal/window.html","template/pagination/pager.html","template/pagination/pagination.html","template/tooltip/tooltip-html-popup.html","template/tooltip/tooltip-html-unsafe-popup.html","template/tooltip/tooltip-popup.html","template/tooltip/tooltip-template-popup.html","template/popover/popover-template.html","template/popover/popover.html","template/progressbar/bar.html","template/progressbar/progress.html","template/progressbar/progressbar.html","template/rating/rating.html","template/tabs/tab.html","template/tabs/tabset.html","template/timepicker/timepicker.html","template/typeahead/typeahead-match.html","template/typeahead/typeahead-popup.html"]),angular.module("ui.bootstrap.collapse",[]).directive("collapse",["$animate",function(a){return{link:function(b,c,d){function e(){c.removeClass("collapse").addClass("collapsing"),a.addClass(c,"in",{to:{height:c[0].scrollHeight+"px"}}).then(f)}function f(){c.removeClass("collapsing"),c.css({height:"auto"})}function g(){c.css({height:c[0].scrollHeight+"px"}).removeClass("collapse").addClass("collapsing"),a.removeClass(c,"in",{to:{height:"0"}}).then(h)}function h(){c.css({height:"0"}),c.removeClass("collapsing"),c.addClass("collapse")}b.$watch(d.collapse,function(a){a?g():e()})}}}]),angular.module("ui.bootstrap.accordion",["ui.bootstrap.collapse"]).constant("accordionConfig",{closeOthers:!0}).controller("AccordionController",["$scope","$attrs","accordionConfig",function(a,b,c){this.groups=[],this.closeOthers=function(d){var e=angular.isDefined(b.closeOthers)?a.$eval(b.closeOthers):c.closeOthers;e&&angular.forEach(this.groups,function(a){a!==d&&(a.isOpen=!1)})},this.addGroup=function(a){var b=this;this.groups.push(a),a.$on("$destroy",function(){b.removeGroup(a)})},this.removeGroup=function(a){var b=this.groups.indexOf(a);-1!==b&&this.groups.splice(b,1)}}]).directive("accordion",function(){return{restrict:"EA",controller:"AccordionController",transclude:!0,replace:!1,templateUrl:"template/accordion/accordion.html"}}).directive("accordionGroup",function(){return{require:"^accordion",restrict:"EA",transclude:!0,replace:!0,templateUrl:"template/accordion/accordion-group.html",scope:{heading:"@",isOpen:"=?",isDisabled:"=?"},controller:function(){this.setHeading=function(a){this.heading=a}},link:function(a,b,c,d){d.addGroup(a),a.$watch("isOpen",function(b){b&&d.closeOthers(a)}),a.toggleOpen=function(){a.isDisabled||(a.isOpen=!a.isOpen)}}}}).directive("accordionHeading",function(){return{restrict:"EA",transclude:!0,template:"",replace:!0,require:"^accordionGroup",link:function(a,b,c,d,e){d.setHeading(e(a,angular.noop))}}}).directive("accordionTransclude",function(){return{require:"^accordionGroup",link:function(a,b,c,d){a.$watch(function(){return d[c.accordionTransclude]},function(a){a&&(b.html(""),b.append(a))})}}}),angular.module("ui.bootstrap.alert",[]).controller("AlertController",["$scope","$attrs",function(a,b){a.closeable="close"in b,this.close=a.close}]).directive("alert",function(){return{restrict:"EA",controller:"AlertController",templateUrl:"template/alert/alert.html",transclude:!0,replace:!0,scope:{type:"@",close:"&"}}}).directive("dismissOnTimeout",["$timeout",function(a){return{require:"alert",link:function(b,c,d,e){a(function(){e.close()},parseInt(d.dismissOnTimeout,10))}}}]),angular.module("ui.bootstrap.bindHtml",[]).directive("bindHtmlUnsafe",function(){return function(a,b,c){b.addClass("ng-binding").data("$binding",c.bindHtmlUnsafe),a.$watch(c.bindHtmlUnsafe,function(a){b.html(a||"")})}}),angular.module("ui.bootstrap.buttons",[]).constant("buttonConfig",{activeClass:"active",toggleEvent:"click"}).controller("ButtonsController",["buttonConfig",function(a){this.activeClass=a.activeClass||"active",this.toggleEvent=a.toggleEvent||"click"}]).directive("btnRadio",function(){return{require:["btnRadio","ngModel"],controller:"ButtonsController",link:function(a,b,c,d){var e=d[0],f=d[1];f.$render=function(){b.toggleClass(e.activeClass,angular.equals(f.$modelValue,a.$eval(c.btnRadio)))},b.bind(e.toggleEvent,function(){var d=b.hasClass(e.activeClass);(!d||angular.isDefined(c.uncheckable))&&a.$apply(function(){f.$setViewValue(d?null:a.$eval(c.btnRadio)),f.$render()})})}}}).directive("btnCheckbox",function(){return{require:["btnCheckbox","ngModel"],controller:"ButtonsController",link:function(a,b,c,d){function e(){return g(c.btnCheckboxTrue,!0)}function f(){return g(c.btnCheckboxFalse,!1)}function g(b,c){var d=a.$eval(b);return angular.isDefined(d)?d:c}var h=d[0],i=d[1];i.$render=function(){b.toggleClass(h.activeClass,angular.equals(i.$modelValue,e()))},b.bind(h.toggleEvent,function(){a.$apply(function(){i.$setViewValue(b.hasClass(h.activeClass)?f():e()),i.$render()})})}}}),angular.module("ui.bootstrap.carousel",[]).controller("CarouselController",["$scope","$interval","$animate",function(a,b,c){function d(a){if(angular.isUndefined(k[a].index))return k[a];var b;for(k.length,b=0;b<k.length;++b)if(k[b].index==a)return k[b]}function e(){f();var c=+a.interval;!isNaN(c)&&c>0&&(h=b(g,c))}function f(){h&&(b.cancel(h),h=null)}function g(){var b=+a.interval;i&&!isNaN(b)&&b>0?a.next():a.pause()}var h,i,j=this,k=j.slides=a.slides=[],l=-1;j.currentSlide=null;var m=!1;j.select=a.select=function(b,d){function f(){m||(angular.extend(b,{direction:d,active:!0}),angular.extend(j.currentSlide||{},{direction:d,active:!1}),c.enabled()&&!a.noTransition&&b.$element&&(a.$currentTransition=!0,b.$element.one("$animate:close",function(){a.$currentTransition=null})),j.currentSlide=b,l=g,e())}var g=j.indexOfSlide(b);void 0===d&&(d=g>j.getCurrentIndex()?"next":"prev"),b&&b!==j.currentSlide&&f()},a.$on("$destroy",function(){m=!0}),j.getCurrentIndex=function(){return j.currentSlide&&angular.isDefined(j.currentSlide.index)?+j.currentSlide.index:l},j.indexOfSlide=function(a){return angular.isDefined(a.index)?+a.index:k.indexOf(a)},a.next=function(){var b=(j.getCurrentIndex()+1)%k.length;return a.$currentTransition?void 0:j.select(d(b),"next")},a.prev=function(){var b=j.getCurrentIndex()-1<0?k.length-1:j.getCurrentIndex()-1;return a.$currentTransition?void 0:j.select(d(b),"prev")},a.isActive=function(a){return j.currentSlide===a},a.$watch("interval",e),a.$on("$destroy",f),a.play=function(){i||(i=!0,e())},a.pause=function(){a.noPause||(i=!1,f())},j.addSlide=function(b,c){b.$element=c,k.push(b),1===k.length||b.active?(j.select(k[k.length-1]),1==k.length&&a.play()):b.active=!1},j.removeSlide=function(a){angular.isDefined(a.index)&&k.sort(function(a,b){return+a.index>+b.index});var b=k.indexOf(a);k.splice(b,1),k.length>0&&a.active?j.select(b>=k.length?k[b-1]:k[b]):l>b&&l--}}]).directive("carousel",[function(){return{restrict:"EA",transclude:!0,replace:!0,controller:"CarouselController",require:"carousel",templateUrl:"template/carousel/carousel.html",scope:{interval:"=",noTransition:"=",noPause:"="}}}]).directive("slide",function(){return{require:"^carousel",restrict:"EA",transclude:!0,replace:!0,templateUrl:"template/carousel/slide.html",scope:{active:"=?",index:"=?"},link:function(a,b,c,d){d.addSlide(a,b),a.$on("$destroy",function(){d.removeSlide(a)}),a.$watch("active",function(b){b&&d.select(a)})}}}).animation(".item",["$animate",function(a){return{beforeAddClass:function(b,c,d){if("active"==c&&b.parent()&&!b.parent().scope().noTransition){var e=!1,f=b.isolateScope().direction,g="next"==f?"left":"right";return b.addClass(f),a.addClass(b,g).then(function(){e||b.removeClass(g+" "+f),d()}),function(){e=!0}}d()},beforeRemoveClass:function(b,c,d){if("active"==c&&b.parent()&&!b.parent().scope().noTransition){var e=!1,f=b.isolateScope().direction,g="next"==f?"left":"right";return a.addClass(b,g).then(function(){e||b.removeClass(g),d()}),function(){e=!0}}d()}}}]),angular.module("ui.bootstrap.dateparser",[]).service("dateParser",["$locale","orderByFilter",function(a,b){function c(a){var c=[],d=a.split("");return angular.forEach(f,function(b,e){var f=a.indexOf(e);if(f>-1){a=a.split(""),d[f]="("+b.regex+")",a[f]="$";for(var g=f+1,h=f+e.length;h>g;g++)d[g]="",a[g]="$";a=a.join(""),c.push({index:f,apply:b.apply})}}),{regex:new RegExp("^"+d.join("")+"$"),map:b(c,"index")}}function d(a,b,c){return 1>c?!1:1===b&&c>28?29===c&&(a%4===0&&a%100!==0||a%400===0):3===b||5===b||8===b||10===b?31>c:!0}var e=/[\\\^\$\*\+\?\|\[\]\(\)\.\{\}]/g;this.parsers={};var f={yyyy:{regex:"\\d{4}",apply:function(a){this.year=+a}},yy:{regex:"\\d{2}",apply:function(a){this.year=+a+2e3}},y:{regex:"\\d{1,4}",apply:function(a){this.year=+a}},MMMM:{regex:a.DATETIME_FORMATS.MONTH.join("|"),apply:function(b){this.month=a.DATETIME_FORMATS.MONTH.indexOf(b)}},MMM:{regex:a.DATETIME_FORMATS.SHORTMONTH.join("|"),apply:function(b){this.month=a.DATETIME_FORMATS.SHORTMONTH.indexOf(b)}},MM:{regex:"0[1-9]|1[0-2]",apply:function(a){this.month=a-1}},M:{regex:"[1-9]|1[0-2]",apply:function(a){this.month=a-1}},dd:{regex:"[0-2][0-9]{1}|3[0-1]{1}",apply:function(a){this.date=+a}},d:{regex:"[1-2]?[0-9]{1}|3[0-1]{1}",apply:function(a){this.date=+a}},EEEE:{regex:a.DATETIME_FORMATS.DAY.join("|")},EEE:{regex:a.DATETIME_FORMATS.SHORTDAY.join("|")},HH:{regex:"(?:0|1)[0-9]|2[0-3]",apply:function(a){this.hours=+a}},H:{regex:"1?[0-9]|2[0-3]",apply:function(a){this.hours=+a}},mm:{regex:"[0-5][0-9]",apply:function(a){this.minutes=+a}},m:{regex:"[0-9]|[1-5][0-9]",apply:function(a){this.minutes=+a}},sss:{regex:"[0-9][0-9][0-9]",apply:function(a){this.milliseconds=+a}},ss:{regex:"[0-5][0-9]",apply:function(a){this.seconds=+a}},s:{regex:"[0-9]|[1-5][0-9]",apply:function(a){this.seconds=+a}}};this.parse=function(b,f,g){if(!angular.isString(b)||!f)return b;f=a.DATETIME_FORMATS[f]||f,f=f.replace(e,"\\$&"),this.parsers[f]||(this.parsers[f]=c(f));var h=this.parsers[f],i=h.regex,j=h.map,k=b.match(i);if(k&&k.length){var l,m;l=g?{year:g.getFullYear(),month:g.getMonth(),date:g.getDate(),hours:g.getHours(),minutes:g.getMinutes(),seconds:g.getSeconds(),milliseconds:g.getMilliseconds()}:{year:1900,month:0,date:1,hours:0,minutes:0,seconds:0,milliseconds:0};for(var n=1,o=k.length;o>n;n++){var p=j[n-1];p.apply&&p.apply.call(l,k[n])}return d(l.year,l.month,l.date)&&(m=new Date(l.year,l.month,l.date,l.hours,l.minutes,l.seconds,l.milliseconds||0)),m}}}]),angular.module("ui.bootstrap.position",[]).factory("$position",["$document","$window",function(a,b){function c(a,c){return a.currentStyle?a.currentStyle[c]:b.getComputedStyle?b.getComputedStyle(a)[c]:a.style[c]}function d(a){return"static"===(c(a,"position")||"static")}var e=function(b){for(var c=a[0],e=b.offsetParent||c;e&&e!==c&&d(e);)e=e.offsetParent;return e||c};return{position:function(b){var c=this.offset(b),d={top:0,left:0},f=e(b[0]);f!=a[0]&&(d=this.offset(angular.element(f)),d.top+=f.clientTop-f.scrollTop,d.left+=f.clientLeft-f.scrollLeft);var g=b[0].getBoundingClientRect();return{width:g.width||b.prop("offsetWidth"),height:g.height||b.prop("offsetHeight"),top:c.top-d.top,left:c.left-d.left}},offset:function(c){var d=c[0].getBoundingClientRect();return{width:d.width||c.prop("offsetWidth"),height:d.height||c.prop("offsetHeight"),top:d.top+(b.pageYOffset||a[0].documentElement.scrollTop),left:d.left+(b.pageXOffset||a[0].documentElement.scrollLeft)}},positionElements:function(a,b,c,d){var e,f,g,h,i=c.split("-"),j=i[0],k=i[1]||"center";e=d?this.offset(a):this.position(a),f=b.prop("offsetWidth"),g=b.prop("offsetHeight");var l={center:function(){return e.left+e.width/2-f/2},left:function(){return e.left},right:function(){return e.left+e.width}},m={center:function(){return e.top+e.height/2-g/2},top:function(){return e.top},bottom:function(){return e.top+e.height}};switch(j){case"right":h={top:m[k](),left:l[j]()};break;case"left":h={top:m[k](),left:e.left-f};break;case"bottom":h={top:m[j](),left:l[k]()};break;default:h={top:e.top-g,left:l[k]()}}return h}}}]),angular.module("ui.bootstrap.datepicker",["ui.bootstrap.dateparser","ui.bootstrap.position"]).constant("datepickerConfig",{formatDay:"dd",formatMonth:"MMMM",formatYear:"yyyy",formatDayHeader:"EEE",formatDayTitle:"MMMM yyyy",formatMonthTitle:"yyyy",datepickerMode:"day",minMode:"day",maxMode:"year",showWeeks:!0,startingDay:0,yearRange:20,minDate:null,maxDate:null,shortcutPropagation:!1}).controller("DatepickerController",["$scope","$attrs","$parse","$interpolate","$timeout","$log","dateFilter","datepickerConfig",function(a,b,c,d,e,f,g,h){var i=this,j={$setViewValue:angular.noop};this.modes=["day","month","year"],angular.forEach(["formatDay","formatMonth","formatYear","formatDayHeader","formatDayTitle","formatMonthTitle","minMode","maxMode","showWeeks","startingDay","yearRange","shortcutPropagation"],function(c,e){i[c]=angular.isDefined(b[c])?8>e?d(b[c])(a.$parent):a.$parent.$eval(b[c]):h[c]}),angular.forEach(["minDate","maxDate"],function(d){b[d]?a.$parent.$watch(c(b[d]),function(a){i[d]=a?new Date(a):null,i.refreshView()}):i[d]=h[d]?new Date(h[d]):null}),a.datepickerMode=a.datepickerMode||h.datepickerMode,a.maxMode=i.maxMode,a.uniqueId="datepicker-"+a.$id+"-"+Math.floor(1e4*Math.random()),angular.isDefined(b.initDate)?(this.activeDate=a.$parent.$eval(b.initDate)||new Date,a.$parent.$watch(b.initDate,function(a){a&&(j.$isEmpty(j.$modelValue)||j.$invalid)&&(i.activeDate=a,i.refreshView())})):this.activeDate=new Date,a.isActive=function(b){return 0===i.compare(b.date,i.activeDate)?(a.activeDateId=b.uid,!0):!1},this.init=function(a){j=a,j.$render=function(){i.render()}},this.render=function(){if(j.$viewValue){var a=new Date(j.$viewValue),b=!isNaN(a);b?this.activeDate=a:f.error('Datepicker directive: "ng-model" value must be a Date object, a number of milliseconds since 01.01.1970 or a string representing an RFC2822 or ISO 8601 date.'),j.$setValidity("date",b)}this.refreshView()},this.refreshView=function(){if(this.element){this._refreshView();var a=j.$viewValue?new Date(j.$viewValue):null;j.$setValidity("date-disabled",!a||this.element&&!this.isDisabled(a))}},this.createDateObject=function(a,b){var c=j.$viewValue?new Date(j.$viewValue):null;return{date:a,label:g(a,b),selected:c&&0===this.compare(a,c),disabled:this.isDisabled(a),current:0===this.compare(a,new Date),customClass:this.customClass(a)}},this.isDisabled=function(c){return this.minDate&&this.compare(c,this.minDate)<0||this.maxDate&&this.compare(c,this.maxDate)>0||b.dateDisabled&&a.dateDisabled({date:c,mode:a.datepickerMode})},this.customClass=function(b){return a.customClass({date:b,mode:a.datepickerMode})},this.split=function(a,b){for(var c=[];a.length>0;)c.push(a.splice(0,b));return c},a.select=function(b){if(a.datepickerMode===i.minMode){var c=j.$viewValue?new Date(j.$viewValue):new Date(0,0,0,0,0,0,0);c.setFullYear(b.getFullYear(),b.getMonth(),b.getDate()),j.$setViewValue(c),j.$render()}else i.activeDate=b,a.datepickerMode=i.modes[i.modes.indexOf(a.datepickerMode)-1]},a.move=function(a){var b=i.activeDate.getFullYear()+a*(i.step.years||0),c=i.activeDate.getMonth()+a*(i.step.months||0);i.activeDate.setFullYear(b,c,1),i.refreshView()},a.toggleMode=function(b){b=b||1,a.datepickerMode===i.maxMode&&1===b||a.datepickerMode===i.minMode&&-1===b||(a.datepickerMode=i.modes[i.modes.indexOf(a.datepickerMode)+b])},a.keys={13:"enter",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down"};var k=function(){e(function(){i.element[0].focus()},0,!1)};a.$on("datepicker.focus",k),a.keydown=function(b){var c=a.keys[b.which];if(c&&!b.shiftKey&&!b.altKey)if(b.preventDefault(),i.shortcutPropagation||b.stopPropagation(),"enter"===c||"space"===c){if(i.isDisabled(i.activeDate))return;a.select(i.activeDate),k()}else!b.ctrlKey||"up"!==c&&"down"!==c?(i.handleKeyDown(c,b),i.refreshView()):(a.toggleMode("up"===c?1:-1),k())}}]).directive("datepicker",function(){return{restrict:"EA",replace:!0,templateUrl:"template/datepicker/datepicker.html",scope:{datepickerMode:"=?",dateDisabled:"&",customClass:"&",shortcutPropagation:"&?"},require:["datepicker","?^ngModel"],controller:"DatepickerController",link:function(a,b,c,d){var e=d[0],f=d[1];f&&e.init(f)}}}).directive("daypicker",["dateFilter",function(a){return{restrict:"EA",replace:!0,templateUrl:"template/datepicker/day.html",require:"^datepicker",link:function(b,c,d,e){function f(a,b){return 1!==b||a%4!==0||a%100===0&&a%400!==0?i[b]:29}function g(a,b){var c=new Array(b),d=new Date(a),e=0;for(d.setHours(12);b>e;)c[e++]=new Date(d),d.setDate(d.getDate()+1);return c}function h(a){var b=new Date(a);b.setDate(b.getDate()+4-(b.getDay()||7));var c=b.getTime();return b.setMonth(0),b.setDate(1),Math.floor(Math.round((c-b)/864e5)/7)+1}b.showWeeks=e.showWeeks,e.step={months:1},e.element=c;var i=[31,28,31,30,31,30,31,31,30,31,30,31];e._refreshView=function(){var c=e.activeDate.getFullYear(),d=e.activeDate.getMonth(),f=new Date(c,d,1),i=e.startingDay-f.getDay(),j=i>0?7-i:-i,k=new Date(f);j>0&&k.setDate(-j+1);for(var l=g(k,42),m=0;42>m;m++)l[m]=angular.extend(e.createDateObject(l[m],e.formatDay),{secondary:l[m].getMonth()!==d,uid:b.uniqueId+"-"+m});b.labels=new Array(7);for(var n=0;7>n;n++)b.labels[n]={abbr:a(l[n].date,e.formatDayHeader),full:a(l[n].date,"EEEE")};if(b.title=a(e.activeDate,e.formatDayTitle),b.rows=e.split(l,7),b.showWeeks){b.weekNumbers=[];for(var o=(11-e.startingDay)%7,p=b.rows.length,q=0;p>q;q++)b.weekNumbers.push(h(b.rows[q][o].date))}},e.compare=function(a,b){return new Date(a.getFullYear(),a.getMonth(),a.getDate())-new Date(b.getFullYear(),b.getMonth(),b.getDate())},e.handleKeyDown=function(a){var b=e.activeDate.getDate();if("left"===a)b-=1;else if("up"===a)b-=7;else if("right"===a)b+=1;else if("down"===a)b+=7;else if("pageup"===a||"pagedown"===a){var c=e.activeDate.getMonth()+("pageup"===a?-1:1);e.activeDate.setMonth(c,1),b=Math.min(f(e.activeDate.getFullYear(),e.activeDate.getMonth()),b)}else"home"===a?b=1:"end"===a&&(b=f(e.activeDate.getFullYear(),e.activeDate.getMonth()));e.activeDate.setDate(b)},e.refreshView()}}}]).directive("monthpicker",["dateFilter",function(a){return{restrict:"EA",replace:!0,templateUrl:"template/datepicker/month.html",require:"^datepicker",link:function(b,c,d,e){e.step={years:1},e.element=c,e._refreshView=function(){for(var c=new Array(12),d=e.activeDate.getFullYear(),f=0;12>f;f++)c[f]=angular.extend(e.createDateObject(new Date(d,f,1),e.formatMonth),{uid:b.uniqueId+"-"+f});b.title=a(e.activeDate,e.formatMonthTitle),b.rows=e.split(c,3)},e.compare=function(a,b){return new Date(a.getFullYear(),a.getMonth())-new Date(b.getFullYear(),b.getMonth())},e.handleKeyDown=function(a){var b=e.activeDate.getMonth();if("left"===a)b-=1;else if("up"===a)b-=3;else if("right"===a)b+=1;else if("down"===a)b+=3;else if("pageup"===a||"pagedown"===a){var c=e.activeDate.getFullYear()+("pageup"===a?-1:1);e.activeDate.setFullYear(c)}else"home"===a?b=0:"end"===a&&(b=11);e.activeDate.setMonth(b)},e.refreshView()}}}]).directive("yearpicker",["dateFilter",function(){return{restrict:"EA",replace:!0,templateUrl:"template/datepicker/year.html",require:"^datepicker",link:function(a,b,c,d){function e(a){return parseInt((a-1)/f,10)*f+1}var f=d.yearRange;d.step={years:f},d.element=b,d._refreshView=function(){for(var b=new Array(f),c=0,g=e(d.activeDate.getFullYear());f>c;c++)b[c]=angular.extend(d.createDateObject(new Date(g+c,0,1),d.formatYear),{uid:a.uniqueId+"-"+c});a.title=[b[0].label,b[f-1].label].join(" - "),a.rows=d.split(b,5)},d.compare=function(a,b){return a.getFullYear()-b.getFullYear()},d.handleKeyDown=function(a){var b=d.activeDate.getFullYear();"left"===a?b-=1:"up"===a?b-=5:"right"===a?b+=1:"down"===a?b+=5:"pageup"===a||"pagedown"===a?b+=("pageup"===a?-1:1)*d.step.years:"home"===a?b=e(d.activeDate.getFullYear()):"end"===a&&(b=e(d.activeDate.getFullYear())+f-1),d.activeDate.setFullYear(b)},d.refreshView()}}}]).constant("datepickerPopupConfig",{datepickerPopup:"yyyy-MM-dd",html5Types:{date:"yyyy-MM-dd","datetime-local":"yyyy-MM-ddTHH:mm:ss.sss",month:"yyyy-MM"},currentText:"Today",clearText:"Clear",closeText:"Done",closeOnDateSelection:!0,appendToBody:!1,showButtonBar:!0}).directive("datepickerPopup",["$compile","$parse","$document","$position","dateFilter","dateParser","datepickerPopupConfig",function(a,b,c,d,e,f,g){return{restrict:"EA",require:"ngModel",scope:{isOpen:"=?",currentText:"@",clearText:"@",closeText:"@",dateDisabled:"&",customClass:"&"},link:function(h,i,j,k){function l(a){return a.replace(/([A-Z])/g,function(a){return"-"+a.toLowerCase()})}function m(a){if(angular.isNumber(a)&&(a=new Date(a)),!a)return null;if(angular.isDate(a)&&!isNaN(a))return a;if(angular.isString(a)){var b=f.parse(a,o,h.date)||new Date(a);return isNaN(b)?void 0:b}}function n(a,b){var c=a||b;if(angular.isNumber(c)&&(c=new Date(c)),c){if(angular.isDate(c)&&!isNaN(c))return!0;if(angular.isString(c)){var d=f.parse(c,o)||new Date(c);return!isNaN(d)}return!1}return!0}var o,p=angular.isDefined(j.closeOnDateSelection)?h.$parent.$eval(j.closeOnDateSelection):g.closeOnDateSelection,q=angular.isDefined(j.datepickerAppendToBody)?h.$parent.$eval(j.datepickerAppendToBody):g.appendToBody;h.showButtonBar=angular.isDefined(j.showButtonBar)?h.$parent.$eval(j.showButtonBar):g.showButtonBar,h.getText=function(a){return h[a+"Text"]||g[a+"Text"]};var r=!1;if(g.html5Types[j.type]?(o=g.html5Types[j.type],r=!0):(o=j.datepickerPopup||g.datepickerPopup,j.$observe("datepickerPopup",function(a){var b=a||g.datepickerPopup;if(b!==o&&(o=b,k.$modelValue=null,!o))throw new Error("datepickerPopup must have a date format specified.")})),!o)throw new Error("datepickerPopup must have a date format specified.");if(r&&j.datepickerPopup)throw new Error("HTML5 date input types do not support custom formats.");var s=angular.element("<div datepicker-popup-wrap><div datepicker></div></div>");s.attr({"ng-model":"date","ng-change":"dateSelection()"});var t=angular.element(s.children()[0]);if(r&&"month"==j.type&&(t.attr("datepicker-mode",'"month"'),t.attr("min-mode","month")),j.datepickerOptions){var u=h.$parent.$eval(j.datepickerOptions);u.initDate&&(h.initDate=u.initDate,t.attr("init-date","initDate"),delete u.initDate),angular.forEach(u,function(a,b){t.attr(l(b),a)})}h.watchData={},angular.forEach(["minDate","maxDate","datepickerMode","initDate","shortcutPropagation"],function(a){if(j[a]){var c=b(j[a]);if(h.$parent.$watch(c,function(b){h.watchData[a]=b}),t.attr(l(a),"watchData."+a),"datepickerMode"===a){var d=c.assign;h.$watch("watchData."+a,function(a,b){a!==b&&d(h.$parent,a)})}}}),j.dateDisabled&&t.attr("date-disabled","dateDisabled({ date: date, mode: mode })"),j.showWeeks&&t.attr("show-weeks",j.showWeeks),j.customClass&&t.attr("custom-class","customClass({ date: date, mode: mode })"),r?k.$formatters.push(function(a){return h.date=a,a}):(k.$$parserName="date",k.$validators.date=n,k.$parsers.unshift(m),k.$formatters.push(function(a){return h.date=a,k.$isEmpty(a)?a:e(a,o)})),h.dateSelection=function(a){angular.isDefined(a)&&(h.date=a);var b=h.date?e(h.date,o):"";i.val(b),k.$setViewValue(b),p&&(h.isOpen=!1,i[0].focus())},k.$viewChangeListeners.push(function(){h.date=f.parse(k.$viewValue,o,h.date)||new Date(k.$viewValue)});var v=function(a){h.isOpen&&a.target!==i[0]&&h.$apply(function(){h.isOpen=!1})},w=function(a){h.keydown(a)};i.bind("keydown",w),h.keydown=function(a){27===a.which?(a.preventDefault(),h.isOpen&&a.stopPropagation(),h.close()):40!==a.which||h.isOpen||(h.isOpen=!0)},h.$watch("isOpen",function(a){a?(h.$broadcast("datepicker.focus"),h.position=q?d.offset(i):d.position(i),h.position.top=h.position.top+i.prop("offsetHeight"),c.bind("click",v)):c.unbind("click",v)}),h.select=function(a){if("today"===a){var b=new Date;angular.isDate(h.date)?(a=new Date(h.date),a.setFullYear(b.getFullYear(),b.getMonth(),b.getDate())):a=new Date(b.setHours(0,0,0,0))}h.dateSelection(a)},h.close=function(){h.isOpen=!1,i[0].focus()};var x=a(s)(h);s.remove(),q?c.find("body").append(x):i.after(x),h.$on("$destroy",function(){x.remove(),i.unbind("keydown",w),c.unbind("click",v)})}}}]).directive("datepickerPopupWrap",function(){return{restrict:"EA",replace:!0,transclude:!0,templateUrl:"template/datepicker/popup.html",link:function(a,b){b.bind("click",function(a){a.preventDefault(),a.stopPropagation()})}}}),angular.module("ui.bootstrap.dropdown",["ui.bootstrap.position"]).constant("dropdownConfig",{openClass:"open"}).service("dropdownService",["$document","$rootScope",function(a,b){var c=null;this.open=function(b){c||(a.bind("click",d),a.bind("keydown",e)),c&&c!==b&&(c.isOpen=!1),c=b},this.close=function(b){c===b&&(c=null,a.unbind("click",d),a.unbind("keydown",e))};var d=function(a){if(c&&(!a||"disabled"!==c.getAutoClose())){var d=c.getToggleElement();if(!(a&&d&&d[0].contains(a.target))){var e=c.getElement();a&&"outsideClick"===c.getAutoClose()&&e&&e[0].contains(a.target)||(c.isOpen=!1,b.$$phase||c.$apply())}}},e=function(a){27===a.which&&(c.focusToggleElement(),d())}}]).controller("DropdownController",["$scope","$attrs","$parse","dropdownConfig","dropdownService","$animate","$position","$document",function(a,b,c,d,e,f,g,h){var i,j=this,k=a.$new(),l=d.openClass,m=angular.noop,n=b.onToggle?c(b.onToggle):angular.noop,o=!1;this.init=function(d){j.$element=d,b.isOpen&&(i=c(b.isOpen),m=i.assign,a.$watch(i,function(a){k.isOpen=!!a})),o=angular.isDefined(b.dropdownAppendToBody),o&&j.dropdownMenu&&(h.find("body").append(j.dropdownMenu),d.on("$destroy",function(){j.dropdownMenu.remove()}))},this.toggle=function(a){return k.isOpen=arguments.length?!!a:!k.isOpen},this.isOpen=function(){return k.isOpen},k.getToggleElement=function(){return j.toggleElement},k.getAutoClose=function(){return b.autoClose||"always"},k.getElement=function(){return j.$element},k.focusToggleElement=function(){j.toggleElement&&j.toggleElement[0].focus()},k.$watch("isOpen",function(b,c){if(o&&j.dropdownMenu){var d=g.positionElements(j.$element,j.dropdownMenu,"bottom-left",!0);j.dropdownMenu.css({top:d.top+"px",left:d.left+"px",display:b?"block":"none"})}f[b?"addClass":"removeClass"](j.$element,l),b?(k.focusToggleElement(),e.open(k)):e.close(k),m(a,b),angular.isDefined(b)&&b!==c&&n(a,{open:!!b})}),a.$on("$locationChangeSuccess",function(){k.isOpen=!1}),a.$on("$destroy",function(){k.$destroy()})}]).directive("dropdown",function(){return{controller:"DropdownController",link:function(a,b,c,d){d.init(b)}}}).directive("dropdownMenu",function(){return{restrict:"AC",require:"?^dropdown",link:function(a,b,c,d){d&&(d.dropdownMenu=b)}}}).directive("dropdownToggle",function(){return{require:"?^dropdown",link:function(a,b,c,d){if(d){d.toggleElement=b;var e=function(e){e.preventDefault(),b.hasClass("disabled")||c.disabled||a.$apply(function(){d.toggle()})};b.bind("click",e),b.attr({"aria-haspopup":!0,
"aria-expanded":!1}),a.$watch(d.isOpen,function(a){b.attr("aria-expanded",!!a)}),a.$on("$destroy",function(){b.unbind("click",e)})}}}}),angular.module("ui.bootstrap.modal",[]).factory("$$stackedMap",function(){return{createNew:function(){var a=[];return{add:function(b,c){a.push({key:b,value:c})},get:function(b){for(var c=0;c<a.length;c++)if(b==a[c].key)return a[c]},keys:function(){for(var b=[],c=0;c<a.length;c++)b.push(a[c].key);return b},top:function(){return a[a.length-1]},remove:function(b){for(var c=-1,d=0;d<a.length;d++)if(b==a[d].key){c=d;break}return a.splice(c,1)[0]},removeTop:function(){return a.splice(a.length-1,1)[0]},length:function(){return a.length}}}}}).directive("modalBackdrop",["$timeout",function(a){function b(b){b.animate=!1,a(function(){b.animate=!0})}return{restrict:"EA",replace:!0,templateUrl:"template/modal/backdrop.html",compile:function(a,c){return a.addClass(c.backdropClass),b}}}]).directive("modalWindow",["$modalStack","$q",function(a,b){return{restrict:"EA",scope:{index:"@",animate:"="},replace:!0,transclude:!0,templateUrl:function(a,b){return b.templateUrl||"template/modal/window.html"},link:function(c,d,e){d.addClass(e.windowClass||""),c.size=e.size,c.close=function(b){var c=a.getTop();c&&c.value.backdrop&&"static"!=c.value.backdrop&&b.target===b.currentTarget&&(b.preventDefault(),b.stopPropagation(),a.dismiss(c.key,"backdrop click"))},c.$isRendered=!0;var f=b.defer();e.$observe("modalRender",function(a){"true"==a&&f.resolve()}),f.promise.then(function(){c.animate=!0;var b=d[0].querySelectorAll("[autofocus]");b.length?b[0].focus():d[0].focus();var e=a.getTop();e&&a.modalRendered(e.key)})}}}]).directive("modalAnimationClass",[function(){return{compile:function(a,b){b.modalAnimation&&a.addClass(b.modalAnimationClass)}}}]).directive("modalTransclude",function(){return{link:function(a,b,c,d,e){e(a.$parent,function(a){b.empty(),b.append(a)})}}}).factory("$modalStack",["$animate","$timeout","$document","$compile","$rootScope","$$stackedMap",function(a,b,c,d,e,f){function g(){for(var a=-1,b=o.keys(),c=0;c<b.length;c++)o.get(b[c]).value.backdrop&&(a=c);return a}function h(a){var b=c.find("body").eq(0),d=o.get(a).value;o.remove(a),j(d.modalDomEl,d.modalScope,function(){b.toggleClass(n,o.length()>0),i()})}function i(){if(l&&-1==g()){var a=m;j(l,m,function(){a=null}),l=void 0,m=void 0}}function j(c,d,f){function g(){g.done||(g.done=!0,c.remove(),d.$destroy(),f&&f())}d.animate=!1,c.attr("modal-animation")&&a.enabled()?c.one("$animate:close",function(){e.$evalAsync(g)}):b(g)}function k(a,b,c){return!a.value.modalScope.$broadcast("modal.closing",b,c).defaultPrevented}var l,m,n="modal-open",o=f.createNew(),p={};return e.$watch(g,function(a){m&&(m.index=a)}),c.bind("keydown",function(a){var b;27===a.which&&(b=o.top(),b&&b.value.keyboard&&(a.preventDefault(),e.$apply(function(){p.dismiss(b.key,"escape key press")})))}),p.open=function(a,b){var f=c[0].activeElement;o.add(a,{deferred:b.deferred,renderDeferred:b.renderDeferred,modalScope:b.scope,backdrop:b.backdrop,keyboard:b.keyboard});var h=c.find("body").eq(0),i=g();if(i>=0&&!l){m=e.$new(!0),m.index=i;var j=angular.element('<div modal-backdrop="modal-backdrop"></div>');j.attr("backdrop-class",b.backdropClass),b.animation&&j.attr("modal-animation","true"),l=d(j)(m),h.append(l)}var k=angular.element('<div modal-window="modal-window"></div>');k.attr({"template-url":b.windowTemplateUrl,"window-class":b.windowClass,size:b.size,index:o.length()-1,animate:"animate"}).html(b.content),b.animation&&k.attr("modal-animation","true");var p=d(k)(b.scope);o.top().value.modalDomEl=p,o.top().value.modalOpener=f,h.append(p),h.addClass(n)},p.close=function(a,b){var c=o.get(a);return c&&k(c,b,!0)?(c.value.deferred.resolve(b),h(a),c.value.modalOpener.focus(),!0):!c},p.dismiss=function(a,b){var c=o.get(a);return c&&k(c,b,!1)?(c.value.deferred.reject(b),h(a),c.value.modalOpener.focus(),!0):!c},p.dismissAll=function(a){for(var b=this.getTop();b&&this.dismiss(b.key,a);)b=this.getTop()},p.getTop=function(){return o.top()},p.modalRendered=function(a){var b=o.get(a);b&&b.value.renderDeferred.resolve()},p}]).provider("$modal",function(){var a={options:{animation:!0,backdrop:!0,keyboard:!0},$get:["$injector","$rootScope","$q","$templateRequest","$controller","$modalStack",function(b,c,d,e,f,g){function h(a){return a.template?d.when(a.template):e(angular.isFunction(a.templateUrl)?a.templateUrl():a.templateUrl)}function i(a){var c=[];return angular.forEach(a,function(a){(angular.isFunction(a)||angular.isArray(a))&&c.push(d.when(b.invoke(a)))}),c}var j={};return j.open=function(b){var e=d.defer(),j=d.defer(),k=d.defer(),l={result:e.promise,opened:j.promise,rendered:k.promise,close:function(a){return g.close(l,a)},dismiss:function(a){return g.dismiss(l,a)}};if(b=angular.extend({},a.options,b),b.resolve=b.resolve||{},!b.template&&!b.templateUrl)throw new Error("One of template or templateUrl options is required.");var m=d.all([h(b)].concat(i(b.resolve)));return m.then(function(a){var d=(b.scope||c).$new();d.$close=l.close,d.$dismiss=l.dismiss;var h,i={},j=1;b.controller&&(i.$scope=d,i.$modalInstance=l,angular.forEach(b.resolve,function(b,c){i[c]=a[j++]}),h=f(b.controller,i),b.controllerAs&&(d[b.controllerAs]=h)),g.open(l,{scope:d,deferred:e,renderDeferred:k,content:a[0],animation:b.animation,backdrop:b.backdrop,keyboard:b.keyboard,backdropClass:b.backdropClass,windowClass:b.windowClass,windowTemplateUrl:b.windowTemplateUrl,size:b.size})},function(a){e.reject(a)}),m.then(function(){j.resolve(!0)},function(a){j.reject(a)}),l},j}]};return a}),angular.module("ui.bootstrap.pagination",[]).controller("PaginationController",["$scope","$attrs","$parse",function(a,b,c){var d=this,e={$setViewValue:angular.noop},f=b.numPages?c(b.numPages).assign:angular.noop;this.init=function(g,h){e=g,this.config=h,e.$render=function(){d.render()},b.itemsPerPage?a.$parent.$watch(c(b.itemsPerPage),function(b){d.itemsPerPage=parseInt(b,10),a.totalPages=d.calculateTotalPages()}):this.itemsPerPage=h.itemsPerPage,a.$watch("totalItems",function(){a.totalPages=d.calculateTotalPages()}),a.$watch("totalPages",function(b){f(a.$parent,b),a.page>b?a.selectPage(b):e.$render()})},this.calculateTotalPages=function(){var b=this.itemsPerPage<1?1:Math.ceil(a.totalItems/this.itemsPerPage);return Math.max(b||0,1)},this.render=function(){a.page=parseInt(e.$viewValue,10)||1},a.selectPage=function(b,c){a.page!==b&&b>0&&b<=a.totalPages&&(c&&c.target&&c.target.blur(),e.$setViewValue(b),e.$render())},a.getText=function(b){return a[b+"Text"]||d.config[b+"Text"]},a.noPrevious=function(){return 1===a.page},a.noNext=function(){return a.page===a.totalPages}}]).constant("paginationConfig",{itemsPerPage:10,boundaryLinks:!1,directionLinks:!0,firstText:"First",previousText:"Previous",nextText:"Next",lastText:"Last",rotate:!0}).directive("pagination",["$parse","paginationConfig",function(a,b){return{restrict:"EA",scope:{totalItems:"=",firstText:"@",previousText:"@",nextText:"@",lastText:"@"},require:["pagination","?ngModel"],controller:"PaginationController",templateUrl:"template/pagination/pagination.html",replace:!0,link:function(c,d,e,f){function g(a,b,c){return{number:a,text:b,active:c}}function h(a,b){var c=[],d=1,e=b,f=angular.isDefined(k)&&b>k;f&&(l?(d=Math.max(a-Math.floor(k/2),1),e=d+k-1,e>b&&(e=b,d=e-k+1)):(d=(Math.ceil(a/k)-1)*k+1,e=Math.min(d+k-1,b)));for(var h=d;e>=h;h++){var i=g(h,h,h===a);c.push(i)}if(f&&!l){if(d>1){var j=g(d-1,"...",!1);c.unshift(j)}if(b>e){var m=g(e+1,"...",!1);c.push(m)}}return c}var i=f[0],j=f[1];if(j){var k=angular.isDefined(e.maxSize)?c.$parent.$eval(e.maxSize):b.maxSize,l=angular.isDefined(e.rotate)?c.$parent.$eval(e.rotate):b.rotate;c.boundaryLinks=angular.isDefined(e.boundaryLinks)?c.$parent.$eval(e.boundaryLinks):b.boundaryLinks,c.directionLinks=angular.isDefined(e.directionLinks)?c.$parent.$eval(e.directionLinks):b.directionLinks,i.init(j,b),e.maxSize&&c.$parent.$watch(a(e.maxSize),function(a){k=parseInt(a,10),i.render()});var m=i.render;i.render=function(){m(),c.page>0&&c.page<=c.totalPages&&(c.pages=h(c.page,c.totalPages))}}}}}]).constant("pagerConfig",{itemsPerPage:10,previousText:"« Previous",nextText:"Next »",align:!0}).directive("pager",["pagerConfig",function(a){return{restrict:"EA",scope:{totalItems:"=",previousText:"@",nextText:"@"},require:["pager","?ngModel"],controller:"PaginationController",templateUrl:"template/pagination/pager.html",replace:!0,link:function(b,c,d,e){var f=e[0],g=e[1];g&&(b.align=angular.isDefined(d.align)?b.$parent.$eval(d.align):a.align,f.init(g,a))}}}]),angular.module("ui.bootstrap.tooltip",["ui.bootstrap.position","ui.bootstrap.bindHtml"]).provider("$tooltip",function(){function a(a){var b=/[A-Z]/g,c="-";return a.replace(b,function(a,b){return(b?c:"")+a.toLowerCase()})}var b={placement:"top",animation:!0,popupDelay:0,useContentExp:!1},c={mouseenter:"mouseleave",click:"click",focus:"blur"},d={};this.options=function(a){angular.extend(d,a)},this.setTriggers=function(a){angular.extend(c,a)},this.$get=["$window","$compile","$timeout","$document","$position","$interpolate",function(e,f,g,h,i,j){return function(e,k,l,m){function n(a){var b=a||m.trigger||l,d=c[b]||b;return{show:b,hide:d}}m=angular.extend({},b,d,m);var o=a(e),p=j.startSymbol(),q=j.endSymbol(),r="<div "+o+'-popup title="'+p+"title"+q+'" '+(m.useContentExp?'content-exp="contentExp()" ':'content="'+p+"content"+q+'" ')+'placement="'+p+"placement"+q+'" popup-class="'+p+"popupClass"+q+'" animation="animation" is-open="isOpen"origin-scope="origScope" ></div>';return{restrict:"EA",compile:function(){var a=f(r);return function(b,c,d){function f(){E.isOpen?l():j()}function j(){(!D||b.$eval(d[k+"Enable"]))&&(s(),E.popupDelay?A||(A=g(o,E.popupDelay,!1),A.then(function(a){a()})):o()())}function l(){b.$apply(function(){p()})}function o(){return A=null,z&&(g.cancel(z),z=null),(m.useContentExp?E.contentExp():E.content)?(q(),x.css({top:0,left:0,display:"block"}),E.$digest(),F(),E.isOpen=!0,E.$apply(),F):angular.noop}function p(){E.isOpen=!1,g.cancel(A),A=null,E.animation?z||(z=g(r,500)):r()}function q(){x&&r(),y=E.$new(),x=a(y,function(a){B?h.find("body").append(a):c.after(a)}),y.$watch(function(){g(F,0,!1)}),m.useContentExp&&y.$watch("contentExp()",function(a){!a&&E.isOpen&&p()})}function r(){z=null,x&&(x.remove(),x=null),y&&(y.$destroy(),y=null)}function s(){t(),u(),v()}function t(){E.popupClass=d[k+"Class"]}function u(){var a=d[k+"Placement"];E.placement=angular.isDefined(a)?a:m.placement}function v(){var a=d[k+"PopupDelay"],b=parseInt(a,10);E.popupDelay=isNaN(b)?m.popupDelay:b}function w(){var a=d[k+"Trigger"];G(),C=n(a),C.show===C.hide?c.bind(C.show,f):(c.bind(C.show,j),c.bind(C.hide,l))}var x,y,z,A,B=angular.isDefined(m.appendToBody)?m.appendToBody:!1,C=n(void 0),D=angular.isDefined(d[k+"Enable"]),E=b.$new(!0),F=function(){if(x){var a=i.positionElements(c,x,E.placement,B);a.top+="px",a.left+="px",x.css(a)}};E.origScope=b,E.isOpen=!1,E.contentExp=function(){return b.$eval(d[e])},m.useContentExp||d.$observe(e,function(a){E.content=a,!a&&E.isOpen&&p()}),d.$observe("disabled",function(a){a&&E.isOpen&&p()}),d.$observe(k+"Title",function(a){E.title=a});var G=function(){c.unbind(C.show,j),c.unbind(C.hide,l)};w();var H=b.$eval(d[k+"Animation"]);E.animation=angular.isDefined(H)?!!H:m.animation;var I=b.$eval(d[k+"AppendToBody"]);B=angular.isDefined(I)?I:B,B&&b.$on("$locationChangeSuccess",function(){E.isOpen&&p()}),b.$on("$destroy",function(){g.cancel(z),g.cancel(A),G(),r(),E=null})}}}}}]}).directive("tooltipTemplateTransclude",["$animate","$sce","$compile","$templateRequest",function(a,b,c,d){return{link:function(e,f,g){var h,i,j,k=e.$eval(g.tooltipTemplateTranscludeScope),l=0,m=function(){i&&(i.remove(),i=null),h&&(h.$destroy(),h=null),j&&(a.leave(j).then(function(){i=null}),i=j,j=null)};e.$watch(b.parseAsResourceUrl(g.tooltipTemplateTransclude),function(b){var g=++l;b?(d(b,!0).then(function(d){if(g===l){var e=k.$new(),i=d,n=c(i)(e,function(b){m(),a.enter(b,f)});h=e,j=n,h.$emit("$includeContentLoaded",b)}},function(){g===l&&(m(),e.$emit("$includeContentError",b))}),e.$emit("$includeContentRequested",b)):m()}),e.$on("$destroy",m)}}}]).directive("tooltipClasses",function(){return{restrict:"A",link:function(a,b,c){a.placement&&b.addClass(a.placement),a.popupClass&&b.addClass(a.popupClass),a.animation()&&b.addClass(c.tooltipAnimationClass)}}}).directive("tooltipPopup",function(){return{restrict:"EA",replace:!0,scope:{content:"@",placement:"@",popupClass:"@",animation:"&",isOpen:"&"},templateUrl:"template/tooltip/tooltip-popup.html"}}).directive("tooltip",["$tooltip",function(a){return a("tooltip","tooltip","mouseenter")}]).directive("tooltipTemplatePopup",function(){return{restrict:"EA",replace:!0,scope:{contentExp:"&",placement:"@",popupClass:"@",animation:"&",isOpen:"&",originScope:"&"},templateUrl:"template/tooltip/tooltip-template-popup.html"}}).directive("tooltipTemplate",["$tooltip",function(a){return a("tooltipTemplate","tooltip","mouseenter",{useContentExp:!0})}]).directive("tooltipHtmlPopup",function(){return{restrict:"EA",replace:!0,scope:{contentExp:"&",placement:"@",popupClass:"@",animation:"&",isOpen:"&"},templateUrl:"template/tooltip/tooltip-html-popup.html"}}).directive("tooltipHtml",["$tooltip",function(a){return a("tooltipHtml","tooltip","mouseenter",{useContentExp:!0})}]).directive("tooltipHtmlUnsafePopup",function(){return{restrict:"EA",replace:!0,scope:{content:"@",placement:"@",popupClass:"@",animation:"&",isOpen:"&"},templateUrl:"template/tooltip/tooltip-html-unsafe-popup.html"}}).value("tooltipHtmlUnsafeSuppressDeprecated",!1).directive("tooltipHtmlUnsafe",["$tooltip","tooltipHtmlUnsafeSuppressDeprecated","$log",function(a,b,c){return b||c.warn("tooltip-html-unsafe is now deprecated. Use tooltip-html or tooltip-template instead."),a("tooltipHtmlUnsafe","tooltip","mouseenter")}]),angular.module("ui.bootstrap.popover",["ui.bootstrap.tooltip"]).directive("popoverTemplatePopup",function(){return{restrict:"EA",replace:!0,scope:{title:"@",contentExp:"&",placement:"@",popupClass:"@",animation:"&",isOpen:"&",originScope:"&"},templateUrl:"template/popover/popover-template.html"}}).directive("popoverTemplate",["$tooltip",function(a){return a("popoverTemplate","popover","click",{useContentExp:!0})}]).directive("popoverPopup",function(){return{restrict:"EA",replace:!0,scope:{title:"@",content:"@",placement:"@",popupClass:"@",animation:"&",isOpen:"&"},templateUrl:"template/popover/popover.html"}}).directive("popover",["$tooltip",function(a){return a("popover","popover","click")}]),angular.module("ui.bootstrap.progressbar",[]).constant("progressConfig",{animate:!0,max:100}).controller("ProgressController",["$scope","$attrs","progressConfig",function(a,b,c){var d=this,e=angular.isDefined(b.animate)?a.$parent.$eval(b.animate):c.animate;this.bars=[],a.max=angular.isDefined(a.max)?a.max:c.max,this.addBar=function(b,c){e||c.css({transition:"none"}),this.bars.push(b),b.$watch("value",function(c){b.percent=+(100*c/a.max).toFixed(2)}),b.$on("$destroy",function(){c=null,d.removeBar(b)})},this.removeBar=function(a){this.bars.splice(this.bars.indexOf(a),1)}}]).directive("progress",function(){return{restrict:"EA",replace:!0,transclude:!0,controller:"ProgressController",require:"progress",scope:{},templateUrl:"template/progressbar/progress.html"}}).directive("bar",function(){return{restrict:"EA",replace:!0,transclude:!0,require:"^progress",scope:{value:"=",max:"=?",type:"@"},templateUrl:"template/progressbar/bar.html",link:function(a,b,c,d){d.addBar(a,b)}}}).directive("progressbar",function(){return{restrict:"EA",replace:!0,transclude:!0,controller:"ProgressController",scope:{value:"=",max:"=?",type:"@"},templateUrl:"template/progressbar/progressbar.html",link:function(a,b,c,d){d.addBar(a,angular.element(b.children()[0]))}}}),angular.module("ui.bootstrap.rating",[]).constant("ratingConfig",{max:5,stateOn:null,stateOff:null}).controller("RatingController",["$scope","$attrs","ratingConfig",function(a,b,c){var d={$setViewValue:angular.noop};this.init=function(e){d=e,d.$render=this.render,d.$formatters.push(function(a){return angular.isNumber(a)&&a<<0!==a&&(a=Math.round(a)),a}),this.stateOn=angular.isDefined(b.stateOn)?a.$parent.$eval(b.stateOn):c.stateOn,this.stateOff=angular.isDefined(b.stateOff)?a.$parent.$eval(b.stateOff):c.stateOff;var f=angular.isDefined(b.ratingStates)?a.$parent.$eval(b.ratingStates):new Array(angular.isDefined(b.max)?a.$parent.$eval(b.max):c.max);a.range=this.buildTemplateObjects(f)},this.buildTemplateObjects=function(a){for(var b=0,c=a.length;c>b;b++)a[b]=angular.extend({index:b},{stateOn:this.stateOn,stateOff:this.stateOff},a[b]);return a},a.rate=function(b){!a.readonly&&b>=0&&b<=a.range.length&&(d.$setViewValue(b),d.$render())},a.enter=function(b){a.readonly||(a.value=b),a.onHover({value:b})},a.reset=function(){a.value=d.$viewValue,a.onLeave()},a.onKeydown=function(b){/(37|38|39|40)/.test(b.which)&&(b.preventDefault(),b.stopPropagation(),a.rate(a.value+(38===b.which||39===b.which?1:-1)))},this.render=function(){a.value=d.$viewValue}}]).directive("rating",function(){return{restrict:"EA",require:["rating","ngModel"],scope:{readonly:"=?",onHover:"&",onLeave:"&"},controller:"RatingController",templateUrl:"template/rating/rating.html",replace:!0,link:function(a,b,c,d){var e=d[0],f=d[1];e.init(f)}}}),angular.module("ui.bootstrap.tabs",[]).controller("TabsetController",["$scope",function(a){var b=this,c=b.tabs=a.tabs=[];b.select=function(a){angular.forEach(c,function(b){b.active&&b!==a&&(b.active=!1,b.onDeselect())}),a.active=!0,a.onSelect()},b.addTab=function(a){c.push(a),1===c.length&&a.active!==!1?a.active=!0:a.active?b.select(a):a.active=!1},b.removeTab=function(a){var e=c.indexOf(a);if(a.active&&c.length>1&&!d){var f=e==c.length-1?e-1:e+1;b.select(c[f])}c.splice(e,1)};var d;a.$on("$destroy",function(){d=!0})}]).directive("tabset",function(){return{restrict:"EA",transclude:!0,replace:!0,scope:{type:"@"},controller:"TabsetController",templateUrl:"template/tabs/tabset.html",link:function(a,b,c){a.vertical=angular.isDefined(c.vertical)?a.$parent.$eval(c.vertical):!1,a.justified=angular.isDefined(c.justified)?a.$parent.$eval(c.justified):!1}}}).directive("tab",["$parse","$log",function(a,b){return{require:"^tabset",restrict:"EA",replace:!0,templateUrl:"template/tabs/tab.html",transclude:!0,scope:{active:"=?",heading:"@",onSelect:"&select",onDeselect:"&deselect"},controller:function(){},compile:function(c,d,e){return function(c,d,f,g){c.$watch("active",function(a){a&&g.select(c)}),c.disabled=!1,f.disable&&c.$parent.$watch(a(f.disable),function(a){c.disabled=!!a}),f.disabled&&(b.warn('Use of "disabled" attribute has been deprecated, please use "disable"'),c.$parent.$watch(a(f.disabled),function(a){c.disabled=!!a})),c.select=function(){c.disabled||(c.active=!0)},g.addTab(c),c.$on("$destroy",function(){g.removeTab(c)}),c.$transcludeFn=e}}}}]).directive("tabHeadingTransclude",[function(){return{restrict:"A",require:"^tab",link:function(a,b){a.$watch("headingElement",function(a){a&&(b.html(""),b.append(a))})}}}]).directive("tabContentTransclude",function(){function a(a){return a.tagName&&(a.hasAttribute("tab-heading")||a.hasAttribute("data-tab-heading")||"tab-heading"===a.tagName.toLowerCase()||"data-tab-heading"===a.tagName.toLowerCase())}return{restrict:"A",require:"^tabset",link:function(b,c,d){var e=b.$eval(d.tabContentTransclude);e.$transcludeFn(e.$parent,function(b){angular.forEach(b,function(b){a(b)?e.headingElement=b:c.append(b)})})}}}),angular.module("ui.bootstrap.timepicker",[]).constant("timepickerConfig",{hourStep:1,minuteStep:1,showMeridian:!0,meridians:null,readonlyInput:!1,mousewheel:!0,arrowkeys:!0}).controller("TimepickerController",["$scope","$attrs","$parse","$log","$locale","timepickerConfig",function(a,b,c,d,e,f){function g(){var b=parseInt(a.hours,10),c=a.showMeridian?b>0&&13>b:b>=0&&24>b;return c?(a.showMeridian&&(12===b&&(b=0),a.meridian===p[1]&&(b+=12)),b):void 0}function h(){var b=parseInt(a.minutes,10);return b>=0&&60>b?b:void 0}function i(a){return angular.isDefined(a)&&a.toString().length<2?"0"+a:a.toString()}function j(a){k(),o.$setViewValue(new Date(n)),l(a)}function k(){o.$setValidity("time",!0),a.invalidHours=!1,a.invalidMinutes=!1}function l(b){var c=n.getHours(),d=n.getMinutes();a.showMeridian&&(c=0===c||12===c?12:c%12),a.hours="h"===b?c:i(c),"m"!==b&&(a.minutes=i(d)),a.meridian=n.getHours()<12?p[0]:p[1]}function m(a){var b=new Date(n.getTime()+6e4*a);n.setHours(b.getHours(),b.getMinutes()),j()}var n=new Date,o={$setViewValue:angular.noop},p=angular.isDefined(b.meridians)?a.$parent.$eval(b.meridians):f.meridians||e.DATETIME_FORMATS.AMPMS;this.init=function(c,d){o=c,o.$render=this.render,o.$formatters.unshift(function(a){return a?new Date(a):null});var e=d.eq(0),g=d.eq(1),h=angular.isDefined(b.mousewheel)?a.$parent.$eval(b.mousewheel):f.mousewheel;h&&this.setupMousewheelEvents(e,g);var i=angular.isDefined(b.arrowkeys)?a.$parent.$eval(b.arrowkeys):f.arrowkeys;i&&this.setupArrowkeyEvents(e,g),a.readonlyInput=angular.isDefined(b.readonlyInput)?a.$parent.$eval(b.readonlyInput):f.readonlyInput,this.setupInputEvents(e,g)};var q=f.hourStep;b.hourStep&&a.$parent.$watch(c(b.hourStep),function(a){q=parseInt(a,10)});var r=f.minuteStep;b.minuteStep&&a.$parent.$watch(c(b.minuteStep),function(a){r=parseInt(a,10)}),a.showMeridian=f.showMeridian,b.showMeridian&&a.$parent.$watch(c(b.showMeridian),function(b){if(a.showMeridian=!!b,o.$error.time){var c=g(),d=h();angular.isDefined(c)&&angular.isDefined(d)&&(n.setHours(c),j())}else l()}),this.setupMousewheelEvents=function(b,c){var d=function(a){a.originalEvent&&(a=a.originalEvent);var b=a.wheelDelta?a.wheelDelta:-a.deltaY;return a.detail||b>0};b.bind("mousewheel wheel",function(b){a.$apply(d(b)?a.incrementHours():a.decrementHours()),b.preventDefault()}),c.bind("mousewheel wheel",function(b){a.$apply(d(b)?a.incrementMinutes():a.decrementMinutes()),b.preventDefault()})},this.setupArrowkeyEvents=function(b,c){b.bind("keydown",function(b){38===b.which?(b.preventDefault(),a.incrementHours(),a.$apply()):40===b.which&&(b.preventDefault(),a.decrementHours(),a.$apply())}),c.bind("keydown",function(b){38===b.which?(b.preventDefault(),a.incrementMinutes(),a.$apply()):40===b.which&&(b.preventDefault(),a.decrementMinutes(),a.$apply())})},this.setupInputEvents=function(b,c){if(a.readonlyInput)return a.updateHours=angular.noop,void(a.updateMinutes=angular.noop);var d=function(b,c){o.$setViewValue(null),o.$setValidity("time",!1),angular.isDefined(b)&&(a.invalidHours=b),angular.isDefined(c)&&(a.invalidMinutes=c)};a.updateHours=function(){var a=g();angular.isDefined(a)?(n.setHours(a),j("h")):d(!0)},b.bind("blur",function(){!a.invalidHours&&a.hours<10&&a.$apply(function(){a.hours=i(a.hours)})}),a.updateMinutes=function(){var a=h();angular.isDefined(a)?(n.setMinutes(a),j("m")):d(void 0,!0)},c.bind("blur",function(){!a.invalidMinutes&&a.minutes<10&&a.$apply(function(){a.minutes=i(a.minutes)})})},this.render=function(){var a=o.$viewValue;isNaN(a)?(o.$setValidity("time",!1),d.error('Timepicker directive: "ng-model" value must be a Date object, a number of milliseconds since 01.01.1970 or a string representing an RFC2822 or ISO 8601 date.')):(a&&(n=a),k(),l())},a.incrementHours=function(){m(60*q)},a.decrementHours=function(){m(60*-q)},a.incrementMinutes=function(){m(r)},a.decrementMinutes=function(){m(-r)},a.toggleMeridian=function(){m(720*(n.getHours()<12?1:-1))}}]).directive("timepicker",function(){return{restrict:"EA",require:["timepicker","?^ngModel"],controller:"TimepickerController",replace:!0,scope:{},templateUrl:"template/timepicker/timepicker.html",link:function(a,b,c,d){var e=d[0],f=d[1];f&&e.init(f,b.find("input"))}}}),angular.module("ui.bootstrap.transition",[]).value("$transitionSuppressDeprecated",!1).factory("$transition",["$q","$timeout","$rootScope","$log","$transitionSuppressDeprecated",function(a,b,c,d,e){function f(a){for(var b in a)if(void 0!==h.style[b])return a[b]}e||d.warn("$transition is now deprecated. Use $animate from ngAnimate instead.");var g=function(d,e,f){f=f||{};var h=a.defer(),i=g[f.animation?"animationEndEventName":"transitionEndEventName"],j=function(){c.$apply(function(){d.unbind(i,j),h.resolve(d)})};return i&&d.bind(i,j),b(function(){angular.isString(e)?d.addClass(e):angular.isFunction(e)?e(d):angular.isObject(e)&&d.css(e),i||h.resolve(d)}),h.promise.cancel=function(){i&&d.unbind(i,j),h.reject("Transition cancelled")},h.promise},h=document.createElement("trans"),i={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd",transition:"transitionend"},j={WebkitTransition:"webkitAnimationEnd",MozTransition:"animationend",OTransition:"oAnimationEnd",transition:"animationend"};return g.transitionEndEventName=f(i),g.animationEndEventName=f(j),g}]),angular.module("ui.bootstrap.typeahead",["ui.bootstrap.position","ui.bootstrap.bindHtml"]).factory("typeaheadParser",["$parse",function(a){var b=/^\s*([\s\S]+?)(?:\s+as\s+([\s\S]+?))?\s+for\s+(?:([\$\w][\$\w\d]*))\s+in\s+([\s\S]+?)$/;return{parse:function(c){var d=c.match(b);if(!d)throw new Error('Expected typeahead specification in form of "_modelValue_ (as _label_)? for _item_ in _collection_" but got "'+c+'".');return{itemName:d[3],source:a(d[4]),viewMapper:a(d[2]||d[1]),modelMapper:a(d[1])}}}}]).directive("typeahead",["$compile","$parse","$q","$timeout","$document","$position","typeaheadParser",function(a,b,c,d,e,f,g){var h=[9,13,27,38,40];return{require:"ngModel",link:function(i,j,k,l){var m,n=i.$eval(k.typeaheadMinLength)||1,o=i.$eval(k.typeaheadWaitMs)||0,p=i.$eval(k.typeaheadEditable)!==!1,q=b(k.typeaheadLoading).assign||angular.noop,r=b(k.typeaheadOnSelect),s=k.typeaheadInputFormatter?b(k.typeaheadInputFormatter):void 0,t=k.typeaheadAppendToBody?i.$eval(k.typeaheadAppendToBody):!1,u=i.$eval(k.typeaheadFocusFirst)!==!1,v=b(k.ngModel).assign,w=g.parse(k.typeahead),x=i.$new();i.$on("$destroy",function(){x.$destroy()});var y="typeahead-"+x.$id+"-"+Math.floor(1e4*Math.random());j.attr({"aria-autocomplete":"list","aria-expanded":!1,"aria-owns":y});var z=angular.element("<div typeahead-popup></div>");z.attr({id:y,matches:"matches",active:"activeIdx",select:"select(activeIdx)",query:"query",position:"position"}),angular.isDefined(k.typeaheadTemplateUrl)&&z.attr("template-url",k.typeaheadTemplateUrl);var A=function(){x.matches=[],x.activeIdx=-1,j.attr("aria-expanded",!1)},B=function(a){return y+"-option-"+a};x.$watch("activeIdx",function(a){0>a?j.removeAttr("aria-activedescendant"):j.attr("aria-activedescendant",B(a))});var C=function(a){var b={$viewValue:a};q(i,!0),c.when(w.source(i,b)).then(function(c){var d=a===l.$viewValue;if(d&&m)if(c&&c.length>0){x.activeIdx=u?0:-1,x.matches.length=0;for(var e=0;e<c.length;e++)b[w.itemName]=c[e],x.matches.push({id:B(e),label:w.viewMapper(x,b),model:c[e]});x.query=a,x.position=t?f.offset(j):f.position(j),x.position.top=x.position.top+j.prop("offsetHeight"),j.attr("aria-expanded",!0)}else A();d&&q(i,!1)},function(){A(),q(i,!1)})};A(),x.query=void 0;var D,E=function(a){D=d(function(){C(a)},o)},F=function(){D&&d.cancel(D)};l.$parsers.unshift(function(a){return m=!0,a&&a.length>=n?o>0?(F(),E(a)):C(a):(q(i,!1),F(),A()),p?a:a?void l.$setValidity("editable",!1):(l.$setValidity("editable",!0),a)}),l.$formatters.push(function(a){var b,c,d={};return p||l.$setValidity("editable",!0),s?(d.$model=a,s(i,d)):(d[w.itemName]=a,b=w.viewMapper(i,d),d[w.itemName]=void 0,c=w.viewMapper(i,d),b!==c?b:a)}),x.select=function(a){var b,c,e={};e[w.itemName]=c=x.matches[a].model,b=w.modelMapper(i,e),v(i,b),l.$setValidity("editable",!0),l.$setValidity("parse",!0),r(i,{$item:c,$model:b,$label:w.viewMapper(i,e)}),A(),d(function(){j[0].focus()},0,!1)},j.bind("keydown",function(a){0!==x.matches.length&&-1!==h.indexOf(a.which)&&(-1!=x.activeIdx||13!==a.which&&9!==a.which)&&(a.preventDefault(),40===a.which?(x.activeIdx=(x.activeIdx+1)%x.matches.length,x.$digest()):38===a.which?(x.activeIdx=(x.activeIdx>0?x.activeIdx:x.matches.length)-1,x.$digest()):13===a.which||9===a.which?x.$apply(function(){x.select(x.activeIdx)}):27===a.which&&(a.stopPropagation(),A(),x.$digest()))}),j.bind("blur",function(){m=!1});var G=function(a){j[0]!==a.target&&(A(),x.$digest())};e.bind("click",G),i.$on("$destroy",function(){e.unbind("click",G),t&&H.remove(),z.remove()});var H=a(z)(x);t?e.find("body").append(H):j.after(H)}}}]).directive("typeaheadPopup",function(){return{restrict:"EA",scope:{matches:"=",query:"=",active:"=",position:"=",select:"&"},replace:!0,templateUrl:"template/typeahead/typeahead-popup.html",link:function(a,b,c){a.templateUrl=c.templateUrl,a.isOpen=function(){return a.matches.length>0},a.isActive=function(b){return a.active==b},a.selectActive=function(b){a.active=b},a.selectMatch=function(b){a.select({activeIdx:b})}}}}).directive("typeaheadMatch",["$templateRequest","$compile","$parse",function(a,b,c){return{restrict:"EA",scope:{index:"=",match:"=",query:"="},link:function(d,e,f){var g=c(f.templateUrl)(d.$parent)||"template/typeahead/typeahead-match.html";a(g).then(function(a){b(a.trim())(d,function(a){e.replaceWith(a)})})}}}]).filter("typeaheadHighlight",function(){function a(a){return a.replace(/([.?*+^$[\]\\(){}|-])/g,"\\$1")}return function(b,c){return c?(""+b).replace(new RegExp(a(c),"gi"),"<strong>$&</strong>"):b}}),angular.module("template/accordion/accordion-group.html",[]).run(["$templateCache",function(a){a.put("template/accordion/accordion-group.html",'<div class="panel panel-default">\n  <div class="panel-heading">\n    <h4 class="panel-title">\n      <a href="javascript:void(0)" tabindex="0" class="accordion-toggle" ng-click="toggleOpen()" accordion-transclude="heading"><span ng-class="{\'text-muted\': isDisabled}">{{heading}}</span></a>\n    </h4>\n  </div>\n  <div class="panel-collapse collapse" collapse="!isOpen">\n	  <div class="panel-body" ng-transclude></div>\n  </div>\n</div>\n')}]),angular.module("template/accordion/accordion.html",[]).run(["$templateCache",function(a){a.put("template/accordion/accordion.html",'<div class="panel-group" ng-transclude></div>')}]),angular.module("template/alert/alert.html",[]).run(["$templateCache",function(a){a.put("template/alert/alert.html",'<div class="alert" ng-class="[\'alert-\' + (type || \'warning\'), closeable ? \'alert-dismissable\' : null]" role="alert">\n    <button ng-show="closeable" type="button" class="close" ng-click="close()">\n        <span aria-hidden="true">&times;</span>\n        <span class="sr-only">Close</span>\n    </button>\n    <div ng-transclude></div>\n</div>\n')}]),angular.module("template/carousel/carousel.html",[]).run(["$templateCache",function(a){a.put("template/carousel/carousel.html",'<div ng-mouseenter="pause()" ng-mouseleave="play()" class="carousel" ng-swipe-right="prev()" ng-swipe-left="next()">\n    <ol class="carousel-indicators" ng-show="slides.length > 1">\n        <li ng-repeat="slide in slides | orderBy:\'index\' track by $index" ng-class="{active: isActive(slide)}" ng-click="select(slide)"></li>\n    </ol>\n    <div class="carousel-inner" ng-transclude></div>\n    <a class="left carousel-control" ng-click="prev()" ng-show="slides.length > 1"><span class="glyphicon glyphicon-chevron-left"></span></a>\n    <a class="right carousel-control" ng-click="next()" ng-show="slides.length > 1"><span class="glyphicon glyphicon-chevron-right"></span></a>\n</div>\n')}]),angular.module("template/carousel/slide.html",[]).run(["$templateCache",function(a){a.put("template/carousel/slide.html",'<div ng-class="{\n    \'active\': active\n  }" class="item text-center" ng-transclude></div>\n')}]),angular.module("template/datepicker/datepicker.html",[]).run(["$templateCache",function(a){a.put("template/datepicker/datepicker.html",'<div ng-switch="datepickerMode" role="application" ng-keydown="keydown($event)">\n  <daypicker ng-switch-when="day" tabindex="0"></daypicker>\n  <monthpicker ng-switch-when="month" tabindex="0"></monthpicker>\n  <yearpicker ng-switch-when="year" tabindex="0"></yearpicker>\n</div>');
}]),angular.module("template/datepicker/day.html",[]).run(["$templateCache",function(a){a.put("template/datepicker/day.html",'<table role="grid" aria-labelledby="{{uniqueId}}-title" aria-activedescendant="{{activeDateId}}">\n  <thead>\n    <tr>\n      <th><button type="button" class="btn btn-default btn-sm pull-left" ng-click="move(-1)" tabindex="-1"><i class="glyphicon glyphicon-chevron-left"></i></button></th>\n      <th colspan="{{5 + showWeeks}}"><button id="{{uniqueId}}-title" role="heading" aria-live="assertive" aria-atomic="true" type="button" class="btn btn-default btn-sm" ng-click="toggleMode()" ng-disabled="datepickerMode === maxMode" tabindex="-1" style="width:100%;"><strong>{{title}}</strong></button></th>\n      <th><button type="button" class="btn btn-default btn-sm pull-right" ng-click="move(1)" tabindex="-1"><i class="glyphicon glyphicon-chevron-right"></i></button></th>\n    </tr>\n    <tr>\n      <th ng-show="showWeeks" class="text-center"></th>\n      <th ng-repeat="label in labels track by $index" class="text-center"><small aria-label="{{label.full}}">{{label.abbr}}</small></th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr ng-repeat="row in rows track by $index">\n      <td ng-show="showWeeks" class="text-center h6"><em>{{ weekNumbers[$index] }}</em></td>\n      <td ng-repeat="dt in row track by dt.date" class="text-center" role="gridcell" id="{{dt.uid}}" aria-disabled="{{!!dt.disabled}}" ng-class="dt.customClass">\n        <button type="button" style="width:100%;" class="btn btn-default btn-sm" ng-class="{\'btn-info\': dt.selected, active: isActive(dt)}" ng-click="select(dt.date)" ng-disabled="dt.disabled" tabindex="-1"><span ng-class="{\'text-muted\': dt.secondary, \'text-info\': dt.current}">{{dt.label}}</span></button>\n      </td>\n    </tr>\n  </tbody>\n</table>\n')}]),angular.module("template/datepicker/month.html",[]).run(["$templateCache",function(a){a.put("template/datepicker/month.html",'<table role="grid" aria-labelledby="{{uniqueId}}-title" aria-activedescendant="{{activeDateId}}">\n  <thead>\n    <tr>\n      <th><button type="button" class="btn btn-default btn-sm pull-left" ng-click="move(-1)" tabindex="-1"><i class="glyphicon glyphicon-chevron-left"></i></button></th>\n      <th><button id="{{uniqueId}}-title" role="heading" aria-live="assertive" aria-atomic="true" type="button" class="btn btn-default btn-sm" ng-click="toggleMode()" ng-disabled="datepickerMode === maxMode" tabindex="-1" style="width:100%;"><strong>{{title}}</strong></button></th>\n      <th><button type="button" class="btn btn-default btn-sm pull-right" ng-click="move(1)" tabindex="-1"><i class="glyphicon glyphicon-chevron-right"></i></button></th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr ng-repeat="row in rows track by $index">\n      <td ng-repeat="dt in row track by dt.date" class="text-center" role="gridcell" id="{{dt.uid}}" aria-disabled="{{!!dt.disabled}}">\n        <button type="button" style="width:100%;" class="btn btn-default" ng-class="{\'btn-info\': dt.selected, active: isActive(dt)}" ng-click="select(dt.date)" ng-disabled="dt.disabled" tabindex="-1"><span ng-class="{\'text-info\': dt.current}">{{dt.label}}</span></button>\n      </td>\n    </tr>\n  </tbody>\n</table>\n')}]),angular.module("template/datepicker/popup.html",[]).run(["$templateCache",function(a){a.put("template/datepicker/popup.html",'<ul class="dropdown-menu" ng-style="{display: (isOpen && \'block\') || \'none\', top: position.top+\'px\', left: position.left+\'px\'}" ng-keydown="keydown($event)">\n	<li ng-transclude></li>\n	<li ng-if="showButtonBar" style="padding:10px 9px 2px">\n		<span class="btn-group pull-left">\n			<button type="button" class="btn btn-sm btn-info" ng-click="select(\'today\')">{{ getText(\'current\') }}</button>\n			<button type="button" class="btn btn-sm btn-danger" ng-click="select(null)">{{ getText(\'clear\') }}</button>\n		</span>\n		<button type="button" class="btn btn-sm btn-success pull-right" ng-click="close()">{{ getText(\'close\') }}</button>\n	</li>\n</ul>\n')}]),angular.module("template/datepicker/year.html",[]).run(["$templateCache",function(a){a.put("template/datepicker/year.html",'<table role="grid" aria-labelledby="{{uniqueId}}-title" aria-activedescendant="{{activeDateId}}">\n  <thead>\n    <tr>\n      <th><button type="button" class="btn btn-default btn-sm pull-left" ng-click="move(-1)" tabindex="-1"><i class="glyphicon glyphicon-chevron-left"></i></button></th>\n      <th colspan="3"><button id="{{uniqueId}}-title" role="heading" aria-live="assertive" aria-atomic="true" type="button" class="btn btn-default btn-sm" ng-click="toggleMode()" ng-disabled="datepickerMode === maxMode" tabindex="-1" style="width:100%;"><strong>{{title}}</strong></button></th>\n      <th><button type="button" class="btn btn-default btn-sm pull-right" ng-click="move(1)" tabindex="-1"><i class="glyphicon glyphicon-chevron-right"></i></button></th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr ng-repeat="row in rows track by $index">\n      <td ng-repeat="dt in row track by dt.date" class="text-center" role="gridcell" id="{{dt.uid}}" aria-disabled="{{!!dt.disabled}}">\n        <button type="button" style="width:100%;" class="btn btn-default" ng-class="{\'btn-info\': dt.selected, active: isActive(dt)}" ng-click="select(dt.date)" ng-disabled="dt.disabled" tabindex="-1"><span ng-class="{\'text-info\': dt.current}">{{dt.label}}</span></button>\n      </td>\n    </tr>\n  </tbody>\n</table>\n')}]),angular.module("template/modal/backdrop.html",[]).run(["$templateCache",function(a){a.put("template/modal/backdrop.html",'<div class="modal-backdrop"\n     modal-animation-class="fade"\n     ng-class="{in: animate}"\n     ng-style="{\'z-index\': 1040 + (index && 1 || 0) + index*10}"\n></div>\n')}]),angular.module("template/modal/window.html",[]).run(["$templateCache",function(a){a.put("template/modal/window.html",'<div modal-render="{{$isRendered}}" tabindex="-1" role="dialog" class="modal"\n    modal-animation-class="fade"\n	ng-class="{in: animate}" ng-style="{\'z-index\': 1050 + index*10, display: \'block\'}" ng-click="close($event)">\n    <div class="modal-dialog" ng-class="size ? \'modal-\' + size : \'\'"><div class="modal-content" modal-transclude></div></div>\n</div>\n')}]),angular.module("template/pagination/pager.html",[]).run(["$templateCache",function(a){a.put("template/pagination/pager.html",'<ul class="pager">\n  <li ng-class="{disabled: noPrevious(), previous: align}"><a href ng-click="selectPage(page - 1, $event)">{{getText(\'previous\')}}</a></li>\n  <li ng-class="{disabled: noNext(), next: align}"><a href ng-click="selectPage(page + 1, $event)">{{getText(\'next\')}}</a></li>\n</ul>')}]),angular.module("template/pagination/pagination.html",[]).run(["$templateCache",function(a){a.put("template/pagination/pagination.html",'<ul class="pagination">\n  <li ng-if="boundaryLinks" ng-class="{disabled: noPrevious()}"><a href ng-click="selectPage(1, $event)">{{getText(\'first\')}}</a></li>\n  <li ng-if="directionLinks" ng-class="{disabled: noPrevious()}"><a href ng-click="selectPage(page - 1, $event)">{{getText(\'previous\')}}</a></li>\n  <li ng-repeat="page in pages track by $index" ng-class="{active: page.active}"><a href ng-click="selectPage(page.number, $event)">{{page.text}}</a></li>\n  <li ng-if="directionLinks" ng-class="{disabled: noNext()}"><a href ng-click="selectPage(page + 1, $event)">{{getText(\'next\')}}</a></li>\n  <li ng-if="boundaryLinks" ng-class="{disabled: noNext()}"><a href ng-click="selectPage(totalPages, $event)">{{getText(\'last\')}}</a></li>\n</ul>')}]),angular.module("template/tooltip/tooltip-html-popup.html",[]).run(["$templateCache",function(a){a.put("template/tooltip/tooltip-html-popup.html",'<div class="tooltip"\n  tooltip-animation-class="fade"\n  tooltip-classes\n  ng-class="{ in: isOpen() }">\n  <div class="tooltip-arrow"></div>\n  <div class="tooltip-inner" ng-bind-html="contentExp()"></div>\n</div>\n')}]),angular.module("template/tooltip/tooltip-html-unsafe-popup.html",[]).run(["$templateCache",function(a){a.put("template/tooltip/tooltip-html-unsafe-popup.html",'<div class="tooltip"\n  tooltip-animation-class="fade"\n  tooltip-classes\n  ng-class="{ in: isOpen() }">\n  <div class="tooltip-arrow"></div>\n  <div class="tooltip-inner" bind-html-unsafe="content"></div>\n</div>\n')}]),angular.module("template/tooltip/tooltip-popup.html",[]).run(["$templateCache",function(a){a.put("template/tooltip/tooltip-popup.html",'<div class="tooltip"\n  tooltip-animation-class="fade"\n  tooltip-classes\n  ng-class="{ in: isOpen() }">\n  <div class="tooltip-arrow"></div>\n  <div class="tooltip-inner" ng-bind="content"></div>\n</div>\n')}]),angular.module("template/tooltip/tooltip-template-popup.html",[]).run(["$templateCache",function(a){a.put("template/tooltip/tooltip-template-popup.html",'<div class="tooltip"\n  tooltip-animation-class="fade"\n  tooltip-classes\n  ng-class="{ in: isOpen() }">\n  <div class="tooltip-arrow"></div>\n  <div class="tooltip-inner"\n    tooltip-template-transclude="contentExp()"\n    tooltip-template-transclude-scope="originScope()"></div>\n</div>\n')}]),angular.module("template/popover/popover-template.html",[]).run(["$templateCache",function(a){a.put("template/popover/popover-template.html",'<div class="popover"\n  tooltip-animation-class="fade"\n  tooltip-classes\n  ng-class="{ in: isOpen() }">\n  <div class="arrow"></div>\n\n  <div class="popover-inner">\n      <h3 class="popover-title" ng-bind="title" ng-if="title"></h3>\n      <div class="popover-content"\n        tooltip-template-transclude="contentExp()"\n        tooltip-template-transclude-scope="originScope()"></div>\n  </div>\n</div>\n')}]),angular.module("template/popover/popover-window.html",[]).run(["$templateCache",function(a){a.put("template/popover/popover-window.html",'<div class="popover {{placement}}" ng-class="{ in: isOpen, fade: animation }">\n  <div class="arrow"></div>\n\n  <div class="popover-inner">\n      <h3 class="popover-title" ng-bind="title" ng-show="title"></h3>\n      <div class="popover-content" tooltip-template-transclude></div>\n  </div>\n</div>\n')}]),angular.module("template/popover/popover.html",[]).run(["$templateCache",function(a){a.put("template/popover/popover.html",'<div class="popover"\n  tooltip-animation-class="fade"\n  tooltip-classes\n  ng-class="{ in: isOpen() }">\n  <div class="arrow"></div>\n\n  <div class="popover-inner">\n      <h3 class="popover-title" ng-bind="title" ng-if="title"></h3>\n      <div class="popover-content" ng-bind="content"></div>\n  </div>\n</div>\n')}]),angular.module("template/progressbar/bar.html",[]).run(["$templateCache",function(a){a.put("template/progressbar/bar.html",'<div class="progress-bar" ng-class="type && \'progress-bar-\' + type" role="progressbar" aria-valuenow="{{value}}" aria-valuemin="0" aria-valuemax="{{max}}" ng-style="{width: (percent < 100 ? percent : 100) + \'%\'}" aria-valuetext="{{percent | number:0}}%" ng-transclude></div>\n')}]),angular.module("template/progressbar/progress.html",[]).run(["$templateCache",function(a){a.put("template/progressbar/progress.html",'<div class="progress" ng-transclude></div>')}]),angular.module("template/progressbar/progressbar.html",[]).run(["$templateCache",function(a){a.put("template/progressbar/progressbar.html",'<div class="progress">\n  <div class="progress-bar" ng-class="type && \'progress-bar-\' + type" role="progressbar" aria-valuenow="{{value}}" aria-valuemin="0" aria-valuemax="{{max}}" ng-style="{width: (percent < 100 ? percent : 100) + \'%\'}" aria-valuetext="{{percent | number:0}}%" ng-transclude></div>\n</div>\n')}]),angular.module("template/rating/rating.html",[]).run(["$templateCache",function(a){a.put("template/rating/rating.html",'<span ng-mouseleave="reset()" ng-keydown="onKeydown($event)" tabindex="0" role="slider" aria-valuemin="0" aria-valuemax="{{range.length}}" aria-valuenow="{{value}}">\n    <i ng-repeat="r in range track by $index" ng-mouseenter="enter($index + 1)" ng-click="rate($index + 1)" class="glyphicon" ng-class="$index < value && (r.stateOn || \'glyphicon-star\') || (r.stateOff || \'glyphicon-star-empty\')">\n        <span class="sr-only">({{ $index < value ? \'*\' : \' \' }})</span>\n    </i>\n</span>')}]),angular.module("template/tabs/tab.html",[]).run(["$templateCache",function(a){a.put("template/tabs/tab.html",'<li ng-class="{active: active, disabled: disabled}">\n  <a href ng-click="select()" tab-heading-transclude>{{heading}}</a>\n</li>\n')}]),angular.module("template/tabs/tabset.html",[]).run(["$templateCache",function(a){a.put("template/tabs/tabset.html",'<div>\n  <ul class="nav nav-{{type || \'tabs\'}}" ng-class="{\'nav-stacked\': vertical, \'nav-justified\': justified}" ng-transclude></ul>\n  <div class="tab-content">\n    <div class="tab-pane" \n         ng-repeat="tab in tabs" \n         ng-class="{active: tab.active}"\n         tab-content-transclude="tab">\n    </div>\n  </div>\n</div>\n')}]),angular.module("template/timepicker/timepicker.html",[]).run(["$templateCache",function(a){a.put("template/timepicker/timepicker.html",'<table>\n	<tbody>\n		<tr class="text-center">\n			<td><a ng-click="incrementHours()" class="btn btn-link"><span class="glyphicon glyphicon-chevron-up"></span></a></td>\n			<td>&nbsp;</td>\n			<td><a ng-click="incrementMinutes()" class="btn btn-link"><span class="glyphicon glyphicon-chevron-up"></span></a></td>\n			<td ng-show="showMeridian"></td>\n		</tr>\n		<tr>\n			<td class="form-group" ng-class="{\'has-error\': invalidHours}">\n				<input style="width:50px;" type="text" ng-model="hours" ng-change="updateHours()" class="form-control text-center" ng-readonly="readonlyInput" maxlength="2">\n			</td>\n			<td>:</td>\n			<td class="form-group" ng-class="{\'has-error\': invalidMinutes}">\n				<input style="width:50px;" type="text" ng-model="minutes" ng-change="updateMinutes()" class="form-control text-center" ng-readonly="readonlyInput" maxlength="2">\n			</td>\n			<td ng-show="showMeridian"><button type="button" class="btn btn-default text-center" ng-click="toggleMeridian()">{{meridian}}</button></td>\n		</tr>\n		<tr class="text-center">\n			<td><a ng-click="decrementHours()" class="btn btn-link"><span class="glyphicon glyphicon-chevron-down"></span></a></td>\n			<td>&nbsp;</td>\n			<td><a ng-click="decrementMinutes()" class="btn btn-link"><span class="glyphicon glyphicon-chevron-down"></span></a></td>\n			<td ng-show="showMeridian"></td>\n		</tr>\n	</tbody>\n</table>\n')}]),angular.module("template/typeahead/typeahead-match.html",[]).run(["$templateCache",function(a){a.put("template/typeahead/typeahead-match.html",'<a tabindex="-1" bind-html-unsafe="match.label | typeaheadHighlight:query"></a>')}]),angular.module("template/typeahead/typeahead-popup.html",[]).run(["$templateCache",function(a){a.put("template/typeahead/typeahead-popup.html",'<ul class="dropdown-menu" ng-show="isOpen()" ng-style="{top: position.top+\'px\', left: position.left+\'px\'}" style="display: block;" role="listbox" aria-hidden="{{!isOpen()}}">\n    <li ng-repeat="match in matches track by $index" ng-class="{active: isActive($index) }" ng-mouseenter="selectActive($index)" ng-click="selectMatch($index)" role="option" id="{{match.id}}">\n        <div typeahead-match index="$index" match="match" query="query" template-url="templateUrl"></div>\n    </li>\n</ul>\n')}]),!angular.$$csp()&&angular.element(document).find("head").prepend('<style type="text/css">.ng-animate.item:not(.left):not(.right){-webkit-transition:0s ease-in-out left;transition:0s ease-in-out left}</style>'),angular.module("sessiontimeout",[]).directive("sessionTimeout",["$rootScope","$timeout","$document",function($rootScope,$timeout,$document){return{restrict:"A",link:function(scope,element,attrs){function setTimeOut(){session=$timeout(function(){$timeout(function(){$rootScope.$broadcast("session-timeout"),setTimeOut()},500)},SESSION_TIMEOUT)}var SESSION_TIMEOUT=18e4;angular.element($document[0].body).ready(function(e){setTimeOut()}),angular.element($document[0].body).on("click",function(e){$timeout.cancel(session),setTimeOut()}),angular.element($document[0].body).on("keypress",function(e){$timeout.cancel(session),setTimeOut()});var session}}}]),angular.module("SucursApps").config(function($stateProvider){$stateProvider.state("error",{parent:"site",url:"/error",data:{roles:[],pageTitle:"errors.title"},views:{"content@":{templateUrl:"scripts/app/error/error.html"}}}).state("accessdenied",{parent:"site",url:"/accessdenied",data:{roles:[]},views:{"content@":{templateUrl:"scripts/app/error/accessdenied.html"}}})}),angular.module("SucursApps").config(function($stateProvider){$stateProvider.state("home",{parent:"site",url:"/home",data:{roles:[]},views:{"fullscreen@":{templateUrl:"scripts/app/home/home.html",controller:"HomeController"}},resolve:{DevicesServices:["SucursAppsDevices",function(SucursAppsDevices){return SucursAppsDevices.getInstance()}]}})}),angular.module("SucursApps").controller("HomeController",function($rootScope,$scope,$q,$state,$timeout,Auth,DevicesServices){$scope.user={},$scope.errors={},$scope.errorMessage=null,$scope.command={},$scope.view_usr=!0,$scope.view_pass=!1,$scope.onUserClick=function(){Auth.loginUser($scope.command).then(function(data){return $scope.errorMessage=null,data.ist===!0&&data.bkd===!1&&void 0===data.rcg?($scope.errorMessage="Token pendiente de activación (A02).",void $("#modalErrorMessage").modal("show")):($scope.userData=data,$scope.view_usr=!1,$scope.view_pass_token_cel=!1,$scope.view_pass_token=!1,$scope.view_pass=!1,"A"===$scope.userData.uty&&$scope.userData.ist===!0&&($scope.view_pass_token_cel=!0),"A"===$scope.userData.uty&&$scope.userData.ist===!1&&($scope.view_pass_token=!0),void("B"===$scope.userData.uty&&($scope.view_pass=!0)))})["catch"](function(data){$scope.errorMessage=data.msg,$("#modalErrorMessage").modal("show")})},$scope.onPassClick=function(){Auth.loginPasswordToken($scope.command).then(function(data){$scope.errorMessage=null,$state.go("bxi.menu2")})["catch"](function(data){$scope.errorMessage=data.msg,$("#modalErrorMessage").modal("show")})},$scope.onPasswordBack=function(){$scope.command.pss="",$scope.command.utk="",$scope.view_usr=!0,$scope.view_pass=!1},$scope.onLogin=function(){$("#modalLoginUsuario").modal()},$scope.onPlasticLogin=function(){$("#modalLoginTarjeta").modal()},$scope.soon=function(){$("#modalProximamente").modal()},$scope.onPlasticLoginClick=function(){$("#modalLoginTarjeta").modal(),DevicesServices.pinpadRead().then(function(data){console.log("Pinpad:"+data),Auth.loginCardNumber2(data).then(function(data){$scope.errorMessage=null,$scope.userData=data,$state.go("mca.menu")})["catch"](function(data){data.des&&($scope.errorMessage=data.des),data.CHRmu&&($scope.errorMessage=data.CHRmu),$("#modalErrorMessage").modal("show")})["finally"](function(){$("#modalLoginTarjeta").modal("hide")})})["catch"](function(data){console.log("Pinpad error:"+data),$("#modalLoginTarjeta").modal("hide"),data?(data.des&&($scope.errorMessage=data.des),data.CHRmu&&($scope.errorMessage=data.CHRmu)):$scope.errorMessage="Hubo un problema al comunicacion con el servicio SucursApps Devices",$("#modalErrorMessage").modal("show")})},$scope.bannerItems=[],$scope.loadAll=function(){$("#modalLoginUsuario").on("show.bs.modal",function(e){$scope.command={},$scope.view_usr=!0,$scope.view_pass_token_cel=!1,$scope.view_pass_token=!1,$scope.view_pass=!1})},$scope.loadAll()}),angular.module("SucursApps").config(function($stateProvider){$stateProvider.state("bxi",{parent:"site",url:"/bxi","abstract":!0,views:{"navbar@":{templateUrl:"scripts/components/navbar/navbar-bxi.html",controller:"NavbarBxiController"}},resolve:{authorize:["Auth",function(Auth){return Auth.authorize()}]}})}),angular.module("SucursApps").config(function($stateProvider){$stateProvider.state("bxi.login",{parent:"bxi",url:"/login",data:{roles:[]},views:{"content@":{templateUrl:"scripts/app/bxi/login/login.html",controller:"BxiLoginController"},"navbar@":{templateUrl:"scripts/components/navbar/navbar-client.html",controller:"NavbarClientController"}}}).state("bxi.login.user",{parent:"bxi.login",url:"/user",templateUrl:"scripts/app/bxi/login/login-user.html"}).state("bxi.login.pwd",{parent:"bxi.login",url:"/pwd",templateUrl:"scripts/app/bxi/login/login-pwd.html"})}),angular.module("SucursApps").controller("BxiLoginController",function($rootScope,$scope,$q,$state,$timeout,Auth,Principal,SessionService){Principal.identity().then(function(account){$scope.account=account,$scope.isAuthenticated=Principal.isAuthenticated}),$scope.command={},$timeout(function(){angular.element('[ng-model="username"]').focus()}),$scope.doUserName=function(){Auth.loginUser($scope.command).then(function(data){$scope.errorMessage=null,$scope.userData=data,$state.go("bxi.login.pwd")})["catch"](function(data){$scope.errorMessage=data.msg,$("#modalErrorMessage").modal("show")})},$scope.processForm=function(){Auth.loginPasswordToken($scope.command).then(function(data){$scope.errorMessage=null,$state.go("bxi.menu2")})["catch"](function(data){$scope.errorMessage=data.msg,$("#modalErrorMessage").modal("show")})},$scope.requestChallenge=function(){SessionService.challenge().then(function(data){$scope.challenge=data})["catch"](function(data){$scope.errorMessage=data.msg,$("#modalErrorMessage").modal("show")})}}),angular.module("SucursApps").config(function($stateProvider){$stateProvider.state("bxi.menu2",{parent:"bxi",url:"/menu2",data:{roles:["cliente"]},views:{"content@":{templateUrl:"scripts/app/bxi/menu2/bxi-menu2.html",controller:"BxiMenu2Controller"},"navbar@":{templateUrl:"scripts/components/navbar/navbar-bxi-menu.html",controller:"NavbarBxiController"}}})}),angular.module("SucursApps").controller("BxiMenu2Controller",function($rootScope,$scope,$state,Principal){Principal.identity().then(function(account){$scope.account=account,$scope.isAuthenticated=Principal.isAuthenticated,$rootScope.currentFlow="bxi"})}),angular.module("SucursApps").config(function($stateProvider){$stateProvider.state("bxi.accounts",{parent:"bxi",url:"/accounts",data:{roles:["cliente"]},views:{"content@":{templateUrl:"scripts/app/bxi/accounts/accounts.html",controller:"BxiAccountsController"},"navbar@":{templateUrl:"scripts/components/navbar/navbar-bxi-modal.html"}}}).state("bxi.accounts.list",{parent:"bxi.accounts",url:"/list",templateUrl:"scripts/app/bxi/accounts/accounts-list.html"}).state("bxi.accounts.detail",{parent:"bxi.accounts",url:"/detail",templateUrl:"scripts/app/bxi/accounts/accounts-detail.html"})}),angular.module("SucursApps").controller("BxiAccountsController",["$scope","$state","Principal","AccountsService",function($scope,$state,Principal,AccountsService){Principal.identity().then(function(account){$scope.account=account,$scope.isAuthenticated=Principal.isAuthenticated}),$scope.account=null,$scope.accounts=[],$scope.currentItem={},$scope.type=[],$scope.pageSize=4,$scope.pageSize_det=8,$scope.currentPageDep=0,$scope.currentPageCr=0,$scope.currentPageCo=0,$scope.currentPageDet=0,$scope.account_cicle=0,$scope.numberOfPagesDep=function(){return void 0!==$scope.data_chpl?Math.ceil($scope.data_chpl.length/$scope.pageSize):void 0},$scope.numberOfPagesCr=function(){return void 0!==$scope.data_crpl?Math.ceil($scope.data_crpl.length/$scope.pageSize):void 0},$scope.numberOfPagesCo=function(){return void 0!==$scope.data_copl?Math.ceil($scope.data_copl.length/$scope.pageSize):void 0},$scope.numberOfPagesDet=function(){return $scope.account_transaccions?Math.ceil($scope.account_transaccions.length/$scope.pageSize_det-1):void 0},$scope.viewDetail=function(item,type){$scope.currentItem=item,$scope.type=type,AccountsService.getBalance(item.accid).then(function(data){$scope.account_balance=data,$scope.errorMessage=null})["catch"](function(data){$scope.errorMessage=data.msg}),$scope.updateTransactions($scope.account_cicle),$state.go("bxi.accounts.detail")},$scope.updateTransactions=function(account_cicle){AccountsService.getTransactions($scope.currentItem.accid,account_cicle,$scope.type).then(function(data){$scope.account_transaccions=data.trans,$scope.errorMessage=null})["catch"](function(data){$scope.errorMessage=data.msg})},$scope.loadAll=function(){AccountsService.getAllAccounts().then(function(data){$scope.accounts=data,$scope.errorMessage=null;var chpl=[],crpl=[],copl=[];void 0!==data.chpl&&angular.extend(chpl,data.chpl),void 0!==data.chdl&&angular.extend(chpl,data.chdl),void 0!==data.crpl&&angular.extend(crpl,data.crpl),void 0!==data.crdl&&angular.extend(crpl,data.crdl),void 0!==data.copl&&angular.extend(copl,data.copl),void 0!==data.socl&&angular.extend(copl,data.socl),void 0!==data.codl&&angular.extend(copl,data.codl),$scope.data_chpl=chpl,$scope.data_crpl=crpl,$scope.data_copl=copl})["catch"](function(data){$scope.errorMessage=data.msg})},$scope.loadAll()}]),angular.module("SucursApps").controller("BxiAccountsDetailController",function($scope,$stateParams,Principal,AccountsService){Principal.identity().then(function(account){$scope.account=account,$scope.isAuthenticated=Principal.isAuthenticated}),$scope.account=null,$scope.accounts=[],$scope.id=null,$scope.type=null,$scope.account_balance=[],$scope.account_transaccions=[],$scope.account_cicle=0,$scope.updateTransactions=function(){AccountsService.getTransactions($scope.id,$scope.account_cicle,$scope.type).then(function(data){$scope.account_transaccions=data.trans,$scope.errorMessage=null})["catch"](function(data){$scope.errorMessage=data.msg})},$scope.loadAll=function(id,type){$scope.id=id,$scope.type=type,AccountsService.getBalance(id).then(function(data){$scope.account_balance=data,$scope.errorMessage=null})["catch"](function(data){$scope.errorMessage=data.msg}),AccountsService.getTransactions(id,$scope.account_cicle,type).then(function(data){$scope.account_transaccions=data,$scope.errorMessage=null})["catch"](function(data){$scope.errorMessage=data.msg})},$scope.loadAll($stateParams.id,$stateParams.type)}),angular.module("SucursApps").config(function($stateProvider){$stateProvider.state("bxi.transfer",{parent:"bxi",url:"/transfer",views:{"content@":{templateUrl:"scripts/app/bxi/transfer/transfer.html",controller:"BxiTransferController"},"navbar@":{templateUrl:"scripts/components/navbar/navbar-bxi-modal.html"}}})}),angular.module("SucursApps").controller("BxiTransferController",function($scope,Principal){Principal.identity().then(function(account){$scope.account=account,$scope.isAuthenticated=Principal.isAuthenticated})}),angular.module("SucursApps").config(function($stateProvider){$stateProvider.state("bxi.transfer.own",{parent:"bxi.transfer",url:"/own",data:{roles:["cliente"]},views:{"content@":{templateUrl:"scripts/app/bxi/transfer/own/transfer-own.html",controller:"BxiTransferOwnController"}}}).state("bxi.transfer.own.accs",{parent:"bxi.transfer.own",url:"/accs",templateUrl:"scripts/app/bxi/transfer/own/transfer-own-accs.html"}).state("bxi.transfer.own.finish",{parent:"bxi.transfer.own",url:"/finish",templateUrl:"scripts/app/bxi/transfer/own/transfer-own-finish.html"})}),angular.module("SucursApps").controller("BxiTransferOwnController",function($rootScope,$scope,$state,Principal,AccountsService,TransfersService){$scope.command={},$scope.setSelectedOriginAccount=function(account){$scope.command.originAccount=account,$scope.command.oaccid=account.accid,$scope.command.accal=account.accal,$(".dropdown").removeClass("open")},$scope.setSelectedDestinyAccount=function(account){$scope.command.destinyAccount=account,$scope.command.daccid=account.accid,$scope.command.accal=account.accal,$(".dropdown").removeClass("open")},$scope.onSiguiente01=function(){$scope.command.password=null,$("#confirmModal").modal()},$scope.onProcessTransfer=function(){TransfersService.doTransfer($scope.command,"own").then(function(data){$scope.confirmation=data,$state.go("bxi.transfer.own.finish")})["catch"](function(data){$scope.errorMessage=data.msg,$("#modalErrorMessage").modal("show")})},$scope.load=function(){$("#modalBXINotificacionComprobante").modal("show"),AccountsService.getAccountsByType("own").then(function(data){$scope.ownAccounts=data.ownAccounts,$scope.destinyAccounts=data.destinyAccounts},function(data){$scope.errorMessage=data}),Principal.identity().then(function(account){$scope.account=account,$scope.isAuthenticated=Principal.isAuthenticated})},$scope.load()}),angular.module("SucursApps").config(function($stateProvider){$stateProvider.state("bxi.transfer.third",{parent:"bxi.transfer",url:"/third",data:{roles:["cliente"]},views:{"content@":{templateUrl:"scripts/app/bxi/transfer/third/transfer-third.html",controller:"BxiTransferThirdController"}}}).state("bxi.transfer.third.init",{parent:"bxi.transfer.third",url:"/init",templateUrl:"scripts/app/bxi/transfer/third/transfer-third-init.html"}).state("bxi.transfer.third.finish",{parent:"bxi.transfer.third",url:"/finish",templateUrl:"scripts/app/bxi/transfer/third/transfer-third-finish.html"})}),angular.module("SucursApps").controller("BxiTransferThirdController",function($rootScope,$scope,$state,Principal,AccountsService,TransfersService,SessionService){$scope.command={},$scope.ACCOUNT_TYPE="thirdparty",$scope.setSelectedOriginAccount=function(account){$scope.command.originAccount=account,$scope.command.oaccid=account.accid,$scope.command.accal=account.accal,$(".dropdown").removeClass("open")},$scope.setSelectedDestinyAccount=function(account){$scope.command.destinyAccount=account,$scope.command.daccid=account.acoId,$scope.command.accal=account.oali,$(".dropdown").removeClass("open")},$scope.onSiguiente01=function(){$scope.requestChallenge(),$scope.command.password=null,$("#confirmModal").modal()},$scope.onProcessTransfer=function(){TransfersService.doTransfer($scope.command,$scope.ACCOUNT_TYPE).then(function(data){$scope.confirmation=data,$state.go("bxi.transfer.third.finish")})["catch"](function(data){$scope.errorMessage=data.msg,$("#modalErrorMessage").modal("show"),$scope.requestChallenge()})},$scope.requestChallenge=function(){SessionService.challenge().then(function(data){$scope.challenge=data})["catch"](function(data){$scope.errorMessage=data.msg,$("#modalErrorMessage").modal("show")})},$scope.load=function(){$("#modalBXINotificacionComprobante").modal("show"),AccountsService.getAccountsByType($scope.ACCOUNT_TYPE).then(function(data){$scope.ownAccounts=data.thirdOwnAccounts,$scope.destinyAccounts=data.thirdDestinyAccounts})["catch"](function(data){$scope.errorMessage=data.msg,$("#modalErrorMessage").modal("show")})},$scope.load(),Principal.identity().then(function(account){console.log("account ".concat(account)),$scope.account=account,$scope.isAuthenticated=Principal.isAuthenticated})}),angular.module("SucursApps").config(function($stateProvider){$stateProvider.state("bxi.transfer.spei",{parent:"bxi.transfer",url:"/menu",data:{roles:["cliente"]},views:{"content@":{templateUrl:"scripts/app/bxi/transfer/spei/transfer-spei.html"}}}).state("bxi.transfer.spei.gen",{parent:"bxi.transfer.spei",url:"/gen",views:{"content@":{templateUrl:"scripts/app/bxi/transfer/spei/transfer-spei-gen.html",controller:"BxiTransferSpeiGenController"}}}).state("bxi.transfer.spei.gen.init",{parent:"bxi.transfer.spei.gen",url:"/init",templateUrl:"scripts/app/bxi/transfer/spei/transfer-spei-gen-init.html"}).state("bxi.transfer.spei.gen.finish",{parent:"bxi.transfer.spei.gen",url:"/finish",templateUrl:"scripts/app/bxi/transfer/spei/transfer-spei-gen-finish.html"}).state("bxi.transfer.spei.actives",{parent:"bxi.transfer",url:"/actives",views:{"content@":{templateUrl:"scripts/app/bxi/transfer/spei/transfer-spei-actives.html",controller:"BxiTransferSpeiActivesController"},"navbar@":{templateUrl:"scripts/components/navbar/navbar-client.html",controller:"NavbarClientController"}}}).state("bxi.transfer.spei.actives.search",{parent:"bxi.transfer.spei.actives",url:"/search",templateUrl:"scripts/app/bxi/transfer/spei/transfer-spei-search.html"}).state("bxi.transfer.spei.actives.detail",{
parent:"bxi.transfer.spei.actives",url:"/cancel",templateUrl:"scripts/app/bxi/transfer/spei/transfer-spei-detail.html"})}),angular.module("SucursApps").controller("BxiTransferSpeiGenController",function($rootScope,$scope,$state,Principal,AccountsService,TransfersService,SessionService){$scope.command={},$scope.ACCOUNT_TYPE="spei",$scope.setSelectedOriginAccount=function(account){$scope.command.originAccount=account,$scope.command.oaccid=account.accid,$scope.command.accal=account.accal,$(".dropdown").removeClass("open")},$scope.setSelectedDestinyAccount=function(account){$scope.command.destinyAccount=account,$scope.command.daccid=account.acoId,$scope.command.accal=account.oali,$(".dropdown").removeClass("open")},$scope.onProcessTransfer=function(){TransfersService.doTransfer($scope.command,$scope.ACCOUNT_TYPE).then(function(data){$scope.confirmation=data,$state.go("bxi.transfer.spei.gen.finish")})["catch"](function(data){$scope.errorMessage=data.msg,$("#modalErrorMessage").modal("show"),$scope.requestChallenge()})},$scope.onSiguiente01=function(){$scope.command.password=null,$("#confirmModal").modal()},$scope.requestChallenge=function(){SessionService.challenge().then(function(data){$scope.challenge=data})["catch"](function(data){$scope.errorMessage=data.msg,$("#modalErrorMessage").modal("show")})},$scope.load=function(){$("#modalBXINotificacionComprobante").modal("show"),$scope.requestChallenge(),AccountsService.getAccountsByType($scope.ACCOUNT_TYPE).then(function(data){$scope.ownAccounts=data.ownSpeiAccounts,$scope.destinyAccounts=data.destinySpeiAccounts})["catch"](function(data){$scope.errorMessage=data.msg,$("#modalErrorMessage").modal("show")})},Principal.identity().then(function(account){$scope.account=account,$scope.isAuthenticated=Principal.isAuthenticated}),$scope.load()}).controller("BxiTransferSpeiActivesController",function($rootScope,$scope,$state,Principal,AccountsService,TransfersService){Principal.identity().then(function(account){$scope.account=account,$scope.isAuthenticated=Principal.isAuthenticated}),$scope.onViewDetail=function(item){$rootScope.currentItem=item,$state.go("bxi.transfer.spei.actives.detail")},$scope.load=function(){TransfersService.getSpeiList().then(function(data){$scope.speiItems=data})["catch"](function(data){$scope.errorMessage=data.msg})},$scope.load()}),angular.module("SucursApps").config(function($stateProvider){$stateProvider.state("bxi.transfer.tef",{parent:"bxi.transfer",url:"/menu",data:{roles:["cliente"]},views:{"content@":{templateUrl:"scripts/app/bxi/transfer/tef/transfer-tef.html"}}}).state("bxi.transfer.tef.gen",{parent:"bxi.transfer",url:"/gen",views:{"content@":{templateUrl:"scripts/app/bxi/transfer/tef/transfer-tef-gen.html",controller:"BxiTransferTefGenController"}}}).state("bxi.transfer.tef.gen.init",{parent:"bxi.transfer.tef.gen",url:"/init",templateUrl:"scripts/app/bxi/transfer/tef/transfer-tef-init.html"}).state("bxi.transfer.tef.gen.finish",{parent:"bxi.transfer.tef.gen",url:"/finish",templateUrl:"scripts/app/bxi/transfer/tef/transfer-tef-finish.html"}).state("bxi.transfer.tef.actives",{parent:"bxi.transfer",url:"/actives",views:{"content@":{templateUrl:"scripts/app/bxi/transfer/tef/transfer-tef-actives.html",controller:"BxiTransferTefActivesController"},"navbar@":{templateUrl:"scripts/components/navbar/navbar-client.html",controller:"NavbarClientController"}}}).state("bxi.transfer.tef.actives.search",{parent:"bxi.transfer.tef.actives",url:"/search",templateUrl:"scripts/app/bxi/transfer/tef/transfer-tef-search.html"}).state("bxi.transfer.tef.actives.detail",{parent:"bxi.transfer.tef.actives",url:"/detail",templateUrl:"scripts/app/bxi/transfer/tef/transfer-detail-cancel.html"}).state("bxi.transfer.tef.actives.cancel",{parent:"bxi.transfer.tef.actives",url:"/cancel",templateUrl:"scripts/app/bxi/transfer/tef/transfer-tef-cancel.html"}).state("bxi.transfer.tef.actives.canceled",{parent:"bxi.transfer.tef.actives",url:"/canceled",templateUrl:"scripts/app/bxi/transfer/tef/transfer-tef-canceled.html"})}),angular.module("SucursApps").controller("BxiTransferTefGenController",function($rootScope,$scope,$state,Principal,AccountsService,TransfersService,SessionService){$scope.command={},$scope.ACCOUNT_TYPE="tef",$scope.setSelectedOriginAccount=function(account){$scope.command.originAccount=account,$scope.command.oaccid=account.accid,$scope.command.accal=account.accal,$(".dropdown").removeClass("open")},$scope.setSelectedDestinyAccount=function(account){$scope.command.destinyAccount=account,$scope.command.daccid=account.acoId,$scope.command.accal=account.oali,$(".dropdown").removeClass("open")},$scope.onProcessTransfer=function(){TransfersService.doTransfer($scope.command,$scope.ACCOUNT_TYPE).then(function(data){$scope.confirmation=data,$state.go("bxi.transfer.tef.gen.finish")})["catch"](function(data){$scope.errorMessage=data.msg,$("#modalErrorMessage").modal("show"),$scope.command.password=null,$scope.requestChallenge()})},$scope.onSiguiente01=function(){$scope.command.password=null,$("#confirmModal").modal()},$scope.requestChallenge=function(){SessionService.challenge().then(function(data){$scope.challenge=data})["catch"](function(data){$scope.errorMessage=data.msg,$("#modalErrorMessage").modal("show")})},$scope.load=function(){$("#modalBXINotificacionComprobante").modal("show"),$scope.requestChallenge(),AccountsService.getAccountsByType($scope.ACCOUNT_TYPE).then(function(data){$scope.ownAccounts=data.ownTEFAccounts,$scope.destinyAccounts=data.destinyTEFAccounts})["catch"](function(data){$scope.errorMessage=data.msg,$("#modalErrorMessage").modal("show")}),Principal.identity().then(function(account){$scope.account=account,$scope.isAuthenticated=Principal.isAuthenticated})},$scope.load()}).controller("BxiTransferTefActivesController",function($rootScope,$scope,$state,Principal,AccountsService,TransfersService){Principal.identity().then(function(account){$scope.account=account,$scope.isAuthenticated=Principal.isAuthenticated}),$scope.onViewDetail=function(item){$scope.selectedItem=item,$state.go("bxi.transfer.tef.actives.detail")},$scope.doCancel=function(){TransfersService.cancelTef($scope.selectedItem).then(function(data){$scope.confirmation=data,$state.go("bxi.transfer.tef.actives.canceled")})["catch"](function(data){$scope.errorMessage=data.msg})},$scope.load=function(){TransfersService.getTefList().then(function(data){$scope.listItems=data})["catch"](function(data){$scope.errorMessage=data.msg})},$scope.load()}),angular.module("SucursApps").config(function($stateProvider){$stateProvider.state("bxi.transfer.quick",{parent:"bxi.transfer",url:"/quick",data:{roles:["cliente"]},views:{"content@":{templateUrl:"scripts/app/bxi/transfer/quick/transfer-quick.html",controller:"BxiTransferQuickController"}}}).state("bxi.transfer.quick.info",{parent:"bxi.transfer.quick",url:"/info",templateUrl:"scripts/app/bxi/transfer/quick/transfer-quick-info.html"}).state("bxi.transfer.quick.init",{parent:"bxi.transfer.quick",url:"/init",templateUrl:"scripts/app/bxi/transfer/quick/transfer-quick-init.html"}).state("bxi.transfer.quick.finish",{parent:"bxi.transfer.quick",url:"/finish",templateUrl:"scripts/app/bxi/transfer/quick/transfer-quick-finish.html"})}),angular.module("SucursApps").controller("BxiTransferQuickController",function($rootScope,$scope,$state,Principal,AccountsService,TransfersService,SessionService,SpeiMovilService){$scope.ACCOUNT_TYPE="quickpay",$scope.cde="",$scope.command={},$scope.banorteBank={id:"22",nme:"Banorte/Ixe"},$scope.setSelectedOriginAccount=function(account){$scope.command.originAccount=account,$scope.command.oaccid=account.accid,$scope.command.accal=account.accal,$(".dropdown").removeClass("open")},$scope.onSiguiente01=function(){"acnum"===$scope.command.accountType&&($scope.command.destBank=$scope.banorteBank),"celular"===$scope.command.accountType&&($scope.command.cel=!0,"Nuevo Celular"!==$scope.command.phone.pho&&($scope.command.destAccountId=$scope.command.phone.pho,$scope.command.destBank=$scope.getBankFromId($scope.command.phone.idBk))),$scope.command.cde=null,$("#confirmModal").modal()},$scope.getBankFromId=function(id){if(void 0!==id)for(var i=0;i<$scope.banks.length;i++)if($scope.banks[i].id===id)return $scope.banks[i]},$scope.onProcessTransfer=function(){TransfersService.doTransfer($scope.command,$scope.ACCOUNT_TYPE).then(function(data){$scope.confirmation=data,$state.go("bxi.transfer.quick.finish")})["catch"](function(data){$scope.command.cde=null,$scope.requestChallenge(),$scope.errorMessage=data.msg,$("#modalErrorMessage").modal("show")})},$scope.requestChallenge=function(){SessionService.challenge().then(function(data){$scope.challenge=data})["catch"](function(data){$scope.errorMessage=data.msg,$("#modalErrorMessage").modal("show")})},$scope.load=function(){$("#modalBXINotificacionComprobante").modal("show"),$scope.requestChallenge(),SpeiMovilService.frequentPhones().then(function(data){$scope.frequentPhones=[],$scope.frequentPhones[0]={pho:"Nuevo Celular"};var index;for(index=1;index<data.length+1;++index){var data_index=index-1;$scope.frequentPhones[index]=data[data_index]}})["catch"](function(data){$scope.errorMessage=data.msg,$("#modalErrorMessage").modal("show")}),AccountsService.getAccountsAndBanks().then(function(data){$scope.ownAccounts=data.qpAccounts,$scope.banks=data.banks}),Principal.identity().then(function(account){$scope.account=account,$scope.isAuthenticated=Principal.isAuthenticated})},$scope.load()}),angular.module("SucursApps").config(function($stateProvider){$stateProvider.state("bxi.transfer.noplastic",{parent:"bxi.transfer",url:"/menu",data:{roles:["cliente"]},views:{"content@":{templateUrl:"scripts/app/bxi/transfer/noplastic/transfer-noplastic.html"}}}).state("bxi.transfer.noplastic.gen",{parent:"bxi.transfer",url:"/gen",views:{"content@":{templateUrl:"scripts/app/bxi/transfer/noplastic/transfer-noplastic-gen.html",controller:"BxiTransferNoPlasticGenController"},"navbar@":{templateUrl:"scripts/components/navbar/navbar-client.html",controller:"NavbarClientController"}}}).state("bxi.transfer.noplastic.gen.info",{parent:"bxi.transfer.noplastic.gen",url:"/info",templateUrl:"scripts/app/bxi/transfer/noplastic/transfer-noplastic-info.html"}).state("bxi.transfer.noplastic.gen.secure",{parent:"bxi.transfer.noplastic.gen",url:"/secure",templateUrl:"scripts/app/bxi/transfer/noplastic/transfer-noplastic-secure.html"}).state("bxi.transfer.noplastic.gen.init",{parent:"bxi.transfer.noplastic.gen",url:"/init",templateUrl:"scripts/app/bxi/transfer/noplastic/transfer-noplastic-init.html"}).state("bxi.transfer.noplastic.gen.verify",{parent:"bxi.transfer.noplastic.gen",url:"/verify",templateUrl:"scripts/app/bxi/transfer/noplastic/transfer-noplastic-verify.html"}).state("bxi.transfer.noplastic.gen.finish",{parent:"bxi.transfer.noplastic.gen",url:"/finish",templateUrl:"scripts/app/bxi/transfer/noplastic/transfer-noplastic-finish.html"}).state("bxi.transfer.noplastic.actives",{parent:"bxi.transfer",url:"/actives",views:{"content@":{templateUrl:"scripts/app/bxi/transfer/noplastic/transfer-noplastic-actives.html",controller:"BxiTransferNoPlasticActivesController"},"navbar@":{templateUrl:"scripts/components/navbar/navbar-client.html",controller:"NavbarClientController"}}}).state("bxi.transfer.noplastic.actives.search",{parent:"bxi.transfer.noplastic.actives",url:"/search",templateUrl:"scripts/app/bxi/transfer/noplastic/transfer-noplastic-search.html"}).state("bxi.transfer.noplastic.actives.cancel",{parent:"bxi.transfer.noplastic.actives",url:"/cancel",templateUrl:"scripts/app/bxi/transfer/noplastic/transfer-noplastic-cancel.html"}).state("client.transfer.noplastic.actives.canceled",{parent:"client.transfer.noplastic.actives",url:"/canceled",templateUrl:"scripts/app/bxi/transfer/noplastic/transfer-noplastic-canceled.html"})}),angular.module("SucursApps").controller("BxiTransferNoPlasticGenController",function($rootScope,$scope,$state,Principal,AccountsService,SessionService,TransfersService){Principal.identity().then(function(account){$scope.account=account,$scope.isAuthenticated=Principal.isAuthenticated}),$scope.ACCOUNT_TYPE="noplastic",$scope.cde="",$scope.requestChallenge=function(){SessionService.challenge().then(function(data){$scope.challenge=data})["catch"](function(data){$scope.errorMessage=data.msg})},$scope.doTransfer=function(){TransfersService.doTransfer({originAccount:$scope.originAccount,amount:$scope.amount,description:$scope.description,cde:$scope.cde},$scope.ACCOUNT_TYPE).then(function(data){$scope.confirmation=data,$state.go("bxi.transfer.noplastic.gen.finish")})["catch"](function(data){$scope.errorMessage=data.msg,$scope.requestChallenge()})},$scope.load=function(){$scope.requestChallenge(),AccountsService.getAccountsByType($scope.ACCOUNT_TYPE).then(function(data){$scope.ownAccounts=data.ownTEFAccounts,$scope.destinyAccounts=data.destinyTEFAccounts})["catch"](function(data){$scope.errorMessage=data.msg})},$scope.load()}).controller("ClientTransferNoPlasticActivesController",function($rootScope,$scope,$state,Principal,AccountsService,TransfersService){Principal.identity().then(function(account){$scope.account=account,$scope.isAuthenticated=Principal.isAuthenticated}),$scope.onViewDetail=function(item){$rootScope.selectedItem=item,$state.go("client.transfer.noplastic.detail")},$scope.onCancelItem=function(){$state.go("client.transfer.noplastic.cancel")},$scope.doCancelItem=function(){TransfersService.cancelTef($rootScope.selectedItem).then(function(data){$scope.confirmation=data,$state.go("client.transfer.noplastic.canceled")})["catch"](function(data){$scope.errorMessage=data.msg})},$scope.load=function(){TransfersService.getTefList().then(function(data){$scope.listItems=data})["catch"](function(data){$scope.errorMessage=data.msg})},$scope.load()}),angular.module("SucursApps").config(function($stateProvider){$stateProvider.state("bxi.payment",{parent:"bxi",url:"/payment",views:{"content@":{templateUrl:"scripts/app/bxi/payment/payment.html",controller:"BxiPaymentController"},"navbar@":{templateUrl:"scripts/components/navbar/navbar-bxi-modal.html"}}})}),angular.module("SucursApps").controller("BxiPaymentController",function($scope,Principal){Principal.identity().then(function(account){$scope.account=account,$scope.isAuthenticated=Principal.isAuthenticated})}),angular.module("SucursApps").config(function($stateProvider){$stateProvider.state("bxi.payment.cc",{parent:"bxi.payment",url:"/cc",data:{roles:["cliente"]},views:{"content@":{templateUrl:"scripts/app/bxi/payment/cc/payment-cc.html"}}})}),angular.module("SucursApps").controller("BxiPaymentCCController",function($rootScope,$scope,$state,Principal){Principal.identity().then(function(account){$scope.account=account,$scope.isAuthenticated=Principal.isAuthenticated})}),angular.module("SucursApps").config(function($stateProvider){$stateProvider.state("bxi.payment.cc.own",{parent:"bxi.payment.cc",url:"/own",data:{roles:["cliente"]},views:{"content@":{templateUrl:"scripts/app/bxi/payment/cc/own/payment-cc-own.html",controller:"BxiPaymentCCOwnController"}}}).state("bxi.payment.cc.own.accounts",{parent:"bxi.payment.cc.own",url:"/accounts",templateUrl:"scripts/app/bxi/payment/cc/own/payment-cc-own-accs.html"}).state("bxi.payment.cc.own.verify",{parent:"bxi.payment.cc.own",url:"/verify",templateUrl:"scripts/app/bxi/payment/cc/own/payment-cc-own-verify.html"}).state("bxi.payment.cc.own.finish",{parent:"bxi.payment.cc.own",url:"/finish",templateUrl:"scripts/app/bxi/payment/cc/own/payment-cc-own-finish.html"})}),angular.module("SucursApps").controller("BxiPaymentCCOwnController",function($rootScope,$scope,$state,Principal,AccountsService,CCPaymentService,SessionService){$scope.TYPE="own",$scope.command={},$scope.setSelectedOriginAccount=function(account){$scope.command.ccOriginAccount=account,$scope.command.oaccid=account.accid,$scope.command.accal=account.accal,$(".dropdown").removeClass("open")},$scope.setSelectedDestinyAccount=function(account){$scope.command.ccDestinyAccount=account,$scope.command.daccid=account.accid,$scope.command.accal=account.accal,$(".dropdown").removeClass("open"),CCPaymentService.getAmountsOwnPaymentCC(account.accid).then(function(data){$scope.amounts=data})["catch"](function(data){$scope.errorMessage=data.msg,$("#modalErrorMessage").modal("show")})},$scope.onSiguiente01=function(){$scope.command.password=null,$("#confirmModal").modal()},$scope.onProcessTransfer=function(){CCPaymentService.doPaymentCC($scope.command,$scope.TYPE).then(function(data){$scope.confirmation=data,$state.go("bxi.payment.cc.own.finish")})["catch"](function(data){$scope.errorMessage=data.msg,$("#modalErrorMessage").modal("show"),$scope.requestChallenge()})},$scope.requestChallenge=function(){SessionService.challenge().then(function(data){$scope.challenge=data})["catch"](function(data){$scope.errorMessage=data.msg,$("#modalErrorMessage").modal("show")})},$scope.setAmount=function(amount,index){$scope.command.amount=amount},$scope.isEmailChecked=!1,$scope.onEmailChange=function(){$scope.isEmailChecked=!0},$scope.load=function(){$("#modalBXINotificacionComprobante").modal("show"),$scope.requestChallenge(),AccountsService.getAccountsPaymentCC("own").then(function(data){$scope.ccOwnAccounts=data.ccOwnAccounts,$scope.ccDestinyAccounts=data.ccDestinyAccounts})["catch"](function(data){$scope.errorMessage=data.msg,$("#modalErrorMessage").modal("show")}),Principal.identity().then(function(account){$scope.account=account,$scope.isAuthenticated=Principal.isAuthenticated})},$scope.load()}),angular.module("SucursApps").config(function($stateProvider){$stateProvider.state("bxi.payment.cc.third",{parent:"bxi.payment.cc",url:"/third",data:{roles:["cliente"]},views:{"content@":{templateUrl:"scripts/app/bxi/payment/cc/third/payment-cc-third.html",controller:"BxiPaymentCCThirdController"}}}).state("bxi.payment.cc.third.accounts",{parent:"bxi.payment.cc.third",url:"/accounts",templateUrl:"scripts/app/bxi/payment/cc/third/payment-cc-third-accs.html"}).state("bxi.payment.cc.third.verify",{parent:"bxi.payment.cc.third",url:"/verify",templateUrl:"scripts/app/bxi/payment/cc/third/payment-cc-third-verify.html"}).state("bxi.payment.cc.third.finish",{parent:"bxi.payment.cc.third",url:"/finish",templateUrl:"scripts/app/bxi/payment/cc/third/payment-cc-third-finish.html"})}),angular.module("SucursApps").controller("BxiPaymentCCThirdController",function($rootScope,$scope,$state,Principal,AccountsService,CCPaymentService,SessionService){$scope.TYPE="thirdparty",$scope.command={},$scope.setSelectedOriginAccount=function(account){$scope.command.ccOriginAccount=account,$scope.command.oaccid=account.accid,$scope.command.accal=account.accal,$(".dropdown").removeClass("open")},$scope.setSelectedDestinyAccount=function(account){$scope.command.ccDestinyAccount=account,$scope.command.daccid=account.accid,$scope.command.accal=account.accal,$(".dropdown").removeClass("open"),CCPaymentService.getAmountsOwnPaymentCC(account.accid).then(function(data){$scope.amounts=data})["catch"](function(data){$scope.errorMessage=data.msg,$("#modalErrorMessage").modal("show")})},$scope.onSiguiente01=function(){$scope.command.password=null,$("#confirmModal").modal()},$scope.onProcessTransfer=function(){CCPaymentService.doPaymentCC($scope.command,$scope.TYPE).then(function(data){$scope.confirmation=data,$state.go("bxi.payment.cc.third.finish")})["catch"](function(data){$scope.errorMessage=data.msg,$("#modalErrorMessage").modal("show"),$scope.requestChallenge()})},$scope.requestChallenge=function(){SessionService.challenge().then(function(data){$scope.challenge=data})["catch"](function(data){$scope.errorMessage=data.msg,$("#modalErrorMessage").modal("show")})},$scope.load=function(){$("#modalBXINotificacionComprobante").modal("show"),$scope.requestChallenge(),AccountsService.getAccountsPaymentCC($scope.TYPE).then(function(data){$scope.ccOwnAccounts=data.ccThirdPartyOwnAccounts,$scope.ccDestinyAccounts=data.ccThirdPartyDestinyAccounts})["catch"](function(data){$scope.errorMessage=data.msg,$("#modalErrorMessage").modal("show")}),Principal.identity().then(function(account){$scope.account=account,$scope.isAuthenticated=Principal.isAuthenticated})},$scope.load()}),angular.module("SucursApps").config(function($stateProvider){$stateProvider.state("bxi.payment.cc.external",{parent:"bxi.payment.cc",url:"/external",data:{roles:["cliente"]},views:{"content@":{templateUrl:"scripts/app/bxi/payment/cc/external/payment-cc-external.html",controller:"BxiPaymentCCExternalController"}}}).state("bxi.payment.cc.external.accounts",{parent:"bxi.payment.cc.external",url:"/accounts",templateUrl:"scripts/app/bxi/payment/cc/external/payment-cc-external-accs.html"}).state("bxi.payment.cc.external.verify",{parent:"bxi.payment.cc.external",url:"/verify",templateUrl:"scripts/app/bxi/payment/cc/external/payment-cc-external-verify.html"}).state("bxi.payment.cc.external.finish",{parent:"bxi.payment.cc.external",url:"/finish",templateUrl:"scripts/app/bxi/payment/cc/external/payment-cc-external-finish.html"})}),angular.module("SucursApps").controller("BxiPaymentCCExternalController",function($rootScope,$scope,$state,Principal,AccountsService,CCPaymentService,SessionService){$scope.TYPE="external",$scope.command={},$scope.setSelectedOriginAccount=function(account){$scope.command.ccOriginAccount=account,$scope.command.oaccid=account.accid,$scope.command.accal=account.accal,$(".dropdown").removeClass("open")},$scope.setSelectedDestinyAccount=function(account){$scope.command.ccDestinyAccount=account,$scope.command.daccid=account.accid,$scope.command.accal=account.accal,$(".dropdown").removeClass("open"),CCPaymentService.getAmountsOwnPaymentCC(account.accid).then(function(data){$scope.amounts=data})["catch"](function(data){$scope.errorMessage=data.msg,$("#modalErrorMessage").modal("show")})},$scope.onSiguiente01=function(){$scope.command.password=null,$("#confirmModal").modal()},$scope.onProcessTransfer=function(){CCPaymentService.doPaymentCC($scope.command,$scope.TYPE).then(function(data){$scope.confirmation=data,$state.go("bxi.payment.cc.external.finish")})["catch"](function(data){$scope.errorMessage=data.msg,$("#modalErrorMessage").modal("show"),$scope.requestChallenge()})},$scope.requestChallenge=function(){SessionService.challenge().then(function(data){$scope.challenge=data})["catch"](function(data){$scope.errorMessage=data.msg,$("#modalErrorMessage").modal("show")})},$scope.load=function(){$("#modalBXINotificacionComprobante").modal("show"),$scope.requestChallenge(),AccountsService.getAccountsPaymentCC($scope.TYPE).then(function(data){$scope.ccOwnAccounts=data.ccExternalOwnAccounts,$scope.ccDestinyAccounts=data.ccExternalDestinyAccounts})["catch"](function(data){$scope.errorMessage=data.msg,$("#modalErrorMessage").modal("show")}),Principal.identity().then(function(account){$scope.account=account,$scope.isAuthenticated=Principal.isAuthenticated})},$scope.load()}),angular.module("SucursApps").config(function($stateProvider){$stateProvider.state("bxi.payment.cc.amex",{parent:"bxi.payment.cc",url:"/amex",data:{roles:["cliente"]},views:{"content@":{templateUrl:"scripts/app/bxi/payment/cc/amex/payment-cc-amex.html",controller:"BxiPaymentCCAmexController"}}}).state("bxi.payment.cc.amex.accounts",{parent:"bxi.payment.cc.amex",url:"/accounts",templateUrl:"scripts/app/bxi/payment/cc/amex/payment-cc-amex-accs.html"}).state("bxi.payment.cc.amex.verify",{parent:"bxi.payment.cc.amex",url:"/verify",templateUrl:"scripts/app/bxi/payment/cc/amex/payment-cc-amex-verify.html"}).state("bxi.payment.cc.amex.finish",{parent:"bxi.payment.cc.amex",url:"/finish",templateUrl:"scripts/app/bxi/payment/cc/amex/payment-cc-amex-finish.html"})}),angular.module("SucursApps").controller("BxiPaymentCCAmexController",function($rootScope,$scope,$state,Principal,AccountsService,CCPaymentService,SessionService){Principal.identity().then(function(account){$scope.account=account,$scope.isAuthenticated=Principal.isAuthenticated}),$scope.TYPE="amex",$scope.command={},$scope.setSelectedOriginAccount=function(account){$scope.command.ccOriginAccount=account,$scope.command.oaccid=account.accid,$scope.command.accal=account.accal,$(".dropdown").removeClass("open")},$scope.setSelectedDestinyAccount=function(account){$scope.command.ccDestinyAccount=account,$scope.command.daccid=account.accid,$scope.command.accal=account.accal,$(".dropdown").removeClass("open"),CCPaymentService.getAmountsOwnPaymentCC(account.accid).then(function(data){$scope.amounts=data})["catch"](function(data){$scope.errorMessage=data.msg,$("#modalErrorMessage").modal("show")})},$scope.onSiguiente01=function(){$scope.command.password=null,$("#confirmModal").modal()},$scope.onProcessTransfer=function(){CCPaymentService.doPaymentCC($scope.command,$scope.TYPE).then(function(data){$scope.confirmation=data,$state.go("bxi.payment.cc.amex.finish")})["catch"](function(data){$scope.errorMessage=data.msg,$("#modalErrorMessage").modal("show"),$scope.requestChallenge()})},$scope.requestChallenge=function(){SessionService.challenge().then(function(data){$scope.challenge=data})["catch"](function(data){$scope.errorMessage=data.msg,$("#modalErrorMessage").modal("show")})},$scope.load=function(){$("#modalBXINotificacionComprobante").modal("show"),$scope.requestChallenge(),AccountsService.getAccountsPaymentCC($scope.TYPE).then(function(data){$scope.ccOwnAccounts=data.ccAmexOwnAccounts,$scope.ccDestinyAccounts=data.ccAmexDestinyAccounts})["catch"](function(data){$scope.errorMessage=data.msg})},$scope.load()}),angular.module("SucursApps").config(function($stateProvider){$stateProvider.state("bxi.payment.service",{parent:"bxi.payment",url:"/service",data:{roles:["cliente"]},views:{"content@":{templateUrl:"scripts/app/bxi/payment/service/payment-service.html",controller:"BxiPaymentServiceController"}}}).state("bxi.payment.service.payee",{parent:"bxi.payment.service",url:"/payee",templateUrl:"scripts/app/bxi/payment/service/payment-service-payee.html"}).state("bxi.payment.service.detail",{parent:"bxi.payment.service",url:"/detail",templateUrl:"scripts/app/bxi/payment/service/payment-service-detail.html"}).state("bxi.payment.service.verify",{parent:"bxi.payment.service",url:"/verify",templateUrl:"scripts/app/bxi/payment/service/payment-service-verify.html"}).state("bxi.payment.service.finish",{parent:"bxi.payment.service",url:"/finish",templateUrl:"scripts/app/bxi/payment/service/payment-service-finish.html"})}),angular.module("SucursApps").controller("BxiPaymentServiceController",function($rootScope,$scope,$state,Principal,AccountsService,ServicesPaymentService,SessionService){function tuneDateReference(referenceList){for(var i=0;i<referenceList.length;i++){var name=referenceList[i].payenm;referenceList[i].payerq===!0&&name.indexOf("FECHA")>=0&&(referenceList[i].payeln=10,referenceList[i].payenm=referenceList[i].payenm+" (dd/mm/aaaa)")}return referenceList}function splitDate(customfields){if(void 0!==customfields.R1&&customfields.R1.indexOf("/")>=0){var date=customfields.R1;date.split("/").reverse(),customfields.R1=date}if(void 0!==customfields.R2&&customfields.R2.indexOf("/")>=0){var date=customfields.R2;date.split("/").reverse(),customfields.R2=date}if(void 0!==customfields.R3&&customfields.R3.indexOf("/")>=0){var date=customfields.R3;date.split("/").reverse(),customfields.R3=date}if(void 0!==customfields.R4&&customfields.R4.indexOf("/")>=0){var date=customfields.R4;date.split("/").reverse(),customfields.R4=date}if(void 0!==customfields.R5&&customfields.R5.indexOf("/")>=0){var date=customfields.R5;date.split("/").reverse(),customfields.R5=date}if(void 0!==customfields.R6&&customfields.R6.indexOf("/")>=0){var date=customfields.R6;date.split("/").reverse(),customfields.R6=date}return customfields}$scope.freq=[],$scope.main=[],$scope.command={},$scope.amount=0,$scope.main_list=[],$scope.setSelectedAccount=function(account){$scope.command.originAccount=account,$scope.command.oaccid=account.accid,$scope.command.accal=account.accal,$(".dropdown").removeClass("open")},$scope.onPayeeClick=function(payee,$event){var container=$($event.currentTarget).closest(".payee-list-favorites");container.find(".selected-sumando").removeClass("selected-sumando"),$($event.currentTarget).parent().addClass("selected-sumando"),$scope.command.payeeSelected=payee.payenm.concat(" - ").concat(payee.payeid)},$scope.onSiguiente01=function(){var payeeFound=$scope.main.filter(function(payee){return payee.payenm.concat(" - ").concat(payee.payeid)===$scope.command.payeeSelected});0===payeeFound.length&&($scope.errorMessage="No ha especificado un servicio correctamente",$("#modalErrorMessage").modal("show")),$scope.command.payee=payeeFound[0],ServicesPaymentService.getPayeDetail($scope.command.payee.payeid).then(function(data){$scope.payeeDetail=data;var referenceList=tuneDateReference($scope.payeeDetail.fact.payerl);$scope.command.requiredfields=referenceList,$scope.requestChallenge(),$state.go("bxi.payment.service.detail")})["catch"](function(data){$scope.errorMessage=data.msg,$("#modalErrorMessage").modal("show")})},$scope.onSiguiente02=function(){$scope.command.customfields=splitDate($scope.command.customfields),$scope.command.payeid=$scope.command.payee.payeid,ServicesPaymentService.getPayeDiscount($scope.command).then(function(data){$scope.discount=data;var log=[];angular.forEach(data.payerd,function(value,key){"Importe cargo"===value.vkey.toString()&&($scope.amount=value.vval)},log),$scope.requestChallenge(),$scope.command.password=null,$("#confirmModal").modal()})["catch"](function(data){$scope.errorMessage=data.msg,$("#modalErrorMessage").modal("show")})},$scope.onProcessPayment=function(code){ServicesPaymentService.payment(code).then(function(data){$scope.confirmation=data,$state.go("bxi.payment.service.finish")})["catch"](function(data){$scope.errorMessage=data.msg,$("#modalErrorMessage").modal("show"),$scope.requestChallenge()})},$scope.viewPayee=function(payee){$rootScope.currentPayee=payee,ServicesPaymentService.getPayeDetail($rootScope.currentPayee.payeid).then(function(data){$scope.payeeDetail=data;var referenceList=tuneDateReference($scope.payeeDetail.fact.payerl);$scope.command.requiredfields=referenceList,$state.go("bxi.payment.service.detail")})["catch"](function(data){$scope.errorMessage=data.msg,$("#modalErrorMessage").modal("show")})},$scope.requestChallenge=function(){SessionService.challenge().then(function(data){$scope.challenge=data})["catch"](function(data){$scope.errorMessage=data.msg,$("#modalErrorMessage").modal("show")})},$scope.load=function(){$("#modalBXINotificacionComprobante").modal("show"),ServicesPaymentService.getAccounts().then(function(data){$scope.accounts=data},function(data){$scope.errorMessage=data}),ServicesPaymentService.getPayees().then(function(data){$scope.freq=data.freq,$scope.main=data.main,angular.forEach($scope.main,function(value){this.push(value.payenm.concat(" - ").concat(value.payeid))},$scope.main_list)})["catch"](function(data){$scope.errorMessage=data.msg}),Principal.identity().then(function(account){$scope.account=account,$scope.isAuthenticated=Principal.isAuthenticated})},$scope.load()}),angular.module("SucursApps").config(function($stateProvider){$stateProvider.state("bxi.services",{parent:"bxi",url:"/services",views:{"content@":{templateUrl:"scripts/app/bxi/services/services.html",controller:"BxiServicesController"}}})}),angular.module("SucursApps").controller("BxiServicesController",function($scope,Principal){Principal.identity().then(function(account){$scope.account=account,$scope.isAuthenticated=Principal.isAuthenticated})}),angular.module("SucursApps").config(function($stateProvider){$stateProvider.state("bxi.services.checking",{parent:"bxi.services",url:"/checking",views:{"content@":{templateUrl:"scripts/app/bxi/services/checking/services-checking.html"}}})}),angular.module("SucursApps").controller("BxiServicesCheckingController",function($rootScope,$scope,$state,Principal,AccountsService){Principal.identity().then(function(account){
$scope.account=account,$scope.isAuthenticated=Principal.isAuthenticated})}),angular.module("SucursApps").config(function($stateProvider){$stateProvider.state("bxi.services.checking.activate",{parent:"bxi.services.checking",url:"/activate",views:{"content@":{templateUrl:"scripts/app/bxi/services/checking/activate/services-checking-activate.html",controller:"BxiServicesCheckingActivateController"}}}).state("bxi.services.checking.activate.accounts",{parent:"bxi.services.checking.activate",url:"/accounts",templateUrl:"scripts/app/bxi/services/checking/activate/services-checking-activate-accs.html"}).state("bxi.services.checking.activate.verify",{parent:"bxi.services.checking.activate",url:"/verify",templateUrl:"scripts/app/bxi/services/checking/activate/services-checking-activate-verify.html"}).state("bxi.services.checking.activate.finish",{parent:"bxi.services.checking.activate",url:"/finish",templateUrl:"scripts/app/bxi/services/checking/activate/services-checking-activate-finish.html"})}),angular.module("SucursApps").controller("BxiServicesCheckingActivateController",function($rootScope,$scope,$state,Principal,AccountsService,CheckingService){Principal.identity().then(function(account){$scope.account=account,$scope.isAuthenticated=Principal.isAuthenticated}),$scope.command={},$scope.processForm=function(){CheckingService.doActivation($scope.command).then(function(data){$scope.confirmation=data,$state.go(".finish")})["catch"](function(data){$scope.errorMessage=data.msg})},$scope.load=function(){CheckingService.getCheckingToActivate().then(function(data){$scope.ownAccounts=data.chkli,$scope.checkingRange=data.rangeChecks})["catch"](function(data){$scope.errorMessage=data.msg})},$scope.load()}),angular.module("SucursApps").config(function($stateProvider){$stateProvider.state("bxi.topup",{parent:"bxi",url:"/topup",data:{roles:["cliente"]},views:{"content@":{templateUrl:"scripts/app/bxi/topup/topup.html",controller:"TopUpController"},"navbar@":{templateUrl:"scripts/components/navbar/navbar-bxi-modal.html"}}}).state("bxi.topup.carrier",{parent:"bxi.topup",url:"/carrier",templateUrl:"scripts/app/bxi/topup/topup-carrier.html"}).state("bxi.topup.finish",{parent:"bxi.topup",url:"/finish",templateUrl:"scripts/app/bxi/topup/topup-finish.html"})}),angular.module("SucursApps").controller("TopUpController",function($rootScope,$scope,$state,Principal,AccountsService,ServicesPaymentService,SessionService,TopupService){$scope.freq=[],$scope.main=[],$scope.command={},$scope.amount=0,$scope.topupSelected={},$scope.setSelectedAccount=function(account){$scope.command.originAccount=account,$scope.command.oaccid=account.accid,$scope.command.accal=account.accal,$(".dropdown").removeClass("open")},$scope.onSiguiente01=function(){$scope.requestChallenge(),$scope.command.code=null,$("#confirmModal").modal()},$scope.onProcessTransfer=function(){TopupService.doTopup($scope.command).then(function(data){$scope.confirmation=data,$state.go("bxi.topup.finish")})["catch"](function(data){$scope.errorMessage=data.msg,$("#modalErrorMessage").modal("show"),$scope.requestChallenge()})},$scope.onCarrierClick=function(carrier,$event){var container=$($event.currentTarget).closest(".carrier-list");container.find(".selected-sumando").removeClass("selected-sumando"),$($event.currentTarget).parent().addClass("selected-sumando"),$scope.command.topupSelected=carrier,TopupService.getPhonesAndAmounts(carrier.vkey).then(function(data){$scope.amounts=data.amounts,$scope.phones=data.frequents})},$scope.onMontoClick=function(amount,$event){var container=$($event.currentTarget).closest(".amount-list");container.find(".btn-carrier").removeClass("carrier-amount-select").removeClass("carrier-amount-not-select"),container.find(".btn-carrier").addClass("carrier-amount-not-select"),$($event.currentTarget).removeClass("carrier-amount-not-select").addClass("carrier-amount-select"),$scope.command.amount=amount},$scope.onTelefonoClick=function(phone,$event){$(".carrier-list").find(".selected-sumando").removeClass("selected-sumando"),$(".carrier-list").find("[carrier-vkey='"+phone.carrierId+"']").addClass("selected-sumando"),$scope.command.topupSelected=$scope.findCarrierById(phone.carrierId);var container=$($event.currentTarget).closest(".phone-list");container.find(".carrier-amount-select").removeClass("carrier-amount-select"),$($event.currentTarget).addClass("carrier-amount-select"),$scope.command.phoneNumber=phone.number},$scope.findCarrierById=function(id){if(void 0!==id)for(var i=0;i<$scope.carriers.length;i++)if($scope.carriers[i].vkey===id)return $scope.carriers[i]},$scope.requestChallenge=function(){SessionService.challenge().then(function(data){$scope.challenge=data})["catch"](function(data){$scope.errorMessage=data.msg,$("#modalErrorMessage").modal("show")})},$scope.load=function(){$("#modalBXINotificacionComprobante").modal("show"),AccountsService.getOwnAccountsTopup().then(function(data){$scope.accounts=data},function(data){$scope.errorMessage=data}),TopupService.getCarriersTopup().then(function(data){$scope.carriers=data}),Principal.identity().then(function(account){$scope.account=account,$scope.isAuthenticated=Principal.isAuthenticated})},$scope.load()}),angular.module("SucursApps").factory("AuthServerProvider",function($http,localStorageService,$window,SERVICES_URL){return{loginUser:function(credentials){return $http.post(SERVICES_URL+"/jservice/uval.do",credentials,{headers:{"Content-Type":"application/json"}})},loginPasswordToken:function(credentials){return $http.post(SERVICES_URL+"/jservice/uaut.do",credentials,{headers:{"Content-Type":"application/json"}}).success(function(response){return response})},logout:function(){$http.post(SERVICES_URL+"/jservice/logout.do").success(function(response){return localStorageService.clearAll(),response})},getToken:function(){var token=localStorageService.get("token");return token},hasValidToken:function(){var token=this.getToken();return!!token}}}),angular.module("SucursApps").factory("BannerItemService",function($resource,SERVICES_URL){return $resource(SERVICES_URL+"/sucursapps/banner_items.do",{},{findAll:{method:"GET",isArray:!0}})}),angular.module("SucursApps").factory("MobileServicesProvider",function($http,SERVICES_URL){var _service=function(pMethod,pUrl,pData){return $http({method:pMethod,url:SERVICES_URL+"/jservice"+pUrl,data:pData,withCredentials:!0,showLoading:!0,currentContext:!0,headers:{"Content-Type":"application/json","Data-Type":"json"}})};return{get:function(pUrl){return _service("GET",pUrl,null)},post:function(pUrl,pData){return _service("POST",pUrl,pData)}}}),angular.module("SucursApps").factory("AccountsService",function(MobileServicesProvider,$q){return{getTotalsUpdated:function(accounts){var deferred=$q.defer();return MobileServicesProvider.get("/secure/updated.do",null).success(function(response){var checkingPesosTotal=parseFloat(response.checkingPesosTotal),checkingDollarsTotal=parseFloat(response.checkingDollarsTotal),creditPesosTotal=parseFloat(response.creditPesosTotal),creditDollarsTotal=parseFloat(response.creditDollarsTotal),codSocietyPesos=parseFloat(response.codSocietyPesos),codDollarsTotal=parseFloat(response.codDollarsTotal);response.type=[],void 0!==accounts.chpl||void 0!==accounts.chdl?response.type.push({name:"Cuentas de Deposito",shortName:"deposit",total:checkingPesosTotal+checkingDollarsTotal}):response.type.push({name:"Cuentas de Deposito",shortName:"deposit",total:"-.--"}),void 0!==accounts.crpl||void 0!==accounts.crdl?response.type.push({name:"Cuentas de Crédito",shortName:"credit",total:creditPesosTotal+creditDollarsTotal}):response.type.push({name:"Cuentas de Crédito",shortName:"credit",total:"-.--"}),void 0!==accounts.copl||void 0!==accounts.codl||void 0!==accounts.socl?response.type.push({name:"Cuentas de Inversión",shortName:"invest",total:codSocietyPesos+codDollarsTotal}):response.type.push({name:"Cuentas de Inversión",shortName:"invest",total:"-.--"}),deferred.resolve(response)})["catch"](function(err){deferred.reject(err)}),deferred.promise},getAllAccounts:function(){var deferred=$q.defer();return MobileServicesProvider.get("/secure/generals.do").success(function(resp){resp.sts&&"NOK"===resp.sts&&deferred.reject(resp),deferred.resolve(resp)})["catch"](function(err){deferred.reject(err)}.bind(this)),deferred.promise},getBalance:function(accid){var deferred=$q.defer();return MobileServicesProvider.get("/secure/"+accid+"/accbalance.do").success(function(resp){resp.sts&&"NOK"===resp.sts&&deferred.reject(resp),deferred.resolve(resp)})["catch"](function(err){deferred.reject(err)}.bind(this)),deferred.promise},getTransactions:function(accid,cicle,accountType){var deferred=$q.defer();return MobileServicesProvider.get("/secure/"+accid+":"+cicle+":"+accountType+"/acctransactions.do").success(function(resp){resp.sts&&"NOK"===resp.sts&&deferred.reject(resp),deferred.resolve(resp)})["catch"](function(err){deferred.reject(err)}.bind(this)),deferred.promise},getAccountsByType:function(type){var deferred=$q.defer();return"noplastic"===type?MobileServicesProvider.post("/secure/transfers/"+type+"/accounts.do").success(function(resp){resp.sts&&"NOK"===resp.sts&&deferred.reject(resp),deferred.resolve(resp)})["catch"](function(err){deferred.reject(err)}):MobileServicesProvider.get("/secure/transfers/"+type+"/accounts.do").success(function(resp){resp.sts&&"NOK"===resp.sts&&deferred.reject(resp),deferred.resolve(resp)})["catch"](function(err){deferred.reject(err)}),deferred.promise},getAccountsAndBanks:function(){var deferred=$q.defer();return MobileServicesProvider.post("/secure/transfers/quickpay/accountsandbanks.do",null).success(function(resp){resp.sts&&"NOK"===resp.sts&&deferred.reject(resp),deferred.resolve(resp)})["catch"](function(err){deferred.reject(err)}.bind(this)),deferred.promise},getOwnAccountsTopup:function(){var deferred=$q.defer();return MobileServicesProvider.get("/secure/topup/accounts/own.do").success(function(resp){resp.sts&&"NOK"===resp.sts&&deferred.reject(resp),deferred.resolve(resp)})["catch"](function(err){deferred.reject(err)}.bind(this)),deferred.promise},getAccountsPaymentCC:function(type){var deferred=$q.defer();return MobileServicesProvider.get("/secure/payments/cc/"+type+"/accounts.do").success(function(resp){resp.sts&&"NOK"===resp.sts&&deferred.reject(resp),deferred.resolve(resp)})["catch"](function(err){deferred.reject(err)}.bind(this)),deferred.promise},getAccountSummary:function(srvid){var deferred=$q.defer();return MobileServicesProvider.get("/secure/accounts.do?srvid="+srvid).success(function(resp){resp.sts&&"NOK"===resp.sts&&deferred.reject(resp),deferred.resolve(resp)})["catch"](function(err){deferred.reject(err)}.bind(this)),deferred.promise}}}),angular.module("SucursApps").factory("CCPaymentService",function(MobileServicesProvider,$q){return{getAmountsOwnPaymentCC:function(daid){var deferred=$q.defer();return MobileServicesProvider.get("/secure/payments/cc/own/"+daid+"/amounts.do").success(function(resp){resp.sts&&"NOK"===resp.sts&&deferred.reject(resp),deferred.resolve(resp)})["catch"](function(err){deferred.reject(err)}),deferred.promise},doPaymentCC:function(payment,type){var data=null;data="own"===type?{oaid:payment.ccOriginAccount.accid,daid:payment.ccDestinyAccount.accid,amt:payment.amount.toString(),crnu:payment.ccDestinyAccount.acccn,oanu:payment.ccOriginAccount.accnm}:{oaid:payment.ccOriginAccount.accid,daid:payment.ccDestinyAccount.accid,amt:payment.amount.toString(),cde:payment.code};var deferred=$q.defer();return MobileServicesProvider.post("/secure/payments/cc/"+type+"/payment.do",data).success(function(resp){resp.sts&&"NOK"===resp.sts&&deferred.reject(resp),deferred.resolve(resp)})["catch"](function(err){deferred.reject(err)}.bind(this)),deferred.promise}}}),angular.module("SucursApps").factory("CheckingService",function(MobileServicesProvider,$q){return{getCheckingToActivate:function(){var deferred=$q.defer();return MobileServicesProvider.get("/secure/services/ch/activation.do").then(function(resp){resp.data.sts&&"NOK"===resp.data.sts&&deferred.reject(resp.data),deferred.resolve(resp)})["catch"](function(err){deferred.reject(err)}.bind(this)),deferred.promise},getLost:function(){var deferred=$q.defer();return MobileServicesProvider.get("/secure/services/ch/lost.do").then(function(resp){resp.data.sts&&"NOK"===resp.data.sts&&deferred.reject(resp.data),deferred.resolve(resp)})["catch"](function(err){deferred.reject(err)}.bind(this)),deferred.promise},getRequest:function(){var deferred=$q.defer();return MobileServicesProvider.get("/secure/services/ch/request.do").then(function(resp){resp.data.sts&&"NOK"===resp.data.sts&&deferred.reject(resp.data),deferred.resolve(resp)})["catch"](function(err){deferred.reject(err)}.bind(this)),deferred.promise},getActivationDetail:function(id){var data={accnm:id},deferred=$q.defer();return MobileServicesProvider.post("/secure/services/ch/activationdetail.do",data).then(function(resp){resp.data.sts&&"NOK"===resp.data.sts&&deferred.reject(data),deferred.resolve(resp)})["catch"](function(err){deferred.reject(err)}.bind(this)),deferred.promise},doActivation:function(checking){var deferred=$q.defer(),data={accnm:checking.originAccount.accnm,range:checking.checkingRange};return MobileServicesProvider.post("/secure/services/ch/activation.do",data).then(function(resp){resp.data.sts&&"NOK"===resp.data.sts&&deferred.reject(data),deferred.resolve(resp)})["catch"](function(err){deferred.reject(err)}.bind(this)),deferred.promise},doLost:function(checking){var data={accnm:checking.originAccount.accnm,inick:checking.inick.toString(),finck:checking.finck.toString()};return Util.jService("POST","/secure/services/ch/lost.do",data)},doRequest:function(ch){var deferred=$q.defer(),data={accnm:ch.number};return MobileServicesProvider.post("/secure/services/ch/request.do",data).then(function(resp){resp.data.sts&&"NOK"===resp.data.sts&&deferred.reject(data),deferred.resolve(resp)})["catch"](function(err){deferred.reject(err)}.bind(this)),deferred.promise}}}),angular.module("SucursApps").factory("CreditCardService",function(MobileServicesProvider,$q){return{getCCToActivate:function(){var deferred=$q.defer();return MobileServicesProvider.get("/secure/services/cc/activation.do").then(function(resp){resp.data.sts&&"NOK"===resp.data.sts&&deferred.reject(resp.data),deferred.resolve(resp)})["catch"](function(err){deferred.reject(err)}.bind(this)),deferred.promise},getLimit:function(){var deferred=$q.defer();return MobileServicesProvider.get("/secure/services/cc/changelimit.do").then(function(resp){resp.data.sts&&"NOK"===resp.data.sts&&deferred.reject(resp.data),deferred.resolve(resp)})["catch"](function(err){deferred.reject(err)}.bind(this)),deferred.promise},getStatus:function(){var deferred=$q.defer();return MobileServicesProvider.get("/secure/services/cc/changestatus.do").then(function(resp){resp.data.sts&&"NOK"===resp.data.sts&&deferred.reject(resp.data),deferred.resolve(resp)})["catch"](function(err){deferred.reject(err)}.bind(this)),deferred.promise},getDCToBlock:function(){var deferred=$q.defer();return MobileServicesProvider.get("/secure/services/cc/reddcblock.do").then(function(resp){resp.data.sts&&"NOK"===resp.data.sts&&deferred.reject(resp.data),deferred.resolve(resp)})["catch"](function(err){deferred.reject(err)}.bind(this)),deferred.promise},doActivation:function(cc){var deferred=$q.defer(),data={acccn:cc.acccn,accsts:cc.accsts};return MobileServicesProvider.post("/secure/services/cc/activation.do",data).then(function(resp){resp.data.sts&&"NOK"===resp.data.sts&&deferred.reject(resp.data),deferred.resolve(resp)})["catch"](function(err){deferred.reject(err)}.bind(this)),deferred.promise},getLimitDetail:function(cc){var deferred=$q.defer(),data={acccn:cc};return MobileServicesProvider.post("/secure/services/cc/changelimitdetail.do",data).then(function(resp){resp.data.sts&&"NOK"===resp.data.sts&&deferred.reject(data),deferred.resolve(resp)})["catch"](function(err){deferred.reject(err)}.bind(this)),deferred.promise},doChangeLimit:function(cc){var deferred=$q.defer(),data={accccl:cc.accccl.toString(),accdcl:cc.accdcl.toString(),accatm:cc.accatm,acctm:cc.acctm,accexp:cc.accexp};return MobileServicesProvider.post("/secure/services/cc/changelimit.do",data).then(function(resp){resp.data.sts&&"NOK"===resp.data.sts&&deferred.reject(data),deferred.resolve(resp)})["catch"](function(err){deferred.reject(err)}.bind(this)),deferred.promise},doChangeStatus:function(cc){var deferred=$q.defer(),data={acccn:cc.acccn,accal:cc.accal,accbxl:cc.accbxl};return MobileServicesProvider.post("/secure/services/cc/changestatus.do",data).then(function(resp){resp.data.sts&&"NOK"===resp.data.sts&&deferred.reject(data),deferred.resolve(resp)})["catch"](function(err){deferred.reject(err)}.bind(this)),deferred.promise},doBlock:function(cc){var deferred=$q.defer(),data={accnm:cc.accnm,acccn:cc.acccn};return MobileServicesProvider.post("/secure/services/cc/reddcblock.do",data).then(function(resp){resp.data.sts&&"NOK"===resp.data.sts&&deferred.reject(resp.data),deferred.resolve(resp)})["catch"](function(err){deferred.reject(err)}.bind(this)),deferred.promise}}}),angular.module("SucursApps").factory("ServicesPaymentService",function(MobileServicesProvider,$q){return{getPayees:function(){var deferred=$q.defer();return MobileServicesProvider.get("/secure/payment/list.do").success(function(resp){resp.sts&&"NOK"===resp.sts&&deferred.reject(resp),deferred.resolve(resp)})["catch"](function(err){deferred.reject(err)}.bind(this)),deferred.promise},getAccounts:function(){var deferred=$q.defer();return MobileServicesProvider.get("/secure/payment/accounts.do").success(function(resp){resp.sts&&"NOK"===resp.sts&&deferred.reject(resp),deferred.resolve(resp)})["catch"](function(err){deferred.reject(err)}.bind(this)),deferred.promise},getPayeDetail:function(payeid){var data={payeid:payeid},deferred=$q.defer();return MobileServicesProvider.post("/secure/payment/servicedetail.do",data).success(function(resp){resp.sts&&"NOK"===resp.sts&&deferred.reject(resp),deferred.resolve(resp)})["catch"](function(err){deferred.reject(err)}.bind(this)),deferred.promise},getPayeDiscount:function(payee){var data={oaccid:payee.originAccount.accid};"94895"===payee.payeid?(data.ref1=payee.customfields.R1,data.ref2=payee.customfields.R2):"88924"===payee.payeid?data.ref1=payee.customfields.R1:(void 0!==payee.customfields.R1&&(data.R1=payee.customfields.R1),void 0!==payee.customfields.R2&&(data.R2=payee.customfields.R2),void 0!==payee.customfields.R3&&(data.R3=payee.customfields.R3),void 0!==payee.customfields.R4&&(data.R4=payee.customfields.R4),void 0!==payee.customfields.R5&&(data.R5=payee.customfields.R5),void 0!==payee.customfields.R6&&(data.R6=payee.customfields.R6));var deferred=$q.defer();return MobileServicesProvider.post("/secure/payment/servicediscount.do",data).success(function(resp){resp.sts&&"NOK"===resp.sts&&deferred.reject(resp),deferred.resolve(resp)})["catch"](function(err){deferred.reject(err)}.bind(this)),deferred.promise},payment:function(code){var data={cde:code},deferred=$q.defer();return MobileServicesProvider.post("/secure/payment/service.do",data).success(function(resp){resp.sts&&"NOK"===resp.sts&&deferred.reject(resp),deferred.resolve(resp)})["catch"](function(err){deferred.reject(err)}.bind(this)),deferred.promise}}}),angular.module("SucursApps").factory("SessionService",function(MobileServicesProvider,$q){return{uval:function(user){var deferred=$q.defer(),credentials={usr:user.usr,hid:"0asd0123"};return MobileServicesProvider.post("/uval.do",credentials).success(function(resp){resp.sts&&"NOK"===resp.sts&&deferred.reject(resp),deferred.resolve(resp)})["catch"](function(err){deferred.reject(err)}),deferred.promise},uaut:function(user){var deferred=$q.defer(),credentials={pss:user.pss,utk:void 0===user.utk?"":user.utk.toString()};return MobileServicesProvider.post("/uaut.do",credentials).success(function(resp){resp.sts&&"NOK"===resp.sts&&deferred.reject(resp),deferred.resolve(resp)})["catch"](function(err){deferred.reject(err)}),deferred.promise},tval:function(user){var deferred=$q.defer(),credentials={pss:user.pss,cn:user.cn};return MobileServicesProvider.post("/tval.do",credentials).success(function(resp){resp.sts&&"NOK"===resp.sts&&deferred.reject(resp),deferred.resolve(resp)})["catch"](function(err){deferred.reject(err)}),deferred.promise},challenge:function(){var deferred=$q.defer();return MobileServicesProvider.get("/secure/challenge.do").success(function(resp){resp.sts&&"NOK"===resp.sts&&deferred.reject(resp),deferred.resolve(resp)})["catch"](function(err){deferred.reject(err)}.bind(this)),deferred.promise},logout:function(){var deferred=$q.defer();return MobileServicesProvider.post("/logout.do",null).success(function(resp){resp.sts&&"NOK"===resp.sts&&deferred.reject(resp),deferred.resolve(resp)})["catch"](function(err){deferred.reject(err)}.bind(this)),deferred.promise},sticker:function(){var deferred=$q.defer();return MobileServicesProvider.get("/fsticker.do").success(function(resp){resp.sts&&"NOK"===resp.sts&&deferred.reject(resp),deferred.resolve(resp)})["catch"](function(err){deferred.reject(err)}.bind(this)),deferred.promise}}}),angular.module("SucursApps").factory("TopupService",function(MobileServicesProvider,$q){return{getCarriersTopup:function(){var deferred=$q.defer();return MobileServicesProvider.get("/secure/topup/carriers.do").success(function(resp){resp.sts&&"NOK"===resp.sts&&deferred.reject(resp),deferred.resolve(resp)})["catch"](function(err){deferred.reject(err)}.bind(this)),deferred.promise},getAmountsByCarrierTopup:function(carrierId){var deferred=$q.defer();return MobileServicesProvider.get("/topup/"+carrierId+"/amounts.do").success(function(resp){resp.sts&&"NOK"===resp.sts&&deferred.reject(resp),deferred.resolve(resp)})["catch"](function(err){deferred.reject(err)}.bind(this)),deferred.promise},getPhonesAndAmounts:function(carrierId){var deferred=$q.defer();return MobileServicesProvider.get("/secure/topup/"+carrierId+"/phonesandamounts.do").success(function(resp){resp.sts&&"NOK"===resp.sts&&deferred.reject(resp),deferred.resolve(resp)})["catch"](function(err){deferred.reject(err)}.bind(this)),deferred.promise},doTopup:function(topup){var data={cde:topup.code,oacc:topup.originAccount.accid,phnr:topup.phoneNumber,crid:topup.topupSelected.vkey.toString(),amt:topup.amount},deferred=$q.defer();return MobileServicesProvider.post("/secure/topup/topup.do",data).success(function(resp){resp.sts&&"NOK"===resp.sts&&deferred.reject(resp),deferred.resolve(resp)})["catch"](function(err){deferred.reject(err)}.bind(this)),deferred.promise}}}),angular.module("SucursApps").factory("TransfersService",function(MobileServicesProvider,$q){return{doTransfer:function(transfer,type){var data={};"quickpay"===type?data={idbk:transfer.destBank.id,oacc:transfer.oaccid,daci:transfer.destAccountId,amt:transfer.amount.toString(),cde:transfer.password}:(data={oacc:parseInt(transfer.oaccid),dacc:parseInt(transfer.daccid),amo:transfer.amount.toString(),des:transfer.description.toString()},"thirdparty"===type?data.cde=transfer.password:("spei"===type||"tef"===type)&&(data.cde=transfer.password,data.rfe=transfer.reference.toString()));var deferred=$q.defer();return MobileServicesProvider.post("/secure/transfers/"+type+"/transfer.do",data).success(function(resp){resp.sts&&"NOK"===resp.sts&&deferred.reject(resp),deferred.resolve(resp)})["catch"](function(err){deferred.reject(err)}.bind(this)),deferred.promise},getSpeiList:function(){var deferred=$q.defer();return MobileServicesProvider.get("/secure/transfers/spei/list.do").success(function(resp){resp.sts&&"NOK"===resp.sts&&deferred.reject(resp),deferred.resolve(resp)})["catch"](function(err){deferred.reject(err)}.bind(this)),deferred.promise},getSpeiDetail:function(transferCode){var deferred=$q.defer();return MobileServicesProvider.get("/secure/transfers/spei/"+transferCode+"/detail.do",null).success(function(resp){resp.sts&&"NOK"===resp.sts&&deferred.reject(resp),deferred.resolve(resp)})["catch"](function(err){deferred.reject(err)}.bind(this)),deferred.promise},getTefList:function(){var deferred=$q.defer();return MobileServicesProvider.get("/secure/transfers/tef/list.do").success(function(resp){resp.sts&&"NOK"===resp.sts&&deferred.reject(resp),deferred.resolve(resp)})["catch"](function(err){deferred.reject(err)}.bind(this)),deferred.promise},cancelTef:function(transfer){var data={clv:transfer.idtrf,cde:transfer.cde},deferred=$q.defer();return MobileServicesProvider.post("/secure/transfers/tef/cancel.do",data).success(function(resp){resp.sts&&"NOK"===resp.sts&&deferred.reject(resp),deferred.resolve(resp)})["catch"](function(err){deferred.reject(err)}.bind(this)),deferred.promise},searchNoPlasticTransfer:function(transfer){var data={acnu:transfer.originAccount.acnu,crnm:transfer.originAccount.crnu},deferred=$q.defer();return MobileServicesProvider.post("/secure/transfers/noplastic/search.do",data).success(function(resp){resp.sts&&"NOK"===resp.sts&&deferred.reject(resp),deferred.resolve(resp)})["catch"](function(err){deferred.reject(err)}.bind(this)),deferred.promise},referenceNoPlasticTransfer:function(transfer){var data={acnu:transfer.originAccount.acnu,amo:transfer.amount.toString(),des:transfer.description.toString(),crnm:transfer.originAccount.crnu,cde:transfer.cde},deferred=$q.defer();return MobileServicesProvider.post("/secure/transfers/noplastic/reference.do",data).success(function(resp){resp.sts&&"NOK"===resp.sts&&deferred.reject(resp),deferred.resolve(resp)})["catch"](function(err){deferred.reject(err)}.bind(this)),deferred.promise}}}),angular.module("SucursApps").factory("SpeiMovilService",function(MobileServicesProvider,$q){return{getAccounts:function(){var deferred=$q.defer();return MobileServicesProvider.get("/secure/transfers/speimovil/accounts.do",null).success(function(resp){resp.sts&&"NOK"===resp.sts&&deferred.reject(resp),deferred.resolve(resp)})["catch"](function(err){deferred.reject(err)}.bind(this)),deferred.promise},getRelations:function(){var deferred=$q.defer();return MobileServicesProvider.get("/secure/transfers/speimovil/relations.do",null).success(function(resp){resp.sts&&"NOK"===resp.sts&&deferred.reject(resp),deferred.resolve(resp)})["catch"](function(err){deferred.reject(err)}.bind(this)),deferred.promise},addRelation:function(command){var deferred=$q.defer(),data={accnm:command.account.acnu,pho:command.newphone};return MobileServicesProvider.post("/secure/transfers/speimovil/create.do",data).success(function(resp){resp.sts&&"NOK"===resp.sts&&deferred.reject(resp),deferred.resolve(resp)})["catch"](function(err){deferred.reject(err)}.bind(this)),deferred.promise},updateRelation:function(command){var deferred=$q.defer(),data={accnm:command.account.acnu,pho:command.newphone};return MobileServicesProvider.post("/secure/transfers/speimovil/update.do",data).success(function(resp){resp.sts&&"NOK"===resp.sts&&deferred.reject(resp),deferred.resolve(resp)})["catch"](function(err){deferred.reject(err)}.bind(this)),deferred.promise},removeRelation:function(command){var deferred=$q.defer(),data={accnm:command.account.acnu,pho:command.phone};return MobileServicesProvider.post("/secure/transfers/speimovil/remove.do",data).success(function(resp){resp.sts&&"NOK"===resp.sts&&deferred.reject(resp),deferred.resolve(resp)})["catch"](function(err){deferred.reject(err)}.bind(this)),deferred.promise},frequentPhones:function(){var deferred=$q.defer();return MobileServicesProvider.get("/secure/transfers/speimovil/frequents.do",null).success(function(resp){resp.sts&&"NOK"===resp.sts&&deferred.reject(resp),deferred.resolve(resp)})["catch"](function(err){deferred.reject(err)}.bind(this)),deferred.promise},getRelation:function(account,phone){var deferred=$q.defer();return MobileServicesProvider.get("/secure/transfers/speimovil/"+account+"/"+phone+"/relation.do",null).success(function(resp){resp.sts&&"NOK"===resp.sts&&deferred.reject(resp),deferred.resolve(resp)})["catch"](function(err){deferred.reject(err)}.bind(this)),deferred.promise}}}),angular.module("SucursApps").factory("McaServicesProvider",function($http,SERVICES_URL){var _service=function(pMethod,pUrl,pData,pHeader){var headers={"Content-Type":"application/json","Data-Type":"json"};return(void 0!=pHeader||null!=pHeader)&&(headers=getHeaderProperties(headers,pHeader)),$http({method:pMethod,url:SERVICES_URL+"/jservice/mca/"+pUrl,data:pData,withCredentials:!0,currentContext:!0,headers:headers})},_service_abs=function(pMethod,pUrl,pData,pHeader){var headers={"Content-Type":"application/json","Data-Type":"json"};return(void 0!=pHeader||null!=pHeader)&&(headers=getHeaderProperties(headers,pHeader)),$http({method:pMethod,url:pUrl,data:pData,withCredentials:!0,headers:headers})},getHeaderProperties=function(pHeader,pProps){for(var prop in pProps)pHeader[prop]=pProps[prop];return pHeader};return{get:function(pUrl,pHeader){return _service("GET",pUrl,null,pHeader)},post:function(pUrl,pData,pHeader){return _service("POST",pUrl,pData,pHeader)},getAbs:function(pUrl,pHeader){return _service_abs("GET",pUrl,null,pHeader)}}}),angular.module("SucursApps").factory("McaSessionService",function(McaServicesProvider,$q){return{tval:function(data){var deferred=$q.defer();return McaServicesProvider.post("login.do",data).success(function(resp){deferred.resolve(resp)})["catch"](function(err){deferred.reject(err.data)}),deferred.promise}}}),angular.module("SucursApps").factory("McaDetalleCuentaService",function(McaServicesProvider,$q){return{getAccountDetail:function(period){var deferred=$q.defer();return McaServicesProvider.get("account/detail.do?period="+period,null).success(function(response){deferred.resolve(response)})["catch"](function(err){deferred.reject(err.data)}),deferred.promise},imprimeEstadosCuenta:function(periodos){var deferred=$q.defer();return McaServicesProvider.get("account/resume/month.do?months="+periodos,null).success(function(response){deferred.resolve(response)})["catch"](function(err){deferred.reject(err.data)}),deferred.promise},getAccount:function(){var deferred=$q.defer();return McaServicesProvider.get("account.do",null).success(function(response){deferred.resolve(response)})["catch"](function(err){deferred.reject(err.data)}),deferred.promise}}}),angular.module("SucursApps").factory("McaTopupService",function(McaServicesProvider,$q){return{getEmpresas:function(){var deferred=$q.defer();return McaServicesProvider.get("ta/carrier.do").success(function(resp){deferred.resolve(resp)})["catch"](function(err){deferred.reject(err.data)}.bind(this)),deferred.promise},getImportesByEmpresa:function(empresaId){var deferred=$q.defer();return McaServicesProvider.get("ta/carrier/"+empresaId+"/amount.do").success(function(resp){deferred.resolve(resp)})["catch"](function(err){deferred.reject(err.data)}.bind(this)),deferred.promise},doCompraTA:function(command){var data={cTel:command.topupSelected.idCatEmpresa,noTel:command.phoneNumber,imp:command.amount.importeTiempoAire.toFixed(2),ml:command.email},deferred=$q.defer();return McaServicesProvider.post("ta/buy.do",data).success(function(resp){"0"===resp.id&&deferred.reject(resp),deferred.resolve(resp)})["catch"](function(err){deferred.reject(err.data)}.bind(this)),deferred.promise}}}),angular.module("SucursApps").factory("McaTransferService",function(McaServicesProvider,$q){return{doTransferThird:function(command){var data={numCA:command.accountNumber,imp:command.amount,ml:command.email},deferred=$q.defer();return McaServicesProvider.post("transfer/third.do",data).success(function(resp){"0"===resp.id&&deferred.reject(resp),deferred.resolve(resp)})["catch"](function(err){deferred.reject(err.data)}.bind(this)),deferred.promise},doTransferSPEI:function(command){var data={imSp:command.amount,desOp:command.description,bnR:command.bank.id,cCRec:command.clabe,nmBen:command.beneficiario,refNum:command.reference,ml:command.email},deferred=$q.defer();return McaServicesProvider.post("transfer/spei.do",data).success(function(resp){"0"===resp.id&&deferred.reject(resp),
deferred.resolve(resp)})["catch"](function(err){deferred.reject(err.data)}.bind(this)),deferred.promise},getBancos:function(){var deferred=$q.defer();return McaServicesProvider.get("bank.do").success(function(resp){deferred.resolve(resp)})["catch"](function(err){deferred.reject(err.data)}.bind(this)),deferred.promise}}}),angular.module("SucursApps").factory("McaPaymentService",function(McaServicesProvider,$q){return{doPaymentCC:function(command){var data={fid:command.facturadorId,ncc:command.reference,imp:command.amount,ml:command.email},deferred=$q.defer();return McaServicesProvider.post("payment/cc.do",data).success(function(resp){"0"===resp.id&&deferred.reject(resp),deferred.resolve(resp)})["catch"](function(err){deferred.reject(err.data)}.bind(this)),deferred.promise},getPayees:function(name){var deferred=$q.defer();return McaServicesProvider.get("payment/payee.do?q="+name).success(function(resp){deferred.resolve(resp)})["catch"](function(err){deferred.reject(err.data)}.bind(this)),deferred.promise},getPayeesKiosk:function(name){var deferred=$q.defer();return McaServicesProvider.get("payment/payee_kiosk.do?q="+name).success(function(resp){deferred.resolve(resp)})["catch"](function(err){deferred.reject(err.data)}.bind(this)),deferred.promise},getPayeesTest:function(){var deferred=$q.defer();return McaServicesProvider.getAbs("facturadores.json").success(function(resp){deferred.resolve(resp)})["catch"](function(err){deferred.reject(err.data)}.bind(this)),deferred.promise},getPayeesFavoritos:function(){var deferred=$q.defer();return McaServicesProvider.getAbs("facturadoresfav.json").success(function(resp){deferred.resolve(resp)})["catch"](function(err){deferred.reject(err.data)}.bind(this)),deferred.promise},getPayeeDetail:function(id){var deferred=$q.defer();return McaServicesProvider.get("payment/payee/"+id+".do").success(function(resp){deferred.resolve(resp)})["catch"](function(err){deferred.reject(err.data)}.bind(this)),deferred.promise},getPayeeDetailKiosk:function(id){var deferred=$q.defer();return McaServicesProvider.get("payment/payee/"+id+"_kiosk.do").success(function(resp){deferred.resolve(resp)})["catch"](function(err){deferred.reject(err.data)}.bind(this)),deferred.promise},getPayeeDetailRC03:function(id){var deferred=$q.defer();return McaServicesProvider.get("payment/payee/rc03/"+id+".do").success(function(resp){deferred.resolve(resp)})["catch"](function(err){deferred.reject(err.data)}.bind(this)),deferred.promise},getPayeeDetailRC03Kiosk:function(id){var deferred=$q.defer();return McaServicesProvider.get("payment/payee/rc03/"+id+"_kiosk.do").success(function(resp){deferred.resolve(resp)})["catch"](function(err){deferred.reject(err.data)}.bind(this)),deferred.promise},validate:function(command){var data={ref01:command.ref01,ref02:command.ref02,ref03:command.ref03,ref04:command.ref04,dd:command.dueDate,imp:command.amount,ml:command.email},deferred=$q.defer();return McaServicesProvider.post("payment/payee/"+command.payee.idFacturador+"/validate.do",data).success(function(resp){"0"===resp.id&&deferred.reject(resp),deferred.resolve(resp)})["catch"](function(err){deferred.reject(err.data)}.bind(this)),deferred.promise},validateRC03:function(command){var data={ref01:command.ref01,ref02:command.ref02,ref03:command.ref03,ref04:command.ref04,ref05:command.ref05,imp:command.amount,ml:command.email,dd:command.dueDate},deferred=$q.defer();return McaServicesProvider.post("payment/payee/rc03/"+command.payee.idFacturador+"/validate.do",data).success(function(resp){"0"===resp.id&&deferred.reject(resp),deferred.resolve(resp)})["catch"](function(err){deferred.reject(err.data)}.bind(this)),deferred.promise},payment:function(command){var data={ref01:command.ref01,ref02:command.ref02,ref03:command.ref03,ref04:command.ref04,ref05:command.ref05,imp:command.amount,ml:command.email,dd:command.dueDate},deferred=$q.defer();return McaServicesProvider.post("payment/payee/"+command.payee.idFacturador+"/pay.do",data).success(function(resp){"0"===resp.id&&deferred.reject(resp),deferred.resolve(resp)})["catch"](function(err){deferred.reject(err.data)}.bind(this)),deferred.promise},paymentRC03:function(command){var data={ref01:command.ref01,ref02:command.ref02,ref03:command.ref03,ref04:command.ref04,ref05:command.ref05,imp:command.amount,ml:command.email,dd:command.dueDate},deferred=$q.defer();return McaServicesProvider.post("payment/payee/rc03/"+command.payee.idFacturador+"/pay.do",data).success(function(resp){"0"===resp.id&&deferred.reject(resp),deferred.resolve(resp)})["catch"](function(err){deferred.reject(err.data)}.bind(this)),deferred.promise}}}),angular.module("SucursApps").factory("McaEstadoCuentaService",function(McaServicesProvider,$q){return{obtenerListaDocumentos:function(){var data={idC:"010",fecS:[{feI:moment().subtract(12,"month").startOf("month"),feF:moment().endOf("month")}]},deferred=$q.defer();return McaServicesProvider.post("edocto/obtenerLsDoc.do",data).success(function(resp){"0"===resp.id&&deferred.reject(resp),deferred.resolve(resp)})["catch"](function(err){deferred.reject(err.data)}.bind(this)),deferred.promise},obtenerDocumentos:function(itemList){var data={idC:"010",feCDocs:itemList},deferred=$q.defer();return McaServicesProvider.post("edocto/obtenerDoc.do",data).success(function(resp){"0"===resp.id&&deferred.reject(resp),deferred.resolve(resp)})["catch"](function(err){deferred.reject(err.data)}.bind(this)),deferred.promise},enviaDocumentos:function(itemList,command){var data={idC:"010",feCDocs:itemList,ml:command.email,pcs:command.pcs},deferred=$q.defer();return McaServicesProvider.post("edocto/envioEdosDocs.do",data).success(function(resp){"0"===resp.id&&deferred.reject(resp),deferred.resolve(resp)})["catch"](function(err){deferred.reject(err.data)}.bind(this)),deferred.promise},activarEnvioEmail:function(command){var data={cc:command.numeroCuenta,ml:command.email},deferred=$q.defer();return McaServicesProvider.post("edocto/email/activar.do",data).success(function(resp){"0"===resp.id&&deferred.reject(resp),deferred.resolve(resp)})["catch"](function(err){deferred.reject(err.data)}.bind(this)),deferred.promise},consultaEnvioEmail:function(){var deferred=$q.defer();return McaServicesProvider.post("edocto/email/consulta.do",{}).success(function(resp){"0"===resp.id&&deferred.reject(resp),deferred.resolve(resp)})["catch"](function(err){deferred.reject(err.data)}.bind(this)),deferred.promise},actualizarEnvioEmail:function(command){var data={cc:command.numeroCuenta,ml:command.email},deferred=$q.defer();return McaServicesProvider.post("edocto/email/actualizar.do",data).success(function(resp){"0"===resp.id&&deferred.reject(resp),deferred.resolve(resp)})["catch"](function(err){deferred.reject(err.data)}.bind(this)),deferred.promise},consultaEnvio:function(){var deferred=$q.defer();return McaServicesProvider.get("edocto/envio/consulta.do").success(function(resp){"0"===resp.id&&deferred.reject(resp),deferred.resolve(resp)})["catch"](function(err){deferred.reject(err.data)}.bind(this)),deferred.promise}}}),angular.module("SucursApps").factory("McaCuentaService",function(McaServicesProvider,$q,Utils){return{listAccountBeneficiaries:function(){var deferred=$q.defer();return McaServicesProvider.get("account/beneficiary/list.do").success(function(resp){"0"===resp.id&&deferred.reject(resp),deferred.resolve(resp)})["catch"](function(err){deferred.reject(err.data)}.bind(this)),deferred.promise},addBeneficiary:function(item){var data={rf:item.registroFederal,fm:item.fisicaMoral,fn:item.fechaNacimiento,nb:item.nombreBeneficia,apb:item.apPaternoBenef,amb:item.apMaternoBenef,rs:item.razonSocial,pb:item.porcentajeBenef,tv:item.tipoVivienda,nomca:item.nombreCalle,numca:item.numeroCalle,nument:item.numeroEntrada,numpi:item.numeroPiso,numdep:item.numeroDepartamen,descol:item.descripcionColonia,cp:item.codigoPostal,cd:item.municipio_seleccionado.id,dd:item.municipio_seleccionado.nombre,ce:item.estado_seleccionado.id,dp:item.pais,par:item.parentesco},deferred=$q.defer();return McaServicesProvider.post("account/beneficiary/add.do",data).success(function(resp){"0"===resp.id&&deferred.reject(resp),deferred.resolve(resp)})["catch"](function(err){deferred.reject(err.data)}.bind(this)),deferred.promise},updateBeneficiary:function(item){var deferred=$q.defer(),data={nomcli:item.nombreCliente,numcli:item.numeroCliente,numcons:item.numeroConsecutiv,rf:item.registroFederal.trim(),fm:item.fisicaMoral.trim(),fn:item.fechaNacimiento.trim(),nb:item.nombreBeneficia.trim(),apb:item.apPaternoBenef.trim(),amb:item.apMaternoBenef.trim(),rs:item.razonSocial.trim(),pb:item.porcentajeBenef,tv:item.tipoVivienda.trim(),nomca:item.nombreCalle.trim(),numca:item.numeroCalle.trim(),nument:item.numeroEntrada.trim(),numpi:item.numeroPiso.trim(),numdep:item.numeroDepartamen.trim(),descol:item.descripcionColonia.trim(),cp:item.codigoPostal,cd:item.municipio_seleccionado.id,dd:item.municipio_seleccionado.nombre,ce:item.estado_seleccionado.id,dp:item.pais.trim(),par:item.parentesco.trim()};return McaServicesProvider.post("account/beneficiary/update.do",data).success(function(resp){"0"===resp.id&&deferred.reject(resp),deferred.resolve(resp)})["catch"](function(err){deferred.reject(err.data)}.bind(this)),deferred.promise},updateDomAlt:function(item,account){var deferred=$q.defer(),data={numdom:Utils.safeTrim(item.numeroDomicilio),tipdom:Utils.safeTrim(item.tipoDomicilio),idvia:Utils.safeTrim(item.codigoVia),nomcall:Utils.safeTrim(item.descripcionCalle),numcall:Utils.safeTrim(item.numeroCalle),tipviv:Utils.safeTrim(item.tipoVivienda),ent:Utils.safeTrim(item.tipoEntrada)||0,pis:Utils.safeTrim(item.numeroPiso)||0,depto:Utils.safeTrim(item.numDepartamento)||0,col:Utils.safeTrim(item.descColonia),cp:Utils.safeTrim(item.codigoPostal),codmun:Utils.safeTrim(item.delegacionmunicipio),codest:Utils.safeTrim(item.codigoEstado),cpais:Utils.safeTrim(item.codigoPais),ttuno:Utils.safeTrim(item.tipoTelefonoUno)||"C",ntuno:Utils.safeTrim(item.numeroTelefonoUno)||0,ttdos:Utils.safeTrim(item.tipoTelefonoDos)||"C",ntdos:Utils.safeTrim(item.numeroTelefonoDos)||0,tttres:Utils.safeTrim(item.tipoTelefonoTres)||"C",nttres:Utils.safeTrim(item.numeroTelefonoTres)||0};return McaServicesProvider.post("account/address/update.do",data).success(function(resp){"0"===resp.id&&deferred.reject(resp),deferred.resolve(resp)})["catch"](function(err){deferred.reject(err.data)}.bind(this)),deferred.promise},getEstadosMexico:function(){var deferred=$q.defer();return McaServicesProvider.getAbs("estados_full_mx.json").success(function(resp){deferred.resolve(resp)})["catch"](function(err){deferred.reject(err.data)}.bind(this)),deferred.promise},getAccountAddress:function(){var deferred=$q.defer();return McaServicesProvider.get("account/address/list.do").success(function(resp){deferred.resolve(resp)})["catch"](function(err){deferred.reject(err.data)}.bind(this)),deferred.promise}}}),angular.module("SucursApps").factory("WrapperServicesProvider",function($http){var _service=function(pMethod,pServ,pOper,pData,pHeader){var headers={"Content-Type":"application/json","Data-Type":"json"};return(void 0!==pHeader||null!==pHeader)&&(headers=getHeaderProperties(headers,pHeader)),$http({method:pMethod,url:window.location.protocol+"//"+pServ+".wrapper/"+pOper,data:pData,withCredentials:!1,currentContext:!0,headers:headers})},getHeaderProperties=function(pHeader,pProps){if(pProps)for(var prop in pProps)pHeader[prop]=pProps[prop];return pHeader};return{get:function(pServ,pOper,pHeader){return _service("GET",pServ,pOper,null,pHeader)},post:function(pServ,pOper,pData,pHeader){return _service("POST",pServ,pOper,pData,pHeader)}}}),angular.module("SucursApps").factory("PinPadWrapperService",function(WrapperServicesProvider,$q){return{getCardInfo:function(period){var deferred=$q.defer();return WrapperServicesProvider.get("pinpad","cardInfo",null).success(function(response){"NO_OK"===response.res?deferred.reject(response):deferred.resolve(response)})["catch"](function(err){err.data?deferred.reject(err.data):deferred.reject(err)}),deferred.promise}}});var Base64Binary={_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",decodeArrayBuffer:function(t){var A=3*(t.length/4),_=new ArrayBuffer(A);return this.decode(t,_),_},decode:function(t,A){var _=this._keyStr.indexOf(t.charAt(t.length-1)),a=this._keyStr.indexOf(t.charAt(t.length-2)),R=3*(t.length/4);64==_&&R--,64==a&&R--;var P,n,E,e,o,M,T,s,c=0,C=0;for(P=A?new Uint8Array(A):new Uint8Array(R),t=t.replace(/[^A-Za-z0-9\+\/\=]/g,""),c=0;R>c;c+=3)o=this._keyStr.indexOf(t.charAt(C++)),M=this._keyStr.indexOf(t.charAt(C++)),T=this._keyStr.indexOf(t.charAt(C++)),s=this._keyStr.indexOf(t.charAt(C++)),n=o<<2|M>>4,E=(15&M)<<4|T>>2,e=(3&T)<<6|s,P[c]=n,64!=T&&(P[c+1]=E),64!=s&&(P[c+2]=e);return P},encode:function(t){for(var A,_,a,R,P,n="",E=t.byteLength,e=E%3,o=E-e,M=0;o>M;M+=3)P=t[M]<<16|t[M+1]<<8|t[M+2],A=(16515072&P)>>18,_=(258048&P)>>12,a=(4032&P)>>6,R=63&P,n+=this._keyStr[A]+this._keyStr[_]+this._keyStr[a]+this._keyStr[R];return 1==e?(P=t[o],A=(252&P)>>2,_=(3&P)<<4,n+=this._keyStr[A]+this._keyStr[_]+"=="):2==e&&(P=t[o]<<8|t[o+1],A=(64512&P)>>10,_=(1008&P)>>4,a=(15&P)<<2,n+=this._keyStr[A]+this._keyStr[_]+this._keyStr[a]+"="),n}},PUMAWS=window.PUMAWS||{};PUMAWS["private"]=PUMAWS["private"]||{},PUMAWS["const"]=PUMAWS["const"]||{},PUMAWS["const"].WS_HANDLER_STATUS="wsstatus",PUMAWS["const"].WS_HANDLER_MESSAGE="pumaMessage",PUMAWS["const"].WS_HANDLER_ERROR="error",PUMAWS["const"].WS_STATUS_OPEN="WS_OPEN",PUMAWS["const"].WS_STATUS_LOGGED="WS_LOGGED",PUMAWS["const"].WS_STATUS_NOT_LOGGED="WS_NOT_LOGGED",PUMAWS["const"].WS_STATUS_CLOSED="WS_CLOSED",PUMAWS["const"].WS_STATUS_ERROR="WS_ERROR",PUMAWS.ws=null,PUMAWS.user=null,PUMAWS.pwd=null,PUMAWS.host=null,PUMAWS.host=null,PUMAWS.serviceId=null,PUMAWS.connectWS=function(t,A,_,a,R){PUMAWS.user=a,PUMAWS.pwd=R,PUMAWS.serviceId=t,PUMAWS.port=_,PUMAWS.host=A,PUMAWS.ws=new WebSocket("ws://"+A+":"+_+"/websocket"),PUMAWS.ws.onopen=PUMAWS.wsopen,PUMAWS.ws.onclose=PUMAWS.wsclose,PUMAWS.ws.onmessage=PUMAWS.wsmessage,PUMAWS.ws.onerror=PUMAWS.wserror,console.log("[PUMAWS.connectWS] Connecting to "+A+" port: "+_)},PUMAWS.disconnectWS=function(){null!=PUMAWS.ws&&PUMAWS.ws.close()},PUMAWS.login=function(){var t=JSON.stringify(PUMA.LoginMessage(PUMAWS.host,PUMAWS.serviceId,PUMAWS.user,PUMAWS.pwd));PUMAWS.sendMessage(t)},PUMAWS.wsopen=function(){PUMAWS.listeners[PUMAWS["const"].WS_HANDLER_STATUS](PUMAWS["const"].WS_STATUS_OPEN);var t=JSON.stringify(PUMA.LoginMessage(PUMAWS.host,PUMAWS.serviceId,PUMAWS.user,PUMAWS.pwd));PUMAWS.sendMessage(t)},PUMAWS.wsclose=function(t){console.log("WebSocket Close!! Code: "+t.code+" Reason: "+t.reason),PUMAWS.listeners[PUMAWS["const"].WS_HANDLER_STATUS](PUMAWS["const"].WS_STATUS_CLOSED)},PUMAWS.wsmessage=function(t){var A=PUMA.parse(t.data);A.methodName.v==PUMA["const"].PUMA_METHOD_LOGIN?0==A.data.v.code.v?PUMAWS.listeners[PUMAWS["const"].WS_HANDLER_STATUS](PUMAWS["const"].WS_STATUS_LOGGED):PUMAWS.listeners[PUMAWS["const"].WS_HANDLER_STATUS](PUMAWS["const"].WS_STATUS_NOT_LOGGED):PUMAWS.listeners[PUMAWS["const"].WS_HANDLER_MESSAGE](A)},PUMAWS.wserror=function(){PUMAWS.listeners[PUMAWS["const"].WS_HANDLER_STATUS](PUMAWS["const"].WS_STATUS_ERROR)},PUMAWS.error=function(t){PUMAWS.listeners[PUMAWS["const"].WS_HANDLER_ERROR](t)},PUMAWS.close=function(){PUMAWS.ws.close()},PUMAWS.sendMessage=function(t){PUMAWS.ws.send(t)},PUMAWS.listeners={error:null,pumaMessage:null,wsstatus:null,debug:null},PUMAWS.init=function(t){PUMAWS.listeners.pumaMessage=t.onMessage,PUMAWS.listeners.error=t.onError,PUMAWS.listeners.wsstatus=t.onWSStatus};var PUMA=window.PUMA||{};PUMA.util=PUMA.util||{},PUMA["private"]=PUMA["private"]||{},PUMA["const"]=PUMA["const"]||{},PUMA["const"].PUMA_METHOD_CALL="com.dtg.puma.common.objects.PumaMethodCall",PUMA["const"].PUMA_METHOD_CALL_REQUEST="com.dtg.puma.common.objects.PumaRequest",PUMA["const"].PUMA_METHOD_RESPONSE="com.dtg.puma.common.objects.PumaResponse",PUMA["const"].PUMA_METHOD_EVENT="pumaEvent",PUMA["const"].PUMA_STATUS_EVENT="com.dtg.puma.common.objects.PumaStatusEvent",PUMA["const"].PUMA_TARGET_CORE="PumaCore",PUMA["const"].PUMA_METHOD_LOGIN="login",PUMA["const"].PUMA_INT="int",PUMA["const"].PUMA_FLOAT="float",PUMA["const"].PUMA_DOUBLE="double",PUMA["const"].PUMA_CHAR="char",PUMA["const"].PUMA_LONG="long",PUMA["const"].PUMA_STRING="str",PUMA["const"].PUMA_BOOLEAN="bool",PUMA["const"].PUMA_LIST="lst",PUMA["const"].PUMA_VECTOR="vec",PUMA["const"].PUMA_TABLE="tbl",PUMA["const"].PUMA_MAP="map",PUMA["const"].PUMA_OBJECT="pObj",PUMA["const"].PUMA_OBJECT_ARRAY="objA",PUMA["const"].PUMA_BYTE_ARRAY="b64",PUMA["const"].JAVA_BYTE_ARRAY="[B",PUMA["const"].JAVA_BOOL_ARRAY="[Z",PUMA["const"].JAVA_INT_ARRAY="[I",PUMA["const"].JAVA_LONG_ARRAY="[J",PUMA["const"].JAVA_FLOAT_ARRAY="[F",PUMA["const"].JAVA_DOUBLE_ARRAY="[D",PUMA["const"].JAVA_CHAR_ARRAY="[C",PUMA["const"].JAVA_STRING_ARRAY="java.lang.String",PUMA.PumaParam=function(t,A,_){this.t=t,this.v=A,_&&(this.n=_)},PUMA.PumaObject=function(t){this.cl=t.getInstance;for(var A in t)"getInstance"!=A&&(this[A]=PUMA["private"].serializePumaParam(t[A],name))},PUMA.parse=function(t){var A=$.parseJSON(t);return A.v},PUMA.PumaMethodCall=function(t,A,_,a,R,P){var n=Object();n.cl=PUMA["const"].PUMA_METHOD_CALL,n.host=new PUMA.PumaParam(PUMA["const"].PUMA_STRING,t),n.service=new PUMA.PumaParam(PUMA["const"].PUMA_STRING,A),n.target=new PUMA.PumaParam(PUMA["const"].PUMA_STRING,_),n.id=new PUMA.PumaParam(PUMA["const"].PUMA_INT,a),n.controlData=new PUMA.PumaParam(PUMA["const"].PUMA_MAP,Array());var E=Object();return E.cl=PUMA["const"].PUMA_METHOD_CALL_REQUEST,E.method=new PUMA.PumaParam(PUMA["const"].PUMA_STRING,R),E.params=new PUMA.PumaParam(PUMA["const"].PUMA_LIST,P),n.request=new PUMA.PumaParam(PUMA["const"].PUMA_OBJECT,E),new PUMA.PumaParam(PUMA["const"].PUMA_OBJECT,n)},PUMA.LoginMessage=function(t,A,_,a){var R=Array(5);R[0]=new PUMA.PumaParam(PUMA["const"].PUMA_STRING,_),R[1]=new PUMA.PumaParam(PUMA["const"].PUMA_STRING,a),R[2]=new PUMA.PumaParam(PUMA["const"].PUMA_BOOLEAN,!1),R[3]=new PUMA.PumaParam(PUMA["const"].PUMA_STRING,"ignore"),R[4]=new PUMA.PumaParam(PUMA["const"].PUMA_STRING,"empty");var P=PUMA.PumaMethodCall(t,A,PUMA["const"].PUMA_TARGET_CORE,-1,PUMA["const"].PUMA_METHOD_LOGIN,R);return P},PUMA.arrayParam=function(t,A,_){var a="";t===PUMA["const"].JAVA_BOOL_ARRAY?a=PUMA["const"].PUMA_BOOLEAN:t===PUMA["const"].JAVA_INT_ARRAY?a=PUMA["const"].PUMA_INT:t===PUMA["const"].JAVA_LONG_ARRAY?a=PUMA["const"].PUMA_LONG:t===PUMA["const"].JAVA_FLOAT_ARRAY?a=PUMA["const"].PUMA_FLOAT:t===PUMA["const"].JAVA_DOUBLE_ARRAY?a=PUMA["const"].PUMA_DOUBLE:t===PUMA["const"].JAVA_CHAR_ARRAY?a=PUMA["const"].PUMA_CHAR:(a=PUMA["const"].PUMA_OBJECT,t="[L"+t+";");var R=Array(A.length);for(i=0;A.length>i;i++)R[i]=new PUMA.PumaParam(a,A[i]);var P=Object();return _&&(P.n=_),P.t=PUMA["const"].PUMA_OBJECT_ARRAY,P.cl=t,P.v=R,P},PUMA["private"].PumaMapEntry=function(t,A){this.key=t,this.value=A,this.getInstance="PUMA.PumaMapEntry"},PUMA["private"].Param=function(){this.n="",this.t="",this.v=""},PUMA["private"].Param=function(t,A,_){_&&(this.n=_),this.t=t,this.v=A},PUMA["private"].serializePumaObject=function(t,A){A||(A="");var _=new PUMA["private"].Param(PUMA["const"].PUMA_OBJECT,new PUMA.PumaObject(t,A),A);return _},PUMA["private"].serializePumaParam=function(t,A){A||(A="");var _=new PUMA["private"].Param;if(_.n=A,_.t=t.t,_.t==PUMA["const"].PUMA_OBJECT_ARRAY)_.v=PUMA["private"].serializeObjArray(t.v);else if(_.t==PUMA["const"].PUMA_LIST||_.t==PUMA["const"].PUMA_VECTOR)_.v=PUMA["private"].serializeList(t.v);else if(_.t==PUMA["const"].PUMA_MAP||_.t==PUMA["const"].PUMA_TABLE)_.v=PUMA["private"].serializeMap(t.v);else if(_.t==PUMA["const"].PUMA_BYTE_ARRAY){for(var a=new Uint8Array(t.v.length),R=0;t.v.length>R;R++)a[R]=t.v[R];_.v=Base64Binary.encode(a)}else _.v=t.v;return _},PUMA["private"].serializeObjArray=function(t){for(var A=Array(),_=0;t.length>_;_++)A[_]=new PUMA["private"].serializePumaObject(t[_]);return A},PUMA["private"].serializeList=function(t){for(var A=Array(),_=0;t.length>_;_++)A[_]=new PUMA.serialize(t[_]);return A},PUMA["private"].serializeMap=function(t){for(var A=Array(),_=0;t.length>_;_++){var a=Object();a.key=new PUMA.serialize(t[_].key),a.value=new PUMA.serialize(t[_].value),A[_]=a}return A},PUMA["private"].parsePumaParam=function(t){var A;if(t.t==PUMA["const"].PUMA_OBJECT)A=PUMA["private"].parseObject(t.v);else if(t.t==PUMA["const"].PUMA_LIST||t.t==PUMA["const"].PUMA_VECTOR||t.t==PUMA["const"].PUMA_INT_ARRAY||t.t==PUMA["const"].PUMA_LONG_ARRAY||t.t==PUMA["const"].PUMA_FLOAT_ARRAY||t.t==PUMA["const"].PUMA_DOUBLE_ARRAY||t.t==PUMA["const"].PUMA_CHAR_ARRAY||t.t==PUMA["const"].PUMA_BOOL_ARRAY||t.t==PUMA["const"].PUMA_OBJECT_ARRAY)A=PUMA["private"].parseArray(t);else if(t.t==PUMA["const"].PUMA_MAP||t.t==PUMA["const"].PUMA_TABLE)A=PUMA["private"].parseMap(t);else if(t.t==PUMA["const"].PUMA_BYTE_ARRAY)var A=new PUMA.PumaParam(t.t,Base64Binary.decode(t.v));else var A=new PUMA.PumaParam(t.t,t.v);return A},PUMA["private"].parseObject=function(t){var A=Object();A.getInstance=t.pumaName_;for(var _=0;t.attr_.length>_;_++){var a=t.attr_[_];A[a.n]=PUMA["private"].parsePumaParam(a)}return A},PUMA["private"].parseArray=function(t){for(var A=t.v,_=Array(),a=0;A.length>a;a++){var R=A[a];_[a]=t.t==PUMA["const"].PUMA_OBJECT_ARRAY||t.t==PUMA["const"].PUMA_LIST||t.t==PUMA["const"].PUMA_VECTOR?PUMA["private"].parsePumaParam(R):R}return new PUMA.PumaParam(t.t,_)},PUMA["private"].parseMap=function(t){for(var A=t.v,_=Array(),a=0;A.length>a;a++){var R=A[a].mk,P=A[a].mv;_[a]=new PUMA["private"].PumaMapEntry(PUMA["private"].parsePumaParam(R),PUMA["private"].parsePumaParam(P))}return new PUMA.PumaParam(t.t,_)},PUMA.util.u8ArrayToHexString=function(t){if(t){for(var A="",_=0;t.length>_;_++){var a=t[_].toString(16),R=2>a.length?"0x0"+a:"0x"+a;A+=R+" "}return A.replace(/^\s+|\s+$/g,"")}return""},PUMA.action=PUMA.action||{},PUMA.action["const"]=PUMA.action["const"]||{},PUMA.action["const"].SERVICE_ID="PumaActionService",PUMA.action["const"].SERVICE_TARGET="ServiceTarget",PUMA.action["const"].TRANSACTION_TARGET="TransactionTarget",PUMA.action["const"].DEVICEMANAGER_TARGET="DeviceManagerTarget",PUMA.action["const"].ACTION_TARGET="ActionTarget",PUMA.action["const"].METHOD_CANCEL_ACTION="Cancel",PUMA.action["const"].METHOD_GET_DEVICE_LIST="getDeviceList",PUMA.action["const"].METHOD_GET_ACTION_LIST="getActionList",PUMA.action["const"].METHOD_GET_ACTION_PARAMETERS_LIST="getActionParameters",PUMA.action["const"].METHOD_OPEN_TRANSACTION="openTransaction",PUMA.action["const"].METHOD_CLOSE_TRANSACTION="closeTransaction",PUMA.action["const"].METHOD_GET_CURRENT_CLIENTS="getCurrentClients",PUMA.action["const"].METHOD_GET_CURRENT_TRANSACTIONS="getCurrentTransactions",PUMA.action["const"].METHOD_GET_CURRENT_TRANSACTION_ACTIONS="getCurrentTransactionActions",PUMA.action["const"].METHOD_REGISTER_STATUS_LISTENER="registerStatusListener",PUMA.action["const"].METHOD_UNREGISTER_STATUS_LISTENER="unregisterStatusListener",PUMA.action["const"].RESULT_ACTION_SUBMIT="com.dtg.puma.action.objects.PumaActionSubmitResult",PUMA.action["const"].RESULT_ACTION_EVENT="com.dtg.puma.action.objects.PumaActionEvent",PUMA.action.getDeviceList=function(t,A){void 0===A&&(A=-1),console.log(">> PUMA.action.getDeviceList");var _=new PUMA.PumaMethodCall(t,PUMA.action["const"].SERVICE_ID,PUMA.action["const"].SERVICE_TARGET,A,PUMA.action["const"].METHOD_GET_DEVICE_LIST,Array());return JSON.stringify(_,null,"   ")},PUMA.action.getActionList=function(t,A){void 0===A&&(A=-1),console.log(">> PUMA.action.getActionList");var _=new PUMA.PumaMethodCall(t,PUMA.action["const"].SERVICE_ID,PUMA.action["const"].SERVICE_TARGET,A,PUMA.action["const"].METHOD_GET_ACTION_LIST,Array());return JSON.stringify(_,null,"   ")},PUMA.action.getActionParameters=function(t,A,_){void 0===_&&(_=-1),console.log(">> PUMA.action.getActionParameters ("+A+")");var a=Array();A&&a.push(new PUMA.PumaParam(PUMA["const"].PUMA_STRING,A));var R=new PUMA.PumaMethodCall(t,PUMA.action["const"].SERVICE_ID,PUMA.action["const"].SERVICE_TARGET,_,PUMA.action["const"].METHOD_GET_ACTION_PARAMETERS_LIST,a);return JSON.stringify(R,null,"   ")},PUMA.action.executeAction=function(t,A,_,a){void 0===a&&(a=-1),console.log(">> PUMA.action.executeAction ("+A+")");var R=new PUMA.PumaMethodCall(t,PUMA.action["const"].SERVICE_ID,PUMA.action["const"].ACTION_TARGET,a,A,_);return JSON.stringify(R,null,"   ")},PUMA.action.cancelAction=function(t,A,_){void 0===_&&(_=-1),console.log(">> PUMA.action.cancelAction ("+A+")");var a=Array(),R=new PUMA.PumaParam(PUMA["const"].PUMA_STRING,A);a.push(R);var P=new PUMA.PumaMethodCall(t,PUMA.action["const"].SERVICE_ID,PUMA.action["const"].ACTION_TARGET,_,PUMA.action["const"].METHOD_CANCEL_ACTION,a);return JSON.stringify(P,null,"   ")},PUMA.action.getDeviceListParameter=function(t){for(var A=Array(),_=0;t.length>_;_++)A[_]=new PUMA.PumaParam(PUMA["const"].PUMA_STRING,t[_]);var a=new PUMA.PumaParam(PUMA["const"].PUMA_LIST,A);return a},PUMA.action.openTransaction=function(t,A,_){void 0===_&&(_=-1),console.log(">> PUMA.action.openTransaction");var a=Array();a[0]=PUMA.action.getDeviceListParameter(A);var R=new PUMA.PumaMethodCall(t,PUMA.action["const"].SERVICE_ID,PUMA.action["const"].TRANSACTION_TARGET,_,PUMA.action["const"].METHOD_OPEN_TRANSACTION,a);return JSON.stringify(R,null,"   ")},PUMA.action.closeTransaction=function(t,A,_){void 0===_&&(_=-1),console.log(">> PUMA.action.closeTransaction ("+A+")");var a=new PUMA.PumaParam(PUMA["const"].PUMA_STRING,A),R=Array();R[0]=a;var P=new PUMA.PumaMethodCall(t,PUMA.action["const"].SERVICE_ID,PUMA.action["const"].TRANSACTION_TARGET,_,PUMA.action["const"].METHOD_CLOSE_TRANSACTION,R);return JSON.stringify(P,null,"   ")},PUMA.action.getCurrentClients=function(t,A){void 0===A&&(A=-1),console.log(">> PUMA.action.getCurrentClients: "+A);var _=new PUMA.PumaMethodCall(t,PUMA.action["const"].SERVICE_ID,PUMA.action["const"].TRANSACTION_TARGET,A,PUMA.action["const"].METHOD_GET_CURRENT_CLIENTS,Array());return JSON.stringify(_,null,"   ")},PUMA.action.getCurrentTransactions=function(t,A,_){void 0===_&&(_=-1),console.log(">> PUMA.action.getCurrentTransactions: "+_+"("+A+")");var a=Array();if(A){var R=new PUMA.PumaParam(PUMA["const"].PUMA_STRING,A);a[0]=R}var P=new PUMA.PumaMethodCall(t,PUMA.action["const"].SERVICE_ID,PUMA.action["const"].TRANSACTION_TARGET,_,PUMA.action["const"].METHOD_GET_CURRENT_TRANSACTIONS,a);return JSON.stringify(P,null,"   ")},PUMA.action.getCurrentTransactionActions=function(t,A,_){void 0===_&&(_=-1),console.log(">> PUMA.action.getCurrentTransactionActions: "+_+"("+A+")");var a=Array();if(A){var R=new PUMA.PumaParam(PUMA["const"].PUMA_STRING,A);a[0]=R}var P=new PUMA.PumaMethodCall(t,PUMA.action["const"].SERVICE_ID,PUMA.action["const"].TRANSACTION_TARGET,_,PUMA.action["const"].METHOD_GET_CURRENT_TRANSACTION_ACTIONS,a);return JSON.stringify(P,null,"   ")},PUMA.action.registerStatusListener=function(t,A,_,a){void 0===a&&(a=-1),console.log(">> PUMA.action.registerStatusListener ("+A+")");var R=new PUMA.PumaParam(PUMA["const"].PUMA_STRING,A),P=Array();P[0]=R,P[1]=new PUMA.PumaParam(PUMA["const"].PUMA_INT,_);var n=new PUMA.PumaMethodCall(t,PUMA.action["const"].SERVICE_ID,PUMA.action["const"].DEVICEMANAGER_TARGET,a,PUMA.action["const"].METHOD_REGISTER_STATUS_LISTENER,P);return JSON.stringify(n,null,"   ")},PUMA.action.unregisterStatusListener=function(t,A,_,a){void 0===a&&(a=-1),console.log(">> PUMA.action.unregisterStatusListener ("+A+")");var R=new PUMA.PumaParam(PUMA["const"].PUMA_STRING,A),P=Array();P[0]=R,P[1]=new PUMA.PumaParam(PUMA["const"].PUMA_INT,_);var n=new PUMA.PumaMethodCall(t,PUMA.action["const"].SERVICE_ID,PUMA.action["const"].DEVICEMANAGER_TARGET,a,PUMA.action["const"].METHOD_UNREGISTER_STATUS_LISTENER,P);return JSON.stringify(n,null,"   ")};var pb=window.pb||{};!function(){var t=[],A=[],_=["idle","connected","ready","transactionClosed","disconnected"],a=_[0],R=null,P=null,n=function(t,A){pumaConfig.isLogEnabled()&&console.log("("+t+") [flowStatus="+a+" :: "+A)};pb.SUCCESS=0,pb.ERR_ALREADY_STARTED=-1,pb.ERR_API_VER_TOO_HIGH=-2,pb.ERR_API_VER_TOO_LOW=-3,pb.ERR_CANCELED=-4,pb.ERR_CFG_INVALID_HKEY=-5,pb.ERR_CFG_INVALID_NAME=-6,pb.ERR_CFG_INVALID_SUBKEY=-7,pb.ERR_CFG_INVALID_VALUE=-8,pb.ERR_CFG_KEY_NOT_EMPTY=-9,pb.ERR_CFG_NAME_TOO_LONG=-10,pb.ERR_CFG_NO_MORE_ITEMS=-11,pb.ERR_CFG_VALUE_TOO_LONG=-12,pb.ERR_DEV_NOT_READY=-13,pb.ERR_HARDWARE_ERROR=-14,pb.ERR_INTERNAL_ERROR=-15,pb.ERR_INVALID_ADDRESS=-16,pb.ERR_INVALID_APP_HANDLE=-17,pb.ERR_INVALID_BUFFER=-18,pb.ERR_INVALID_CATEGORY=-19,pb.ERR_INVALID_COMMAND=-20,pb.ERR_INVALID_EVENT_CLASS=-21,pb.ERR_INVALID_HSERVICE=-22,pb.ERR_INVALID_HPROVIDER=-23,pb.ERR_INVALID_HWND=-24,pb.ERR_INVALID_HWNDREG=-25,pb.ERR_INVALID_POINTER=-26,pb.ERR_INVALID_REQ_ID=-27,pb.ERR_INVALID_RESULT=-28,pb.ERR_INVALID_SERVPROV=-29,pb.ERR_INVALID_TIMER=-30,pb.ERR_INVALID_TRACELEVEL=-31,pb.ERR_LOCKED=-32,pb.ERR_NO_BLOCKING_CALL=-33,pb.ERR_NO_SERVPROV=-34,pb.ERR_NO_SUCH_THREAD=-35,pb.ERR_NO_TIMER=-36,pb.ERR_NOT_LOCKED=-37,pb.ERR_NOT_OK_TO_UNLOAD=-38,pb.ERR_NOT_STARTED=-39,pb.ERR_NOT_REGISTERED=-40,pb.ERR_OP_IN_PROGRESS=-41,pb.ERR_OUT_OF_MEMORY=-42,pb.ERR_SERVICE_NOT_FOUND=-43,pb.ERR_SPI_VER_TOO_HIGH=-44,pb.ERR_SPI_VER_TOO_LOW=-45,pb.ERR_SRVC_VER_TOO_HIGH=-46,pb.ERR_SRVC_VER_TOO_LOW=-47,pb.ERR_TIMEOUT=-48,pb.ERR_UNSUPP_CATEGORY=-49,pb.ERR_UNSUPP_COMMAND=-50,pb.ERR_VERSION_ERROR_IN_SRVC=-51,pb.ERR_INVALID_DATA=-52,pb.ERR_SOFTWARE_ERROR=-53,pb.ERR_CONNECTION_LOST=-54,pb.ERR_USER_ERROR=-55,pb.ERR_UNSUPP_DATA=-56,pb.ERR_FRAUD_ATTEMPT=-57,pb.ERR_SEQUENCE_ERROR=-58,pb.ERR_PUMA_CONNECTION=-1e5,pb.ERR_PUMA_ERROR=-2e5,pb.ERR_PUMA_ACTION_ERROR=-3e5,pb.ERR_PUMA_TRANSACTION_ERROR=-4e5,pb.ERR_SOCKET_ERROR=-5e5,pb.ERR_ALREADY_DISCONNECTED=-6e5,pb.ERR_ALREADY_CONNECTED=-7e5,pb.ERR_IN_CANCEL=-8e5,pb.ERR_IDC_MEDIAJAM=-200,pb.ERR_IDC_NOMEDIA=-201,pb.ERR_IDC_MEDIARETAINED=-202,pb.ERR_IDC_RETAINBINFULL=-203,pb.ERR_IDC_INVALIDDATA=-204,pb.ERR_IDC_INVALIDMEDIA=-205,pb.ERR_IDC_FORMNOTFOUND=-206,pb.ERR_IDC_FORMINVALID=-207,pb.ERR_IDC_DATASYNTAX=-208,pb.ERR_IDC_SHUTTERFAIL=-209,pb.ERR_IDC_SECURITYFAIL=-210,pb.ERR_IDC_PROTOCOLNOTSUPP=-211,pb.ERR_IDC_ATRNOTOBTAINED=-212,pb.ERR_IDC_INVALIDKEY=-213,pb.ERR_IDC_WRITE_METHOD=-214,pb.ERR_IDC_CHIPPOWERNOTSUPP=-215,pb.ERR_IDC_CARDTOOSHORT=-216,pb.ERR_IDC_CARDTOOLONG=-217,pb.ERR_IDC_INVALID_PORT=-218,pb.ERR_IDC_POWERSAVETOOSHORT=-219,pb.ERR_IDC_POWERSAVEMEDIAPRESENT=-220,pb.ERR_IDC_CARDPRESENT=-221,pb.ERR_IDC_POSITIONINVALID=-222,pb.ERR_PTR_FORMNOTFOUND=-100,pb.ERR_PTR_FIELDNOTFOUND=-101,pb.ERR_PTR_NOMEDIAPRESENT=-102,pb.ERR_PTR_READNOTSUPPORTED=-103,pb.ERR_PTR_FLUSHFAIL=-104,pb.ERR_PTR_MEDIAOVERFLOW=-105,pb.ERR_PTR_FIELDSPECFAILURE=-106,pb.ERR_PTR_FIELDERROR=-107,pb.ERR_PTR_MEDIANOTFOUND=-108,pb.ERR_PTR_EXTENTNOTSUPPORTED=-109,pb.ERR_PTR_MEDIAINVALID=-110,pb.ERR_PTR_FORMINVALID=-111,pb.ERR_PTR_FIELDINVALID=-112,pb.ERR_PTR_MEDIASKEWED=-113,pb.ERR_PTR_RETRACTBINFULL=-114,pb.ERR_PTR_STACKERFULL=-115,pb.ERR_PTR_PAGETURNFAIL=-116,pb.ERR_PTR_MEDIATURNFAIL=-117,pb.ERR_PTR_SHUTTERFAIL=-118,pb.ERR_PTR_MEDIAJAMMED=-119,pb.ERR_PTR_FILE_IO_ERROR=-120,pb.ERR_PTR_CHARSETDATA=-121,pb.ERR_PTR_PAPERJAMMED=-122,pb.ERR_PTR_PAPEROUT=-123,pb.ERR_PTR_INKOUT=-124,pb.ERR_PTR_TONEROUT=-125,pb.ERR_PTR_LAMPINOP=-126,pb.ERR_PTR_SOURCEINVALID=-127,pb.ERR_PTR_SEQUENCEINVALID=-128,pb.ERR_PTR_MEDIASIZE=-129,pb.ERR_PTR_INVALID_PORT=-130,pb.ERR_PTR_MEDIARETAINED=-131,pb.ERR_PTR_BLACKMARK=-132,pb.ERR_PTR_DEFINITIONEXISTS=-133,pb.ERR_PTR_MEDIAREJECTED=-134,pb.ERR_PTR_MEDIARETRACTED=-135,pb.ERR_PTR_MSFERROR=-136,pb.ERR_PTR_NOMSF=-137,pb.ERR_PTR_FILENOTFOUND=-138,pb.ERR_PTR_POWERSAVETOOSHORT=-139,pb.ERR_PTR_POWERSAVEMEDIAPRESENT=-140,pb.ERR_PTR_PASSBOOKCLOSED=-141,pb.ERR_PTR_LASTORFIRSTPAGEREACHED=-142,pb.ERR_PIN_KEYNOTFOUND=-400,pb.ERR_PIN_MODENOTSUPPORTED=-401,pb.ERR_PIN_ACCESSDENIED=-402,pb.ERR_PIN_INVALIDID=-403,pb.ERR_PIN_DUPLICATEKEY=-404,pb.ERR_PIN_KEYNOVALUE=-406,pb.ERR_PIN_USEVIOLATION=-407,pb.ERR_PIN_NOPIN=-408,
pb.ERR_PIN_INVALIDKEYLENGTH=-409,pb.ERR_PIN_KEYINVALID=-410,pb.ERR_PIN_KEYNOTSUPPORTED=-411,pb.ERR_PIN_NOACTIVEKEYS=-412,pb.ERR_PIN_NOTERMINATEKEYS=-414,pb.ERR_PIN_MINIMUMLENGTH=-415,pb.ERR_PIN_PROTOCOLNOTSUPP=-416,pb.ERR_PIN_INVALIDDATA=-417,pb.ERR_PIN_NOTALLOWED=-418,pb.ERR_PIN_NOKEYRAM=-419,pb.ERR_PIN_NOCHIPTRANSACTIVE=-420,pb.ERR_PIN_ALGORITHMNOTSUPP=-421,pb.ERR_PIN_FORMATNOTSUPP=-422,pb.ERR_PIN_HSMSTATEINVALID=-423,pb.ERR_PIN_MACINVALID=-424,pb.ERR_PIN_PROTINVALID=-425,pb.ERR_PIN_FORMATINVALID=-426,pb.ERR_PIN_CONTENTINVALID=-427,pb.ERR_PIN_SIG_NOT_SUPP=-429,pb.ERR_PIN_INVALID_MOD_LEN=-431,pb.ERR_PIN_INVALIDCERTSTATE=-432,pb.ERR_PIN_KEY_GENERATION_ERROR=-433,pb.ERR_PIN_EMV_VERIFY_FAILED=-434,pb.ERR_PIN_RANDOMINVALID=-435,pb.ERR_PIN_SIGNATUREINVALID=-436,pb.ERR_PIN_SNSCDINVALID=-437,pb.ERR_PIN_NORSAKEYPAIR=-438,pb.ERR_PIN_INVALID_PORT=-439,pb.ERR_PIN_POWERSAVETOOSHORT=-440,pb.ERR_PIN_INVALIDHSM=-441,pb.ERR_BCR_BARCODEINVALID=-1500,pb.ERR_BCR_INVALID_PORT=-1501,pb.ERR_BCR_POWERSAVETOOSHORT=-1502,pb.DEVICE_ST_ONLINE=0,pb.DEVICE_ST_OFFLINE=1,pb.DEVICE_ST_POWEROFF=2,pb.DEVICE_ST_NODEVICE=3,pb.DEVICE_ST_HWERROR=4,pb.DEVICE_ST_USERERROR=5,pb.DEVICE_ST_BUSY=6,pb.MEDIA_IDC_ST_PRESENT=1,pb.MEDIA_IDC_ST_NOTPRESENT=2,pb.MEDIA_IDC_ST_JAMMED=3,pb.MEDIA_IDC_ST_NOTSUPP=4,pb.MEDIA_IDC_ST_UNKNOWN=5,pb.MEDIA_IDC_ST_ENTERING=6,pb.MEDIA_IDC_ST_LATCHED=7,pb.PAPER_PTR_ST_FULL=0,pb.PAPER_PTR_ST_LOW=1,pb.PAPER_PTR_ST_OUT=2,pb.PAPER_PTR_ST_NOTSUPP=3,pb.PAPER_PTR_ST_UNKNOWN=4,pb.PAPER_PTR_ST_JAMMED=5,pb.BIN_PTR_ST_OK=0,pb.BIN_PTR_ST_FULL=1,pb.BIN_PTR_ST_NOTSUPP=2,pb.BIN_PTR_ST_UNKNOWN=3,pb.BIN_PTR_ST_HIGH=4,pb.BCR_SCANNERON=0,pb.BCR_SCANNEROFF=1,pb.BCR_SCANNERINOP=2,pb.BCR_SCANNERUNKNOWN=3,pb.INPUT_SOURCE_PTR_ANY=1,pb.INPUT_SOURCE_PTR_UPPER=2,pb.INPUT_SOURCE_PTR_LOWER=4,pb.INPUT_SOURCE_PTR_EXTERNAL=8,pb.INPUT_SOURCE_PTR_AUX=16,pb.INPUT_SOURCE_PTR_AUX2=32,pb.INPUT_SOURCE_PTR_PARK=64,pb.CTRL_PTR_EJECT=1,pb.CTRL_PTR_PERFORATE=2,pb.CTRL_PTR_CUT=4,pb.CTRL_PTR_SKIP=8,pb.CTRL_PTR_FLUSH=16,pb.CTRL_PTR_RETRACT=32,pb.CTRL_PTR_STACK=64,pb.CTRL_PTR_PARTIALCUT=128,pb.CTRL_PTR_ALARM=256,pb.CTRL_PTR_ATPFORWARD=512,pb.CTRL_PTR_ATPBACKWARD=1024,pb.CTRL_PTR_TURNMEDIA=2048,pb.CTRL_PTR_STAMP=4096,pb.CTRL_PTR_PARK=8192,pb.CTRL_PTR_EXPEL=16384,pb.CTRL_PTR_EJECTTOTRANSPORT=32768,pb.PIN_FORM3624=1,pb.PIN_FORMANSI=2,pb.PIN_FORMISO0=4,pb.PIN_FORMISO1=8,pb.PIN_FORMECI2=16,pb.PIN_FORMECI3=32,pb.PIN_FORMVISA=64,pb.PIN_FORMDIEBOLD=128,pb.PIN_FORMDIEBOLDCO=256,pb.PIN_FORMVISA3=512,pb.PIN_FORMBANKSYS=1024,pb.PIN_FORMEMV=2048,pb.PIN_FORMISO3=4096,pb.PIN_FORMAP=8192,pb.PIN_USECRYPT=1,pb.PIN_USEFUNCTION=2,pb.PIN_USEMACING=4,pb.PIN_USEKEYENCKEY=32,pb.PIN_USENODUPLICATE=64,pb.PIN_USESVENCKEY=128,pb.PIN_USECONSTRUCT=256,pb.PIN_USESECURECONSTRUCT=512,pb.PIN_USEANSTR31MASTER=1024,pb.PIN_FK_ENTER=1024,pb.PIN_FK_CANCEL=2048,pb.PIN_FK_CLEAR=4096,pb.PIN_FK_BACKSPACE=8192,pb.IDC_CARD_EJECT=0,pb.IDC_CARD_RETAIN=1,pb.EV_TYPE_DEVICE_STATUS=10,pb.EV_TYPE_MEDIA_STATUS=11,pb.EV_TYPE_PAPER_STATUS=12,pb.EV_TYPE_TONNER_STATUS=13,pb.EV_TYPE_INK_STATUS=14,pb.EV_TYPE_LAMP_STATUS=15,pb.EV_TYPE_BIN_STATUS=16,pb.EV_TYPE_MEDIA_TAKEN=17,pb.EV_TYPE_SCANNER_STATUS=21,pb.EV_TYPE_PIN_KEY=41,pb.EV_TYPE_PIN_READY=42,pb.CMD_OPEN_TRANSACTION="openTransaction",pb.CMD_CLOSE_TRANSACTION="closeTransaction",pb.CMD_CANCEL="cancel",pb.CMD_CONNECT="connect",pb.CMD_DISCONNECT="disconnect",pb.CMD_IDC_READCARD="ReadChipTrack2",pb.CMD_IDC_CARDSTATUS="IDCGetStatus",pb.CMD_IDC_EJECTCARD="EjectRetainCard",pb.CMD_IDC_WAITFORTAKEN="CardWaitMediaTaken",pb.CMD_PTR_PRINTDOCUMENT="DocumentPrint",pb.CMD_PTR_DOCUMENTSTATUS="PTRGetStatus",pb.CMD_PTR_CONTROLMEDIA="DocumentEject",pb.CMD_PTR_WAITFORTAKEN="DocumentWaitMediaTaken",pb.CMD_PIN_CREATEPINBLOCK="CreatePinBlock",pb.CMD_PIN_PINSTATUS="PINGetStatus",pb.CMD_PIN_IMPORTKEY="ImportKey",pb.CMD_BCR_BARCODESTATUS="BCRGetStatus",pb.CMD_BCR_READBARCODE="ReadBarCode",pb.RESPONSE_TYPE_EVENT="EVENT",pb.RESPONSE_TYPE_RESULT="RESULT";var E=function(t,A,_){return{type:pb.RESPONSE_TYPE_RESULT,cmd:t,code:A,data:_}},e=function(t,A,_){return{type:pb.RESPONSE_TYPE_EVENT,cmd:t,code:A,data:_}};pb._sendMessage=function(A,_,a,R){var n=Array();n.push(_),null===P&&t[A](E(A,TRANSACTION_ERROR,"Couldn't create transaction"));var e=Array();e[0]=new PUMA.PumaParam("str",P),e[1]=PUMA.action.getDeviceListParameter(n),e.push.apply(e,a);var o=PUMA.action.executeAction(pumaConfig.HOSTNAME,A,e,R);PUMAWS.sendMessage(o)},pb._addCallback=function(A,_){t[A]&&null!=t[A]||(t[A]=_)},pb._removeCallback=function(A){t[A]&&null!=t[A]&&(t[A]=null)},pb.connect=function(A){n("pb.connect","Connecting..."),t[pb.CMD_CONNECT]=A,R=pb.CMD_CONNECT,a!==_[2]?(a=_[0],PUMAWS.init(pb),n("pb.connect","PUMAWS.connect"),PUMAWS.connectWS("PumaActionService",pumaConfig.HOSTNAME,8003,"banorte","banorte")):t[pb.CMD_CONNECT](E(pb.CMD_CONNECT,pb.ERR_ALREADY_CONNECTED))},pb.disconnect=function(A){if(n("pb.disconnect","PUMAWS.close"),t[pb.CMD_DISCONNECT]=A,R=pb.CMD_DISCONNECT,a===_[2]||a===_[3])if(null!=P){R=pb.CMD_CLOSE_TRANSACTION;var e=PUMA.action.closeTransaction(pumaConfig.HOSTNAME,P);PUMAWS.sendMessage(e)}else PUMAWS.close();else t[pb.CMD_DISCONNECT](E(pb.CMD_DISCONNECT,pb.ERR_ALREADY_DISCONNECTED))},pb._cancel=function(R){if(A[R]){if(a===_[2]){var P=PUMA.action.cancelAction(pumaConfig.HOSTNAME,A[R]);PUMAWS.sendMessage(P)}}else t[R](E(R,pb.ERR_IN_CANCEL,"Action: "+A[R]+" doesn't exist."))},pb._getStatus=function(A,R,P){n("pb.getStatus","Status for "+R),pb._addCallback(A,P),a===_[2]?pb._sendMessage(A,R,Array()):t[A](E(A,pb.SOCKET_ERROR,"socket is closed!"))},pb.getBarcodeStatus=function(t){pb._getStatus(pb.CMD_BCR_BARCODESTATUS,pumaConfig.BCR_DEVICE_NAME,t)},pb.getDocumentStatus=function(t){pb._getStatus(pb.CMD_PTR_DOCUMENTSTATUS,pumaConfig.PTR_DOC_DEVICE_NAME,t)},pb.getPinStatus=function(t){pb._getStatus(pb.CMD_PIN_PINSTATUS,pumaConfig.PIN_DEVICE_NAME,t)},pb.getCardStatus=function(t){pb._getStatus(pb.CMD_IDC_CARDSTATUS,pumaConfig.IDC_DEVICE_NAME,t)},pb.readBarcode=function(A){n("pb.readBarcode","Start reading"),pb._addCallback(pb.CMD_BCR_READBARCODE,A),a===_[2]?pb._sendMessage(pb.CMD_BCR_READBARCODE,pumaConfig.BCR_DEVICE_NAME,Array()):t[pb.CMD_BCR_READBARCODE](E(pb.CMD_BCR_READBARCODE,pb.SOCKET_ERROR,"socket is closed!"))},pb.cancelReadBarcode=function(t){pb._cancel(pb.CMD_BCR_READBARCODE,t)},pb.printDocument=function(A,R,P,e,o){if(n("pb.printDocument","FORM: "+A+" MEDIA: "+R+" INPUTTRAY: "+e),pb._addCallback(pb.CMD_PTR_PRINTDOCUMENT,o),a===_[2]){var M=[];for(var T in P)M.push(new PUMA.PumaParam("str",P[T]));var s=Array();s.push(new PUMA.PumaParam("str",A)),s.push(new PUMA.PumaParam("str",R)),s.push(new PUMA.PumaParam("lst",M)),s.push(new PUMA.PumaParam("int",e)),pb._sendMessage(pb.CMD_PTR_PRINTDOCUMENT,pumaConfig.PTR_DOC_DEVICE_NAME,s)}else t[pb.CMD_PTR_PRINTDOCUMENT](E(pb.CMD_PTR_PRINTDOCUMENT,pb.SOCKET_ERROR,"socket is closed!"))},pb.controlDocumentMedia=function(A,R){if(n("pb.controlDocumentMedia"," OP: "+A),pb._addCallback(pb.CMD_PTR_CONTROLMEDIA,R),a===_[2]){var P=Array();P.push(new PUMA.PumaParam("int",A)),pb._sendMessage(pb.CMD_PTR_CONTROLMEDIA,pumaConfig.PTR_DOC_DEVICE_NAME,P)}else t[pb.CMD_PTR_CONTROLMEDIA](E(pb.CMD_PTR_CONTROLMEDIA,pb.SOCKET_ERROR,"socket is closed!"))},pb.waitForMediaTaken=function(A,R){if(n("pb.waitForMediaTaken","Timeout: "+A),pb._addCallback(pb.CMD_PTR_WAITFORTAKEN,R),a===_[2]){var P=Array();P.push(new PUMA.PumaParam("int",A)),pb._sendMessage(pb.CMD_PTR_WAITFORTAKEN,pumaConfig.PTR_DOC_DEVICE_NAME,P)}else t[pb.CMD_PTR_WAITFORTAKEN](E(pb.CMD_PTR_WAITFORTAKEN,pb.SOCKET_ERROR,"socket is closed!"))},pb.createPinBlock=function(A,R,P,e,o,M,T,s){if(n("pb.createPinBlock","Min: "+A+" Max: "+R+" Autoend: "+P+" CustomerData: "+e+" Padding: "+o+" key: "+T+" format: "+M),pb._addCallback(pb.CMD_PIN_CREATEPINBLOCK,s),a===_[2]){var c=Array();c.push(new PUMA.PumaParam("int",A)),c.push(new PUMA.PumaParam("int",R)),c.push(new PUMA.PumaParam("bool",P)),c.push(new PUMA.PumaParam("str",e)),c.push(new PUMA.PumaParam("byte",o)),c.push(new PUMA.PumaParam("int",M)),c.push(new PUMA.PumaParam("str",T)),pb._sendMessage(pb.CMD_PIN_CREATEPINBLOCK,pumaConfig.PIN_DEVICE_NAME,c)}else t[pb.CMD_PIN_CREATEPINBLOCK](E(pb.CMD_PIN_CREATEPINBLOCK,pb.SOCKET_ERROR,"socket is closed!"))},pb.importKey=function(A,R,P,e,o){if(n("pb.importKey","Keyname: "+A+" EncKey: "+R+" Value: "+P+" Use: "+e),pb._addCallback(pb.CMD_PIN_IMPORTKEY,o),a===_[2]){var M=Array();M.push(new PUMA.PumaParam("str",A)),M.push(new PUMA.PumaParam("str",R)),M.push(new PUMA.PumaParam("str",P)),M.push(new PUMA.PumaParam("int",e)),pb._sendMessage(pb.CMD_PIN_IMPORTKEY,pumaConfig.PIN_DEVICE_NAME,M)}else t[pb.CMD_PIN_IMPORTKEY](E(pb.CMD_PIN_IMPORTKEY,pb.SOCKET_ERROR,"socket is closed!"))},pb.cancelCreatePinBlock=function(t){pb._cancel(pb.CMD_PIN_CREATEPINBLOCK,t)},pb.readCard=function(A){if(n("pb.readCard",""),pb._addCallback(pb.CMD_IDC_READCARD,A),a===_[2]){var R=Array();pb._sendMessage(pb.CMD_IDC_READCARD,pumaConfig.IDC_DEVICE_NAME,R)}else t[pb.CMD_IDC_READCARD](E(pb.CMD_IDC_READCARD,pb.SOCKET_ERROR,"socket is closed!"))},pb.ejectCard=function(A,R){if(n("pb.ejectCard","OP: "+A),pb._addCallback(pb.CMD_IDC_EJECTCARD,R),a===_[2]){var P=Array();P.push(new PUMA.PumaParam("int",A)),pb._sendMessage(pb.CMD_IDC_EJECTCARD,pumaConfig.IDC_DEVICE_NAME,P)}else t[pb.CMD_IDC_EJECTCARD](E(pb.CMD_IDC_EJECTCARD,pb.SOCKET_ERROR,"socket is closed!"))},pb.waitForCardTaken=function(A,R){if(n("pb.waitForCardTaken","Timeout: "+A),pb._addCallback(pb.CMD_IDC_WAITFORTAKEN,R),a===_[2]){var P=Array();P.push(new PUMA.PumaParam("int",A)),pb._sendMessage(pb.CMD_IDC_WAITFORTAKEN,pumaConfig.IDC_DEVICE_NAME,P)}else t[pb.CMD_IDC_WAITFORTAKEN](E(pb.CMD_IDC_WAITFORTAKEN,pb.SOCKET_ERROR,"socket is closed!"))},pb.cancelReadCard=function(t){pb._cancel(pb.CMD_IDC_READCARD,t)},pb.onWSStatus=function(A){if(n("pb.onWSStatus","WSSTATUS: "+A),a===_[0]&&A===PUMAWS["const"].WS_STATUS_LOGGED){if(a=_[1],R===pb.CMD_CONNECT){n("pb.onWSStatus","openTransaction for all devices");var P=Array();P.push(pumaConfig.IDC_DEVICE_NAME),P.push(pumaConfig.PTR_RCV_DEVICE_NAME),P.push(pumaConfig.PTR_DOC_DEVICE_NAME),P.push(pumaConfig.PIN_DEVICE_NAME),P.push(pumaConfig.BCR_DEVICE_NAME),R=pb.CMD_OPEN_TRANSACTION;var e=PUMA.action.openTransaction(pumaConfig.HOSTNAME,P);PUMAWS.sendMessage(e)}}else A===PUMAWS["const"].WS_STATUS_CLOSED&&(a=_[0],R===pb.CMD_CONNECT?t[pb.CMD_CONNECT](E(pb.CMD_CONNECT,pb.ERR_PUMA_CONNECTION,"WS Cannot connect")):R===pb.CMD_DISCONNECT&&t[pb.CMD_DISCONNECT](E(pb.CMD_DISCONNECT,pb.SUCCESS,"WS disconnected")),t=Array())},pb.onMessage=function(o){if(n("pb.onMessage","Data: "+JSON.stringify(o,null,"   ")),a===_[1]&&R===pb.CMD_OPEN_TRANSACTION&&o.methodName.v===PUMA.action["const"].METHOD_OPEN_TRANSACTION&&(n("pb.onMessage","Result: "+o.data.v.code.v),0===o.pumaResult.v&&0===o.data.v.code.v?(a=_[2],P=o.data.v.data.v,t[pb.CMD_CONNECT](E(pb.CMD_CONNECT,pb.SUCCESS))):(t[pb.CMD_CONNECT](E(pb.CMD_CONNECT,pb.ERR_PUMA_CONNECTION,"Connection NOK: couldn't create transaction")),a=_[0],PUMAWS.close())),a===_[2]&&"com.dtg.puma.action.objects.PumaActionSubmitResult"===o.data.v.cl&&(n("pb.onMessage","Action Submitted PUMARESULT: "+o.pumaResult.v+" RETCODE: "+o.data.v.retCode.v),0!=o.pumaResult.v&&t[o.methodName.v](E(o.methodName.v,pb.PUMA_ERROR,o.data.v.description.v)),0!=o.data.v.retCode.v?t[o.methodName.v](E(o.methodName.v,pb.ACTION_ERROR,o.data.v.description.v)):A[o.methodName.v]=o.data.v.id.v),a===_[2]&&(o.methodName.v===pb.CMD_IDC_READCARD||o.methodName.v===pb.CMD_IDC_WAITFORTAKEN||o.methodName.v===pb.CMD_IDC_EJECTCARD)){var M=o.methodName.v;"com.dtg.puma.action.extend.result.PumaActionGetStringResult"===o.data.v.cl&&(0===o.pumaResult.v&&0!=o.data.v.retCode.v?t[M](E(M,o.data.v.retCode.v,o.data.v.description.v)):t[M](E(M,pb.SUCCESS,o.data.v.stringResult.v)),A[M]=null),"com.dtg.puma.action.objects.PumaActionResult"===o.data.v.cl&&(0===o.pumaResult.v&&0!=o.data.v.retCode.v?t[M](E(M,o.data.v.retCode.v,o.data.v.description.v)):t[M](E(M,pb.SUCCESS,o.data.v.retCode.v)),A[M]=null),"com.dtg.puma.action.objects.PumaActionEvent"===o.data.v.cl&&t[o.methodName.v](e(o.methodName.v,o.data.v.idStatus.v,o.data.v.objStatus.v))}if(a===_[2]&&o.methodName.v===pb.CMD_BCR_READBARCODE){var M=o.methodName.v;"com.dtg.puma.action.extend.result.PumaActionGetStringResult"===o.data.v.cl&&(0===o.pumaResult.v&&0!=o.data.v.retCode.v?t[M](E(M,o.data.v.retCode.v,o.data.v.description.v)):t[M](E(M,pb.SUCCESS,o.data.v.stringResult.v)),A[M]=null),"com.dtg.puma.action.objects.PumaActionEvent"===o.data.v.cl&&t[o.methodName.v](e(o.methodName.v,o.data.v.idStatus.v,o.data.v.objStatus.v))}if(a===_[2]&&o.methodName.v===pb.CMD_PIN_CREATEPINBLOCK){var M=o.methodName.v;"com.dtg.puma.action.extend.result.PumaActionGetStringResult"===o.data.v.cl&&(0===o.pumaResult.v&&0!=o.data.v.retCode.v?t[M](E(M,o.data.v.retCode.v,o.data.v.description.v)):t[M](E(M,pb.SUCCESS,o.data.v.stringResult.v)),A[M]=null),"com.dtg.puma.action.objects.PumaActionEvent"===o.data.v.cl&&t[o.methodName.v](e(o.methodName.v,o.data.v.idStatus.v,o.data.v.objStatus.v))}if(a===_[2]&&o.methodName.v===pb.CMD_PIN_IMPORTKEY){var M=o.methodName.v;"com.dtg.puma.action.extend.result.PumaActionGetByteArrayResult"===o.data.v.cl&&(0===o.pumaResult.v&&0!=o.data.v.retCode.v?t[M](E(M,o.data.v.retCode.v,o.data.v.description.v)):t[M](E(M,pb.SUCCESS,o.data.v.byteArrayResult.v)),A[M]=null),"com.dtg.puma.action.objects.PumaActionEvent"===o.data.v.cl&&t[o.methodName.v](e(o.methodName.v,o.data.v.idStatus.v,o.data.v.objStatus.v))}if(a===_[2]&&(o.methodName.v===pb.CMD_PTR_PRINTDOCUMENT||o.methodName.v===pb.CMD_PTR_CONTROLMEDIA||o.methodName.v===pb.CMD_PTR_WAITFORTAKEN)){var M=o.methodName.v;"com.dtg.puma.action.objects.PumaActionResult"===o.data.v.cl&&(0===o.pumaResult.v&&0!=o.data.v.retCode.v?t[M](E(M,o.data.v.retCode.v,o.data.v.description.v)):t[M](E(M,pb.SUCCESS,o.data.v.retCode.v)),A[M]=null),"com.dtg.puma.action.objects.PumaActionEvent"===o.data.v.cl&&t[o.methodName.v](e(o.methodName.v,o.data.v.idStatus.v,o.data.v.objStatus.v))}if(a===_[2]&&("com.dtg.puma.action.extend.result.PumaActionDeviceStatusResult"===o.data.v.cl||"com.dtg.puma.action.extend.result.PumaActionMediaStatusResult"===o.data.v.cl||"com.dtg.puma.action.extend.result.PumaActionPrinterStatusResult"===o.data.v.cl)){var M=o.methodName.v;if(0===o.pumaResult.v&&0!=o.data.v.retCode.v)t[M](E(M,o.data.v.retCode.v,o.data.v.description.v));else{var T={};o.data.v.deviceStatusCode&&(T.deviceStatus=o.data.v.deviceStatusCode.v),o.data.v.paperStatusCode&&(T.paperStatus=o.data.v.paperStatusCode.v),o.data.v.retractBinStatusCode&&(T.retractBinStatus=o.data.v.retractBinStatusCode.v),o.data.v.mediaStatusCode&&(T.mediaStatus=o.data.v.mediaStatusCode.v),t[M](E(M,pb.SUCCESS,T))}A[M]=null}a===_[2]&&R===pb.CMD_CLOSE_TRANSACTION&&o.methodName.v===PUMA.action["const"].METHOD_CLOSE_TRANSACTION&&(n("pb.onMessage","Message: "+JSON.stringify(o,null,"   ")),0===o.pumaResult.v&&0===o.data.v.code.v?(P=null,R=pb.CMD_DISCONNECT,PUMAWS.close()):(P=null,R=pb.CMD_DISCONNECT,PUMAWS.close()))}}();var pumaConfig=window.pumaConfig||{};!function(){var logger=!1;pumaConfig.logEnable=function(isEnabled){logger=isEnabled},pumaConfig.isLogEnabled=function(){return logger};var hostname=$(location).attr("hostname");hostname||(hostname="localhost"),pumaConfig.HOSTNAME="localhost",pumaConfig.IDC_DEVICE_NAME="IDC30",pumaConfig.PTR_DOC_DEVICE_NAME="PRR30",pumaConfig.PIN_DEVICE_NAME="PIN30",pumaConfig.BCR_DEVICE_NAME="BCR30"}(),angular.module("PumaService",[]).factory("PumaService",["$q",function($q){var timeoutFlag=!1;return{connect:function(){var deferred=$q.defer();return pb.connect(function(result){"RESULT"===result.type&&0===result.code?deferred.resolve(result):deferred.reject(result)}),deferred.promise},disconnect:function(){var deferred=$q.defer();return pb.disconnect(function(result){"RESULT"===result.type&&0===result.code?deferred.resolve(result):"EVENT"===result.type?deferred.notify(result):(result.isTimeout=timeoutFlag,deferred.reject(result))}),deferred.promise},readCard:function(){var deferred=$q.defer();return pb.readCard(function(result){"RESULT"===result.type&&0===result.code?deferred.resolve(result):"EVENT"===result.type?deferred.notify(result):(result.isTimeout=timeoutFlag,deferred.reject(result))}),deferred.promise},setTimeoutFlag:function(value){timeoutFlag=value},cancelReadCard:function(timeout){timeout&&(timeoutFlag=timeout),pb.cancelReadCard()},cancelReadNip:function(timeout){timeout&&(timeoutFlag=timeout),pb.cancelCreatePinBlock()},ejectCard:function(){var deferred=$q.defer();return pb.ejectCard(pb.IDC_CARD_EJECT,function(result){"RESULT"===result.type&&0===result.code?deferred.resolve(result):deferred.reject(result)}),deferred.promise},readNip:function(numT,onKey){var deferred=$q.defer();return pb.createPinBlock(4,4,!0,numT,0,pb.PIN_FORMANSI,"PinKey",function(result){"RESULT"===result.type&&0===result.code?deferred.resolve(result):"EVENT"===result.type?onKey(result):deferred.reject(result)}),deferred.promise},readBarcode:function(){var deferred=$q.defer();return pb.readBarcode(function(result){"RESULT"===result.type&&0===result.code?deferred.resolve(result):"EVENT"===result.type?onKey(result):deferred.reject(result)}),deferred.promise},cancelReadBarcode:function(){pb.cancelReadBarcode()}}}]),angular.module("SucursApps").factory("PrinterService",function($q,$timeout){var acrobatPath="C:\\Program Files\\Adobe\\Reader 10.0\\Reader\\AcroRd32.exe";return{printPDF:function(data){var fs=require("fs"),crypto=require("crypto"),tmpFileName="c:/print_tmp/file_"+crypto.randomBytes(4).readUInt32LE(0)+".pdf";console.log("Escribiendo archivo: "+tmpFileName),fs.writeFile(tmpFileName,data,"base64",function(err){return err?console.log(err):void $timeout(function(){console.log("Imprimiendo archivo: "+tmpFileName);var child_process=require("child_process"),process=child_process.spawn(acrobatPath,["/h","/p",tmpFileName],{encoding:"utf8",detached:!0,stdio:"ignore"});process.unref()},1e3)})}}}),angular.module("SucursApps").factory("SucursAppsDevices",function($q,$timeout,$http){var _service=function(pMethod,pUrl,pData,pHeader){var headers={"Content-Type":"application/json","Data-Type":"json"};return(void 0!=pHeader||null!=pHeader)&&(headers=getHeaderProperties(headers,pHeader)),$http({method:pMethod,url:pUrl,data:pData,withCredentials:!0,headers:headers})},get=function(pUrl,pHeader){return _service("GET",pUrl,null,pHeader)},getHeaderProperties=function(pHeader,pProps){for(var prop in pProps)pHeader[prop]=pProps[prop];return pHeader},checkDirectorySync=function(directory){try{var fs=require("fs");fs.statSync(directory)}catch(e){fs.mkdirSync(directory)}};return{getInstance:function(){var deferred=$q.defer();return deferred.resolve(this),deferred.promise},printPDF:function(data){var deferred=$q.defer(),fs=require("fs"),crypto=require("crypto"),path=(require("os"),require("path")),destDir="C:/Temp/";checkDirectorySync(destDir);var tmpFileName="file_"+crypto.randomBytes(4).readUInt32LE(0)+".pdf",tmpFilePath=path.join(destDir,tmpFileName);return console.log("Escribiendo archivo: "+tmpFilePath),fs.writeFile(tmpFilePath,data,"base64",function(err){return err?console.log(err):void $timeout(function(){get("http://localhost:8081/sucursappsdevices/printer/pdf?f="+tmpFileName).success(function(resp){deferred.resolve(resp)})["catch"](function(err){deferred.reject(err.data)}.bind(this))},1e3)}),deferred.promise},pinpadRead:function(data){var deferred=$q.defer();return get("http://localhost:8081/sucursappsdevices/pinpad/read").success(function(resp){return"NO_OK"===resp.res?void deferred.reject(resp):void deferred.resolve(resp)})["catch"](function(err){deferred.reject(err.data)}.bind(this)),deferred.promise}}}),angular.module("SucursApps").config(function($stateProvider){$stateProvider.state("mca",{parent:"site",url:"/mca","abstract":!0,data:{roles:["cliente"]},views:{"navbar@":{templateUrl:"scripts/components/navbar/navbar-mca.html",controller:"NavbarMcaController"}},resolve:{authorize:["Auth",function(Auth){return Auth.authorize()}]}})}),angular.module("SucursApps").config(function($stateProvider){$stateProvider.state("mca.menu",{parent:"mca",url:"/menu",data:{roles:["cliente"]},views:{"content@":{templateUrl:"scripts/app/mca/menu/mca-menu.html",controller:"McaMenuController"},"navbar@":{templateUrl:"scripts/components/navbar/navbar-mca-menu.html",controller:"NavbarMcaController"}}})}),angular.module("SucursApps").controller("McaMenuController",function($rootScope,$scope,$state,Principal){Principal.identity().then(function(account){$scope.account=account,$scope.isAuthenticated=Principal.isAuthenticated,$rootScope.currentFlow="mca"})}),angular.module("SucursApps").config(function($stateProvider){$stateProvider.state("mca.account",{parent:"mca",url:"/account",data:{roles:["cliente"]},views:{"content@":{templateUrl:"scripts/app/mca/account/account.html",controller:"McaAccountController"},"navbar@":{templateUrl:"scripts/components/navbar/navbar-mca-modal.html"}}}).state("mca.account.detail",{parent:"mca.account",url:"/detail",templateUrl:"scripts/app/mca/account/account-detail.html"})}),angular.module("SucursApps").controller("McaAccountController",["$scope","$state","Principal","McaDetalleCuentaService",function($scope,$state,Principal,McaDetalleCuentaService){Principal.identity().then(function(account){$scope.account=account,$scope.isAuthenticated=Principal.isAuthenticated,$scope.updateTransactions($scope.account_cicle)}),$scope.accountDetail=[],$scope.currentItem={},$scope.pageSize=8,$scope.currentPage=0,$scope.account_cicle=0,$scope.numberOfPages=function(){return $scope.accountDetail.movimientos?(console.log("Total movimientos: "+$scope.accountDetail.movimientos.length),Math.ceil($scope.accountDetail.movimientos.length/$scope.pageSize-1)):void 0},$scope.updateTransactions=function(account_cicle){McaDetalleCuentaService.getAccountDetail(account_cicle).then(function(data){$scope.accountDetail=data,$scope.errorMessage=null})["catch"](function(data){$scope.errorMessage=data.msg})}}]),angular.module("SucursApps").config(function($stateProvider){$stateProvider.state("mca.topup",{parent:"mca",url:"/topup",data:{roles:["cliente"]},views:{"content@":{templateUrl:"scripts/app/mca/topup/topup.html",controller:"McaTopUpController"},"navbar@":{templateUrl:"scripts/components/navbar/navbar-mca-modal.html"}}}).state("mca.topup.init",{parent:"mca.topup",url:"/init",templateUrl:"scripts/app/mca/topup/topup-init.html"}).state("mca.topup.finish",{parent:"mca.topup",url:"/finish",templateUrl:"scripts/app/mca/topup/topup-finish.html"})}),angular.module("SucursApps").controller("McaTopUpController",function($rootScope,$scope,$state,Principal,Auth,McaTopupService,McaDetalleCuentaService){$scope.disableSubmit=!1,$scope.freq=[],$scope.main=[],$scope.command={},$scope.amount=0,$scope.topupSelected={},$scope.onSiguiente01=function(){$scope.command.code=null,$("#confirmModal").modal()},$scope.onProcessTransfer=function(){McaTopupService.doCompraTA($scope.command).then(function(data){$scope.disableSubmit=!1,$scope.confirmation=data,$state.go("mca.topup.finish")})["catch"](function(data){$scope.disableSubmit=!1,$scope.errorMessage=data.CHRmu,$("#modalErrorMessage").modal("show")})},$scope.onCarrierClick=function(carrier,$event){var container=$($event.currentTarget).closest(".carrier-list");container.find(".selected-sumando").removeClass("selected-sumando"),$($event.currentTarget).parent().addClass("selected-sumando"),$scope.command.topupSelected=carrier,McaTopupService.getImportesByEmpresa(carrier.idCatEmpresa).then(function(data){$scope.amounts=data.catImporteType})},$scope.onMontoClick=function(amount,$event){var container=$($event.currentTarget).closest(".amount-list");container.find(".btn-carrier").removeClass("carrier-amount-select").removeClass("carrier-amount-not-select"),container.find(".btn-carrier").addClass("carrier-amount-not-select"),$($event.currentTarget).removeClass("carrier-amount-not-select").addClass("carrier-amount-select"),$scope.command.amount=amount},$scope.findCarrierById=function(id){if(void 0!==id)for(var i=0;i<$scope.carriers.length;i++)if($scope.carriers[i].vkey===id)return $scope.carriers[i]},$scope.logout=function(){Auth.logout(),$state.go("home")},Principal.identity().then(function(account){$scope.account=account,$scope.isAuthenticated=Principal.isAuthenticated,$("#modalBXINotificacionComprobante").modal("show"),McaDetalleCuentaService.getAccount().then(function(data){$scope.command.datosPersonales=data.datosPersonales,$scope.command.consultaSaldosBXI=data.consultaSaldosBXI}),McaTopupService.getEmpresas().then(function(data){$scope.carriers=data})})}),angular.module("SucursApps").config(function($stateProvider){$stateProvider.state("mca.transfer",{parent:"mca",url:"/transfer",views:{"navbar@":{templateUrl:"scripts/components/navbar/navbar-mca-modal.html"}}})}),angular.module("SucursApps").config(function($stateProvider){$stateProvider.state("mca.transfer.spei",{parent:"mca.transfer",url:"/third",data:{roles:["cliente"]},views:{"content@":{templateUrl:"scripts/app/mca/transfer/spei/spei.html",controller:"McaTransferSpeiController"}}}).state("mca.transfer.spei.init",{parent:"mca.transfer.spei",url:"/init",templateUrl:"scripts/app/mca/transfer/spei/spei-init.html"}).state("mca.transfer.spei.finish",{parent:"mca.transfer.spei",url:"/finish",templateUrl:"scripts/app/mca/transfer/spei/spei-finish.html"})}),angular.module("SucursApps").controller("McaTransferSpeiController",function($rootScope,$scope,$state,Auth,Principal,SessionService,McaDetalleCuentaService,McaTransferService){$scope.disableSubmit=!1,$scope.command={},$scope.listBancos={},$scope.onProcessTransfer=function(){$scope.disableSubmit=!0,McaTransferService.doTransferSPEI($scope.command,$scope.ACCOUNT_TYPE).then(function(data){$scope.disableSubmit=!1,$scope.confirmation=data,$state.go("mca.transfer.spei.finish")})["catch"](function(data){$scope.disableSubmit=!1,$scope.errorMessage=data.CHRmu,$("#modalErrorMessage").modal("show")})},$scope.onSiguiente01=function(){$("#confirmModal").modal()},$scope.logout=function(){Auth.logout(),$state.go("home")},Principal.identity().then(function(account){$scope.account=account,$scope.isAuthenticated=Principal.isAuthenticated,$("#modalBXINotificacionComprobante").modal("show"),McaDetalleCuentaService.getAccount().then(function(data){$scope.command.datosPersonales=data.datosPersonales,$scope.command.consultaSaldosBXI=data.consultaSaldosBXI}),McaTransferService.getBancos().then(function(data){$scope.listBancos=data})})}),angular.module("SucursApps").config(function($stateProvider){$stateProvider.state("mca.transfer.third",{parent:"mca.transfer",url:"/third",data:{roles:["cliente"]},views:{"content@":{templateUrl:"scripts/app/mca/transfer/third/third.html",controller:"McaTransferThirdController"}}}).state("mca.transfer.third.init",{parent:"mca.transfer.third",url:"/init",templateUrl:"scripts/app/mca/transfer/third/third-init.html"}).state("mca.transfer.third.finish",{parent:"mca.transfer.third",url:"/finish",templateUrl:"scripts/app/mca/transfer/third/third-finish.html"})}),angular.module("SucursApps").controller("McaTransferThirdController",function($rootScope,$scope,$state,Auth,Principal,SessionService,McaDetalleCuentaService,McaTransferService){$scope.disableSubmit=!1,$scope.command={},$scope.onProcessTransfer=function(){$scope.disableSubmit=!0,McaTransferService.doTransferThird($scope.command,$scope.ACCOUNT_TYPE).then(function(data){$scope.disableSubmit=!1,$scope.confirmation=data,$state.go("mca.transfer.third.finish")})["catch"](function(data){$scope.disableSubmit=!1,$scope.errorMessage=data.CHRmu,$("#modalErrorMessage").modal("show")})},$scope.onSiguiente01=function(sender){$("#confirmModal").modal()},$scope.logout=function(){Auth.logout(),$state.go("home")},Principal.identity().then(function(account){$scope.account=account,$scope.isAuthenticated=Principal.isAuthenticated,$("#modalBXINotificacionComprobante").modal("show"),McaDetalleCuentaService.getAccount().then(function(data){$scope.command.datosPersonales=data.datosPersonales,$scope.command.consultaSaldosBXI=data.consultaSaldosBXI})})}),angular.module("SucursApps").config(function($stateProvider){$stateProvider.state("mca.payment",{parent:"mca",url:"/payment",views:{"navbar@":{templateUrl:"scripts/components/navbar/navbar-mca-modal.html"}}})}),angular.module("SucursApps").config(function($stateProvider){$stateProvider.state("mca.payment.cc",{parent:"mca.payment",url:"/cc",data:{roles:["cliente"]},views:{"content@":{templateUrl:"scripts/app/mca/payment/cc/payment-cc.html",controller:"McaPaymentCCController"}}}).state("mca.payment.cc.init",{parent:"mca.payment.cc",url:"/init",templateUrl:"scripts/app/mca/payment/cc/payment-cc-init.html"}).state("mca.payment.cc.finish",{parent:"mca.payment.cc",url:"/finish",templateUrl:"scripts/app/mca/payment/cc/payment-cc-finish.html"})}),angular.module("SucursApps").controller("McaPaymentCCController",function($rootScope,$scope,$state,Auth,Principal,SessionService,McaPaymentService,McaDetalleCuentaService){$scope.disableSubmit=!1,$scope.command={},$scope.listBancos={},$scope.onProcessTransfer=function(){$scope.disableSubmit=!0,McaPaymentService.doPaymentCC($scope.command).then(function(data){$scope.disableSubmit=!1,$scope.confirmation=data,$state.go("mca.payment.cc.finish")})["catch"](function(data){$scope.disableSubmit=!1,$scope.errorMessage=data.CHRmu,$("#modalErrorMessage").modal("show")})},$scope.onSiguiente01=function(){$("#confirmModal").modal()},$scope.logout=function(){Auth.logout(),$state.go("home")},Principal.identity().then(function(account){$scope.account=account,$scope.isAuthenticated=Principal.isAuthenticated,$("#modalBXINotificacionComprobante").modal("show"),McaDetalleCuentaService.getAccount().then(function(data){$scope.command.datosPersonales=data.datosPersonales,$scope.command.consultaSaldosBXI=data.consultaSaldosBXI})})}),angular.module("SucursApps").config(function($stateProvider){$stateProvider.state("mca.payment.service",{parent:"mca.payment",url:"/service",data:{roles:["cliente"]},views:{"content@":{templateUrl:"scripts/app/mca/payment/service/payment-service.html",controller:"McaPaymentServiceController"}}}).state("mca.payment.service.init",{parent:"mca.payment.service",url:"/init",templateUrl:"scripts/app/mca/payment/service/payment-service-init.html"}).state("mca.payment.service.detail",{parent:"mca.payment.service",url:"/detail",templateUrl:"scripts/app/mca/payment/service/payment-service-detail.html"}).state("mca.payment.service.detail_rc03",{parent:"mca.payment.service",url:"/detailrc3",templateUrl:"scripts/app/mca/payment/service/payment-service-detail-rc03.html"}).state("mca.payment.service.finish",{parent:"mca.payment.service",url:"/finish",templateUrl:"scripts/app/mca/payment/service/payment-service-finish.html"}).state("mca.payment.service.finish_rc03",{parent:"mca.payment.service",url:"/finishrc3",templateUrl:"scripts/app/mca/payment/service/payment-service-finish-rc03.html"})}),angular.module("SucursApps").controller("McaPaymentServiceController",function($rootScope,$scope,$state,Auth,Principal,McaPaymentService,McaDetalleCuentaService){$scope.command={},$scope.facturadores={},$scope.facturadores_list=[],$scope.disableSubmit=!1,$scope.onSiguiente01=function(){var payeeFound=$scope.facturadores.filter(function(payee){return payee.descripcion.concat(" - ").concat(payee.idFacturador)===$scope.command.payeeSelected});0===payeeFound.length&&($scope.errorMessage="No ha especificado un servicio correctamente",$("#modalErrorMessage").modal("show")),$scope.command.payee=payeeFound[0],1310===payeeFound[0].idFacturador||88924===payeeFound[0].idFacturador?McaPaymentService.getPayeeDetailRC03($scope.command.payee.idFacturador).then(function(data){$scope.payeeDetail=data,$state.go("mca.payment.service.detail_rc03")})["catch"](function(data){$scope.errorMessage=data.CHRmu,$("#modalErrorMessage").modal("show")}):McaPaymentService.getPayeeDetail($scope.command.payee.idFacturador).then(function(data){$scope.payee_detail=data,
$state.go("mca.payment.service.detail")})["catch"](function(data){$scope.errorMessage=data.CHRmu,$("#modalErrorMessage").modal("show")})},$scope.logout=function(){Auth.logout(),$state.go("home")},$scope.onValidatePayment=function(){$scope.disableSubmit=!0,McaPaymentService.validate($scope.command).then(function(data){$scope.disableSubmit=!1,$scope.validation=data,$("#confirmModal").modal("show")})["catch"](function(data){$scope.disableSubmit=!1,$scope.errorMessage=data.CHRmu,$("#modalErrorMessage").modal("show")})},$scope.onValidatePaymentRC03=function(){$scope.disableSubmit=!0,McaPaymentService.validateRC03($scope.command).then(function(data){$scope.disableSubmit=!1,$scope.validation=data,$("#confirmModal").modal("show")})["catch"](function(data){$scope.disableSubmit=!1,$scope.errorMessage=data.CHRmu,$("#modalErrorMessage").modal("show")})},$scope.onProcessPayment=function(){$scope.disableSubmit=!0,McaPaymentService.payment($scope.command).then(function(data){$scope.disableSubmit=!1,$scope.confirmation=data,$state.go("mca.payment.service.finish")})["catch"](function(data){$scope.disableSubmit=!1,$scope.errorMessage=data.CHRmu,$("#modalErrorMessage").modal("show")})},$scope.onProcessPaymentRC03=function(){$scope.disableSubmit=!0,McaPaymentService.paymentRC03($scope.command).then(function(data){$scope.disableSubmit=!1,$scope.confirmation=data,$state.go("mca.payment.service.finish_rc03")})["catch"](function(data){$scope.disableSubmit=!1,$scope.errorMessage=data.CHRmu,$("#modalErrorMessage").modal("show")})},Principal.identity().then(function(account){$scope.account=account,$scope.isAuthenticated=Principal.isAuthenticated,$("#modalBXINotificacionComprobante").modal("show"),McaDetalleCuentaService.getAccount().then(function(data){$scope.command.datosPersonales=data.datosPersonales,$scope.command.consultaSaldosBXI=data.consultaSaldosBXI}),McaPaymentService.getPayees().then(function(data){$scope.facturadores=data.facturadores,angular.forEach($scope.facturadores,function(value){this.push(value.descripcion.concat(" - ").concat(value.idFacturador))},$scope.facturadores_list)})})}).directive("payeeLogo",function($q,$compile){return{restrict:"A",link:function(scope,element,attrs){attrs.$observe("ngSrc",function(ngSrc){var deferred=$q.defer(),image=new Image;return image.onerror=function(){deferred.resolve(!1),element[0].outerHTML="<h3>"+attrs.alt+"</h3>",$compile(element.contents())(scope)},image.onload=function(){deferred.resolve(!0)},image.src=ngSrc,deferred.promise})}}}),angular.module("SucursApps").config(function($stateProvider){$stateProvider.state("mca.cec",{parent:"mca",url:"/cec",data:{roles:["cliente"]},views:{"content@":{templateUrl:"scripts/app/mca/shared/template.html",controller:"McaCecController"},"navbar@":{templateUrl:"scripts/components/navbar/navbar-mca-modal.html"}},resolve:{DevicesServices:["SucursAppsDevices",function(SucursAppsDevices){return SucursAppsDevices.getInstance()}]}}).state("mca.cec.home",{parent:"mca.cec",url:"/home",templateUrl:"scripts/app/mca/cec/mca-cec-home.html"}).state("mca.cec.wait",{parent:"mca.cec",url:"/wait",templateUrl:"scripts/app/mca/cec/mca-cec-wait.html"}).state("mca.cec.finish",{parent:"mca.cec",url:"/finish",templateUrl:"scripts/app/mca/cec/mca-cec-finish.html"}).state("mca.cec.email",{parent:"mca.cec",url:"/email",templateUrl:"scripts/app/mca/cec/mca-cec-email.html"}).state("mca.cec.sent",{parent:"mca.cec",url:"/sent",templateUrl:"scripts/app/mca/cec/mca-cec-sent.html"})}),angular.module("SucursApps").controller("McaCecController",["$scope","$state","$filter","$timeout","Auth","Principal","McaEstadoCuentaService","DevicesServices",function($scope,$state,$filter,$timeout,Auth,Principal,McaEstadoCuentaService,DevicesServices){$scope.monthsResume=[],$scope.itemsSelected=[],$scope.command={},$scope.ipcRenderer={},$scope.documentosDisponibles=[],$scope.mensajeError="",Principal.identity().then(function(account){$scope.account=account,$scope.isAuthenticated=Principal.isAuthenticated,$scope.monthList=$scope.getMonths(),McaEstadoCuentaService.obtenerListaDocumentos($scope.command).then(function(data){console.log(data),$scope.documentosDisponibles=$filter("orderBy")(data.listaProductos,"-Fecha")}),"undefined"!=typeof require&&($scope.ipcRenderer=require("electron").ipcRenderer)}),$scope.viewImprimirClick=function(){$timeout(function(){$state.go("mca.cec.wait"),McaEstadoCuentaService.obtenerDocumentos($scope.itemsSelected).then(function(data){var totalPaginas=0;if(angular.forEach(data,function(value,key){totalPaginas+=value.documentPages}),totalPaginas>=10)return $scope.errorMessage="El maximo de paginas permitidas para la impresion fue excedido",void $("#modalErrorMessage").modal("show");for(var i=0;i<data.length;i++)DevicesServices.printPDF(data[i].documento).then(function(){$state.go("mca.cec.finish")})})["catch"](function(err){$scope.errorMessage=data.CHRmu,$("#modalErrorMessage").modal("show")})},500)},$scope.viewEnviarCorreoClick=function(){$state.go("mca.cec.email")},$scope.onEnviarCorreoClick=function(){$state.go("mca.cec.wait"),$timeout(function(){McaEstadoCuentaService.enviaDocumentos($scope.itemsSelected,$scope.command).then(function(data){console.log(data),$state.go("mca.cec.sent")})["catch"](function(err){$scope.mensajeError="Hubo un problema al enviar el correo",$state.go("mca.cec.error")})},500)},$scope.logout=function(){Auth.logout(),$state.go("home")},$scope.range=function(n){return new Array(n)},$scope.onPeriodoItemClick=function(value,$event){if(-1===$scope.itemsSelected.indexOf(value.Fecha)){if($scope.itemsSelected.length>=3)return $scope.errorMessage="Solo es posible seleccionar 3 periodos",void $("#modalErrorMessage").modal("show");$scope.itemsSelected.push(value.Fecha),angular.element($event.currentTarget).addClass("selected")}else $scope.itemsSelected.splice($scope.itemsSelected.indexOf(value.Fecha),1),angular.element($event.currentTarget).removeClass("selected")},$scope.getMonths=function(){for(var date=new Date,months=[],monthNames=["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"],i=11;i>=0;i--)months.push({title:monthNames[date.getMonth()]+" "+date.getFullYear(),value:i}),date.setMonth(date.getMonth()-1);return months}}]).filter("etiquetaMes",function(){return function(value){var currDate=new Date(value),monthNames=["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"];return monthNames[currDate.getMonth()]+" "+currDate.getFullYear()}}).filter("reverse",function(){return function(items){return items.slice().reverse()}}),angular.module("SucursApps").controller("NavbarMcaController",function($scope,$location,$state,Auth,Principal){$scope.isAuthenticated=Principal.isAuthenticated,$scope.account=Principal.identity(),$scope.$state=$state,$scope.logout=function(){Auth.logout(),$state.go("home")}}),angular.module("SucursApps").config(function($stateProvider){$stateProvider.state("kiosk",{parent:"site",url:"/kiosk","abstract":!0,data:{roles:[]},views:{"navbar@":{templateUrl:"scripts/components/navbar/navbar-kiosk.html"},"fullscreen@":{templateUrl:"scripts/app/kiosk/kiosk.html",controller:"KioskController"}}}).state("kiosk.home",{parent:"kiosk",url:"/home",data:{roles:[]},templateUrl:"scripts/app/kiosk/kiosk-home.html"}).state("kiosk.pts",{parent:"kiosk",url:"/pts",data:{roles:[]},templateUrl:"scripts/app/kiosk/kiosk-pts.html"}).state("kiosk.read_card",{parent:"kiosk",url:"/read_card",data:{roles:[]},templateUrl:"scripts/app/kiosk/kiosk-read-card.html"}).state("kiosk.nip",{parent:"kiosk",url:"/nip",data:{roles:[]},templateUrl:"scripts/app/kiosk/kiosk-nip.html"}).state("kiosk.nip_error",{parent:"kiosk",url:"/nip_error",data:{roles:[]},templateUrl:"scripts/app/kiosk/kiosk-nip-error.html"}).state("kiosk.timeout",{parent:"kiosk",url:"/timeout",data:{roles:[]},templateUrl:"scripts/app/kiosk/kiosk-timeout.html"}).state("kiosk.wait",{parent:"kiosk",url:"/wait",data:{roles:[]},templateUrl:"scripts/app/kiosk/kiosk-wait.html"}).state("kiosk.error",{parent:"kiosk",url:"/error",data:{roles:[]},templateUrl:"scripts/app/kiosk/kiosk-error.html"}).state("kiosk.blocked",{parent:"kiosk",url:"/blocked",data:{roles:[]},templateUrl:"scripts/app/kiosk/kiosk-nip-blocked.html"}).state("kiosk.finish",{parent:"kiosk",url:"/finish",data:{roles:[]},templateUrl:"scripts/app/kiosk/kiosk-finish.html"})}),angular.module("SucursApps").controller("KioskController",function($rootScope,$scope,$q,$state,$timeout,Auth,Principal,SessionService){$scope.user={},$scope.errors={},$scope.errorMessage=null,$scope.command={},$scope.view_usr=!0,$scope.view_pass=!1,$scope.nipMessage="Ingresa tu NIP",$scope.showNipCasillas=!1,$scope.onNipSiguienteClick=function(){},$scope.onConsultarSaldoClick=function(){$scope.nipErrorConteo=0,$state.go("kiosk.read_card"),$scope.iniciarSesion("kiosk.cs.home")},$scope.casilla_01="assets/images/k_ast_01.png",$scope.casilla_02="assets/images/k_ast_01.png",$scope.casilla_03="assets/images/k_ast_01.png",$scope.casilla_04="assets/images/k_ast_01.png",$scope.np_arr=[],$scope.updateNipCeldas=function(data){"*"===data&&$scope.np_arr.push(!0),4096===data&&$scope.np_arr.pop(),0===$scope.np_arr.length?($("#casilla_01").attr("src","assets/images/k_ast_01.png"),$("#casilla_02").attr("src","assets/images/k_ast_01.png"),$("#casilla_03").attr("src","assets/images/k_ast_01.png"),$("#casilla_04").attr("src","assets/images/k_ast_01.png")):1===$scope.np_arr.length?($("#casilla_01").attr("src","assets/images/k_ast_02.png"),$("#casilla_02").attr("src","assets/images/k_ast_01.png"),$("#casilla_03").attr("src","assets/images/k_ast_01.png"),$("#casilla_04").attr("src","assets/images/k_ast_01.png")):2===$scope.np_arr.length?($("#casilla_01").attr("src","assets/images/k_ast_02.png"),$("#casilla_02").attr("src","assets/images/k_ast_02.png"),$("#casilla_03").attr("src","assets/images/k_ast_01.png"),$("#casilla_04").attr("src","assets/images/k_ast_01.png")):3===$scope.np_arr.length?($("#casilla_01").attr("src","assets/images/k_ast_02.png"),$("#casilla_02").attr("src","assets/images/k_ast_02.png"),$("#casilla_03").attr("src","assets/images/k_ast_02.png"),$("#casilla_04").attr("src","assets/images/k_ast_01.png")):4===$scope.np_arr.length&&($("#casilla_01").attr("src","assets/images/k_ast_02.png"),$("#casilla_02").attr("src","assets/images/k_ast_02.png"),$("#casilla_03").attr("src","assets/images/k_ast_02.png"),$("#casilla_04").attr("src","assets/images/k_ast_02.png"))},$scope.nipErrorConteo=0,$scope.iniciarSesion=function(forward){Auth.loginWincor(function(event){$scope.np_arr=[],$state.go("kiosk.nip")},function(result){$scope.updateNipCeldas(result.data)},function(){$state.go("kiosk.wait")}).then(function(data){$scope.nipErrorConteo=0,$scope.nipMessage="Ingresa tu NIP",$scope.errorMessage=null,$scope.userData=data,$state.go(forward)})["catch"](function(err){err&&"NUMERO DE NIP INVALIDO"===err.CHRmu?($scope.nipErrorConteo=$scope.nipErrorConteo+1,$scope.nipErrorConteo<3?$timeout(function(){$scope.nipMessage="NIP invalido, captura de nuevo tu NIP",$scope.np_arr=[],$scope.iniciarSesion(forward)},2e3):($scope.nipErrorConteo=0,$scope.np_arr=[],$scope.nipMessage="Ingresa tu NIP",$scope.mensajeError="Limite de intentos",$state.go("kiosk.error"),$timeout(function(){$state.go("kiosk.home")},5e3))):err&&err.isTimeout?($scope.mensajeError="El tiempo de espera ha finalizado",$state.go("kiosk.timeout"),$timeout(function(){$state.go("kiosk.home")},5e3)):err&&-4===err.code?($scope.mensajeError="Se ha cancelado la operacion",$state.go("kiosk.error"),$timeout(function(){$state.go("kiosk.home")},5e3)):(console.log(err),$scope.mensajeError="El servicio no esta disponible por el momento",$state.go("kiosk.error"),$timeout(function(){$state.go("kiosk.home")},5e3))})},$scope.onReadCardCancel=function(){Auth.cancelLoginWincor()},$scope.onCancelPinBlock=function(){Auth.cancelPinBlock()},$scope.onConsultarEstadoCuentaClick=function(){$scope.nipErrorConteo=0,$state.go("kiosk.read_card"),$scope.iniciarSesion("kiosk.cec.home")},$scope.onTransferenciaClick=function(){$scope.nipErrorConteo=0,$state.go("kiosk.read_card"),$scope.iniciarSesion("kiosk.trans.home")},$scope.onMantenimientoCuentasClick=function(){$("#modalProximamente").modal()},$scope.soon=function(){$("#modalProximamente").modal()},$scope.onInit=function(){$rootScope.currentFlow="kiosk"},$scope.onInit()}),angular.module("SucursApps").config(function($stateProvider){$stateProvider.state("kiosk.cec",{parent:"kiosk",url:"/cec",data:{roles:["cliente"]},views:{"fullscreen@":{templateUrl:"scripts/app/kiosk/cec/kiosk-cec.html",controller:"KioskCecController"},"navbar@":{templateUrl:"scripts/components/navbar/navbar-kiosk-logged.html",controller:"NavbarKioskController"}},resolve:{authorize:["Auth",function(Auth){return Auth.authorize(void 0,"kiosk.home")}]}}).state("kiosk.cec.home",{parent:"kiosk.cec",url:"/home",templateUrl:"scripts/app/kiosk/cec/kiosk-cec-home.html"}).state("kiosk.cec.wait",{parent:"kiosk.cec",url:"/wait",templateUrl:"scripts/app/kiosk/cec/kiosk-cec-wait.html"}).state("kiosk.cec.email",{parent:"kiosk.cec",url:"/wait",templateUrl:"scripts/app/kiosk/cec/kiosk-cec-email.html"}).state("kiosk.cec.error",{parent:"kiosk.cec",url:"/error",templateUrl:"scripts/app/kiosk/kiosk-trans-error.html"}).state("kiosk.cec.ok",{parent:"kiosk.cec",url:"/ok",templateUrl:"scripts/app/kiosk/kiosk-trans-ok.html"})}),angular.module("SucursApps").controller("KioskCecController",function($rootScope,$scope,$state,$timeout,$filter,Principal,McaDetalleCuentaService,Auth,McaEstadoCuentaService,PrinterService){$scope.monthsResume=[],$scope.itemsSelected=[],$scope.command={},$scope.ipcRenderer={},$scope.documentosDisponibles=[],$scope.mensajeError="",Principal.identity().then(function(account){$scope.account=account,$scope.isAuthenticated=Principal.isAuthenticated,$scope.monthList=$scope.getMonths(),McaEstadoCuentaService.obtenerListaDocumentos($scope.command).then(function(data){console.log(data),$scope.documentosDisponibles=$filter("orderBy")(data.listaProductos,"-Fecha")}),"undefined"!=typeof require&&($scope.ipcRenderer=require("electron").ipcRenderer)}),$scope.onLogout=function(){Auth.logout(),$state.go("kiosk.finish")},$scope.onPagar=function(){},$scope.viewImprimirClick=function(){$state.go("kiosk.cec.wait"),$timeout(function(){McaEstadoCuentaService.obtenerDocumentos($scope.itemsSelected).then(function(data){console.log(data),console.log("Imprimiendo documentos...");for(var i=0;i<data.length;i++)PrinterService.printPDF(data[i].documento);$state.go("kiosk.cec.ok")})["catch"](function(err){console.error(err),$scope.mensajeError="Hubo un problema al imprimir",$state.go("kiosk.cec.error")})},500)},$scope.viewEnviarCorreoClick=function(){$state.go("kiosk.cec.email")},$scope.onEnviarCorreoClick=function(){$state.go("kiosk.cec.wait"),$timeout(function(){McaEstadoCuentaService.enviaDocumentos($scope.itemsSelected,$scope.command).then(function(data){console.log(data),$state.go("kiosk.cec.ok")})["catch"](function(err){console.err(err),$scope.mensajeError="Hubo un problema al enviar el correo",$state.go("kiosk.cec.error")})},500)},$scope.range=function(n){return new Array(n)},$scope.onPeriodoItemClick=function(value,$event){if(-1===$scope.itemsSelected.indexOf(value.Fecha)){if($scope.itemsSelected.length>=3)return $scope.errorMessage="Solo es posible seleccionar 3 periodos",void $("#modalErrorMessage").modal("show");$scope.itemsSelected.push(value.Fecha),angular.element($event.currentTarget).addClass("selected")}else $scope.itemsSelected.splice($scope.itemsSelected.indexOf(value.Fecha),1),angular.element($event.currentTarget).removeClass("selected")},$scope.getMonths=function(){for(var date=new Date,months=[],monthNames=["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"],i=11;i>=0;i--)months.push({title:monthNames[date.getMonth()]+" "+date.getFullYear(),value:i}),date.setMonth(date.getMonth()-1);return months}}).filter("etiquetaMes",function(){return function(value){var currDate=new Date(value),monthNames=["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"];return monthNames[currDate.getMonth()]+" "+currDate.getFullYear()}}).filter("reverse",function(){return function(items){return items.slice().reverse()}}),angular.module("SucursApps").config(function($stateProvider){$stateProvider.state("kiosk.cs",{parent:"kiosk",url:"/cs",data:{roles:["cliente"]},views:{"fullscreen@":{templateUrl:"scripts/app/kiosk/cs/kiosk-cs.html",controller:"KioskCsController"},"navbar@":{templateUrl:"scripts/components/navbar/navbar-kiosk-logged.html",controller:"NavbarKioskController"}},resolve:{authorize:["Auth",function(Auth){return Auth.authorize(void 0,"kiosk.home")}]}}).state("kiosk.cs.home",{parent:"kiosk.cs",url:"/home",templateUrl:"scripts/app/kiosk/cs/kiosk-cs-home.html"}).state("kiosk.cs.wait",{parent:"kiosk.cs",url:"/wait",templateUrl:"scripts/app/kiosk/cs/kiosk-cs-wait.html"}).state("kiosk.cs.ok",{parent:"kiosk.cs",url:"/ok",templateUrl:"scripts/app/kiosk/kiosk-trans-ok.html"}).state("kiosk.cs.error",{parent:"kiosk.cs",url:"/error",templateUrl:"scripts/app/kiosk/kiosk-trans-error.html"})}),angular.module("SucursApps").controller("KioskCsController",function($rootScope,$scope,$state,$timeout,Principal,McaDetalleCuentaService,Auth){$scope.monthsResume=[],$scope.itemsSelected=[],$scope.mensajeError="",$scope.onLogout=function(){Auth.logout(),$state.go("kiosk.finish")},$scope.viewImprimirClick=function(){$state.go("kiosk.cs.wait"),$timeout(function(){$scope.mensajeError="Hubo un problema al imprimir",$state.go("kiosk.cs.error")},3e3)},$scope.onLogout=function(){Auth.logout(),$state.go("kiosk.finish")},Principal.identity().then(function(account){$scope.account=account,$scope.isAuthenticated=Principal.isAuthenticated})}),angular.module("SucursApps").config(function($stateProvider){$stateProvider.state("kiosk.payee",{parent:"kiosk",url:"/payee",data:{roles:["cliente"]},views:{"fullscreen@":{templateUrl:"scripts/app/kiosk/payee/kiosk-payee.html",controller:"KioskPayeeController"},"navbar@":{templateUrl:"scripts/components/navbar/navbar-kiosk.html"}}}).state("kiosk.payee.home",{parent:"kiosk.payee",url:"/home",templateUrl:"scripts/app/kiosk/payee/kiosk-payee-home.html"}).state("kiosk.payee.search",{parent:"kiosk.payee",url:"/search",templateUrl:"scripts/app/kiosk/payee/kiosk-payee-search.html"}).state("kiosk.payee.detail",{parent:"kiosk.payee",url:"/detail",templateUrl:"scripts/app/kiosk/payee/kiosk-payee-detail.html"}).state("kiosk.payee.detail_telmex",{parent:"kiosk.payee",url:"/detail_telmex",templateUrl:"scripts/app/kiosk/payee/kiosk-payee-detail-telmex.html"}).state("kiosk.payee.detail_cfe",{parent:"kiosk.payee",url:"/detail_cfe",templateUrl:"scripts/app/kiosk/payee/kiosk-payee-detail-cfe.html"}).state("kiosk.payee.confirm",{parent:"kiosk.payee",url:"/confirm",templateUrl:"scripts/app/kiosk/payee/kiosk-payee-confirm.html"}).state("kiosk.payee.trans_ok",{parent:"kiosk.payee",url:"/ok",templateUrl:"scripts/app/kiosk/kiosk-trans-ok.html"}).state("kiosk.payee.trans_error",{parent:"kiosk.payee",url:"/ok",templateUrl:"scripts/app/kiosk/kiosk-trans-error.html"}).state("kiosk.payee.read_card",{parent:"kiosk.payee",url:"/read_card",templateUrl:"scripts/app/kiosk/kiosk-read-card.html"}).state("kiosk.payee.nip",{parent:"kiosk.payee",url:"/nip",templateUrl:"scripts/app/kiosk/kiosk-nip.html"}).state("kiosk.payee.nip_error",{parent:"kiosk.payee",url:"/nip_error",templateUrl:"scripts/app/kiosk/kiosk-nip-error.html"}).state("kiosk.payee.wait",{parent:"kiosk.payee",url:"/wait",templateUrl:"scripts/app/kiosk/kiosk-wait.html"}).state("kiosk.payee.error",{parent:"kiosk.payee",url:"/error",templateUrl:"scripts/app/kiosk/kiosk-error.html"}).state("kiosk.payee.blocked",{parent:"kiosk.payee",url:"/blocked",templateUrl:"scripts/app/kiosk/kiosk-nip-blocked.html"})}),angular.module("SucursApps").controller("KioskPayeeController",function($rootScope,$scope,$state,$timeout,Principal,McaPaymentService,Auth,PumaService,ID_TELMEX,ID_CFE,$filter){$scope.command={},$scope.payee_list_found=[],$scope.payee_list=[],$scope.payee_search=null,$scope.payee_detail=[],$scope.payeeDetail=[],$scope.validation={},$scope.account={},$scope.pageSize=6,$scope.currentPage=0,$scope.mensajeError="",$scope.numberOfPages=function(){return $scope.payee_list?Math.ceil($scope.payee_list.length/$scope.pageSize-1):void 0},$scope.onPayeeSearchChange=function(scope){$scope.payee_search=scope.payee_search,console.log("Search payee: "+scope.payee_search),scope.payee_search?McaPaymentService.getPayeesKiosk(scope.payee_search).then(function(data){$scope.payee_list=data.facturadores}):McaPaymentService.getPayeesFavoritos().then(function(data){$scope.payee_list=data.facturadores})},$scope.onPayeeClick=function(item){$scope.command.payee=item,$scope.command.payee.idFacturador==ID_TELMEX?McaPaymentService.getPayeeDetailRC03Kiosk($scope.command.payee.idFacturador).then(function(data){$scope.payeeDetail=data,$state.go("kiosk.pts.detail_telmex"),PumaService.connect().then(function(){return PumaService.readBarcode()}).then(function(result){console.log("Read Barcode result: "+result),$scope.command.ref=result.data.substring(0,10),$scope.command.amount=(result.data.substr(10,9)/100).toFixed(2)})["finally"](function(){PumaService.disconnect()})})["catch"](function(data){$scope.errorMessage=data.CHRmu,$("#modalErrorMessage").modal("show")}):$scope.command.payee.idFacturador==ID_CFE?McaPaymentService.getPayeeDetailRC03Kiosk($scope.command.payee.idFacturador).then(function(data){$scope.payeeDetail=data,$state.go("kiosk.pts.detail_cfe"),PumaService.connect().then(function(){return PumaService.readBarcode()}).then(function(result){console.log("Read Barcode result: "+result),$scope.command.ref=result.data,$scope.command.dueDate=moment(result.data.substr(14,6),"YYMMDD").format("YYYY-MM-DD"),$scope.command.amount=Number(result.data.substr(20,9)).toFixed(2)})["finally"](function(){PumaService.disconnect()})})["catch"](function(data){$scope.errorMessage=data.CHRmu,$("#modalErrorMessage").modal("show")}):McaPaymentService.getPayeeDetailKiosk($scope.command.payee.idFacturador).then(function(data){$scope.payee_detail=data,$state.go("kiosk.pts.detail")})["catch"](function(data){$scope.errorMessage=data.CHRmu,$("#modalErrorMessage").modal("show")})},$scope.digitoVerificadorB10=function(T){for(var M=0,S=1;T;T=Math.floor(T/10))S=(S+T%10*(9-M++%6))%11;return S?S-1:"K"},$scope.onPTSValidatePayment=function(){$scope.nipErrorConteo=0,$state.go("kiosk.pts.read_card"),$scope.iniciarSesion()},$scope.onProcessPayment=function(){$state.go("kiosk.pts.wait"),$scope.command.payee.idFacturador==ID_TELMEX||$scope.command.payee.idFacturador==ID_CFE?McaPaymentService.paymentRC03($scope.command).then(function(data){$scope.confirmation=data,$state.go("kiosk.pts.trans_ok")})["catch"](function(data){$scope.errorMessage=data.CHRmu,$state.go("kiosk.pts.trans_error")}):McaPaymentService.payment($scope.command).then(function(data){$scope.confirmation=data,$state.go("kiosk.pts.trans_ok")})["catch"](function(data){$scope.errorMessage=data.CHRmu,$state.go("kiosk.pts.trans_error")})},$scope.validatePayment=function(){$state.go("kiosk.pts.wait"),$scope.command.payee.idFacturador==ID_TELMEX?($scope.command.ref01=$scope.command.ref+$scope.command.dv,McaPaymentService.validateRC03($scope.command).then(function(data){$scope.validation=data,$state.go("kiosk.pts.confirm_rc03")})["catch"](function(data){$scope.errorMessage=data.CHRmu,$("#modalErrorMessage").modal("show"),$state.go("kiosk.pts.detail_telmex")})):$scope.command.payee.idFacturador==ID_CFE?($scope.command.ref01=$scope.command.ref,McaPaymentService.validateRC03($scope.command).then(function(data){$scope.validation=data,$state.go("kiosk.pts.confirm_rc03")})["catch"](function(data){$scope.errorMessage=data.CHRmu,$("#modalErrorMessage").modal("show"),$state.go("kiosk.pts.detail_cfe")})):McaPaymentService.validate($scope.command).then(function(data){$scope.validation=data,$state.go("kiosk.pts.confirm")})["catch"](function(data){$scope.errorMessage=data.CHRmu,$("#modalErrorMessage").modal("show"),$state.go("kiosk.pts.detail")})},$scope.onCancelar=function(){PumaService.cancelReadBarcode(),$state.go("kiosk.pts.payee")},$scope.onLogout=function(){Auth.logout(),$state.go("kiosk.finish")},$scope.updateNipCeldas=function(data){"*"===data&&$scope.np_arr.push(!0),4096===data&&$scope.np_arr.pop(),0===$scope.np_arr.length?($("#casilla_01").attr("src","assets/images/k_ast_01.png"),$("#casilla_02").attr("src","assets/images/k_ast_01.png"),$("#casilla_03").attr("src","assets/images/k_ast_01.png"),$("#casilla_04").attr("src","assets/images/k_ast_01.png")):1===$scope.np_arr.length?($("#casilla_01").attr("src","assets/images/k_ast_02.png"),$("#casilla_02").attr("src","assets/images/k_ast_01.png"),$("#casilla_03").attr("src","assets/images/k_ast_01.png"),$("#casilla_04").attr("src","assets/images/k_ast_01.png")):2===$scope.np_arr.length?($("#casilla_01").attr("src","assets/images/k_ast_02.png"),$("#casilla_02").attr("src","assets/images/k_ast_02.png"),$("#casilla_03").attr("src","assets/images/k_ast_01.png"),$("#casilla_04").attr("src","assets/images/k_ast_01.png")):3===$scope.np_arr.length?($("#casilla_01").attr("src","assets/images/k_ast_02.png"),$("#casilla_02").attr("src","assets/images/k_ast_02.png"),$("#casilla_03").attr("src","assets/images/k_ast_02.png"),$("#casilla_04").attr("src","assets/images/k_ast_01.png")):4===$scope.np_arr.length&&($("#casilla_01").attr("src","assets/images/k_ast_02.png"),$("#casilla_02").attr("src","assets/images/k_ast_02.png"),$("#casilla_03").attr("src","assets/images/k_ast_02.png"),$("#casilla_04").attr("src","assets/images/k_ast_02.png"))},$scope.iniciarSesion=function(){Auth.loginWincor(function(event){$scope.np_arr=[],$state.go("kiosk.pts.nip")},function(result){$scope.updateNipCeldas(result.data)},function(){$state.go("kiosk.pts.wait")}).then(function(data){$scope.nipErrorConteo=0,$scope.nipMessage="Ingresa tu NIP",$scope.errorMessage=null,$scope.userData=data,Principal.identity().then(function(account){$scope.account=account,$scope.isAuthenticated=Principal.isAuthenticated,$scope.validatePayment()})})["catch"](function(err){err&&"NUMERO DE NIP INVALIDO"===err.CHRmu?($scope.nipErrorConteo=$scope.nipErrorConteo+1,$scope.nipErrorConteo<3?$timeout(function(){$scope.nipMessage="NIP invalido, captura de nuevo tu NIP",$scope.np_arr=[],$scope.iniciarSesion()},2e3):($scope.nipErrorConteo=0,$scope.np_arr=[],$scope.nipMessage="Ingresa tu NIP",$scope.mensajeError="Limite de intentos",$state.go("kiosk.error"),$timeout(function(){$state.go("kiosk.home")},5e3))):err&&err.isTimeout?($scope.mensajeError="El tiempo de espera ha finalizado",$state.go("kiosk.timeout"),$timeout(function(){$state.go("kiosk.home")},5e3)):err&&-4===err.code?($scope.mensajeError="Se ha cancelado la operacion",$state.go("kiosk.error"),$timeout(function(){$state.go("kiosk.home")},5e3)):(console.log(err),$scope.mensajeError="El servicio no esta disponible por el momento",$state.go("kiosk.error"),$timeout(function(){$state.go("kiosk.home")},5e3))})},McaPaymentService.getPayeesFavoritos().then(function(data){$scope.payee_list=data.facturadores})}).constant("ID_TELMEX","1310").constant("ID_CFE","88924"),angular.module("SucursApps").config(function($stateProvider){$stateProvider.state("kiosk.tc",{parent:"kiosk",url:"/tc",data:{roles:["cliente"]},views:{"fullscreen@":{templateUrl:"scripts/app/kiosk/tc/kiosk-tc.html",controller:"KioskTcController"},"navbar@":{templateUrl:"scripts/components/navbar/navbar-kiosk.html"}}}).state("kiosk.tc.home",{parent:"kiosk.tc",url:"/home",templateUrl:"scripts/app/kiosk/tc/kiosk-tc-home.html"}).state("kiosk.tc.bin",{parent:"kiosk.tc",url:"/bin",templateUrl:"scripts/app/kiosk/tc/kiosk-tc-bin.html"}).state("kiosk.tc.bin_amex",{parent:"kiosk.tc",url:"/bin_amex",templateUrl:"scripts/app/kiosk/tc/kiosk-tc-bin-amex.html"}).state("kiosk.tc.amount",{parent:"kiosk.tc",url:"/amount",templateUrl:"scripts/app/kiosk/tc/kiosk-tc-amount.html"}).state("kiosk.tc.confirm",{parent:"kiosk.tc",url:"/confirm",templateUrl:"scripts/app/kiosk/tc/kiosk-tc-confirm.html"}).state("kiosk.tc.trans_ok",{parent:"kiosk.tc",url:"/ok",templateUrl:"scripts/app/kiosk/kiosk-trans-ok.html"}).state("kiosk.tc.trans_error",{parent:"kiosk.tc",url:"/ok",templateUrl:"scripts/app/kiosk/kiosk-trans-error.html"}).state("kiosk.tc.read_card",{parent:"kiosk.tc",url:"/read_card",templateUrl:"scripts/app/kiosk/kiosk-read-card.html"}).state("kiosk.tc.nip",{parent:"kiosk.tc",url:"/nip",templateUrl:"scripts/app/kiosk/kiosk-nip.html"}).state("kiosk.tc.nip_error",{parent:"kiosk.tc",url:"/nip_error",templateUrl:"scripts/app/kiosk/kiosk-nip-error.html"}).state("kiosk.tc.wait",{parent:"kiosk.tc",url:"/wait",templateUrl:"scripts/app/kiosk/kiosk-wait.html"}).state("kiosk.tc.error",{parent:"kiosk.tc",url:"/error",templateUrl:"scripts/app/kiosk/kiosk-error.html"}).state("kiosk.tc.blocked",{parent:"kiosk.tc",url:"/blocked",templateUrl:"scripts/app/kiosk/kiosk-nip-blocked.html"})}),angular.module("SucursApps").controller("KioskTcController",function($rootScope,$scope,$state,$timeout,Principal,McaPaymentService,Auth,PumaService,ID_BIXE,ID_OTROS,ID_AMEX){$scope.command={payee:{}},$scope.payee_detail=[],$scope.payeeDetail=[],$scope.validation={},$scope.account={},$scope.mensajeError="",$scope.onBIXEClick=function(){$scope.command.payee.idFacturador=ID_BIXE,$state.go("kiosk.tc.bin")},$scope.onAMEXClick=function(){$scope.command.payee.idFacturador=ID_AMEX,$state.go("kiosk.tc.bin_amex")},$scope.onOtrosClick=function(){$scope.command.payee.idFacturador=ID_OTROS,$state.go("kiosk.tc.bin")},$scope.onValidatePayment=function(){$scope.nipErrorConteo=0,$state.go("kiosk.tc.read_card"),$scope.iniciarSesion()},$scope.onPayment=function(){$state.go("kiosk.tc.wait"),McaPaymentService.payment($scope.command).then(function(data){$scope.confirmation=data,$state.go("kiosk.tc.trans_ok")})["catch"](function(data){$scope.errorMessage=data.CHRmu,$state.go("kiosk.tc.trans_error")})},$scope.validatePayment=function(){$state.go("kiosk.tc.wait"),McaPaymentService.validate($scope.command).then(function(data){$scope.validation=data,$state.go("kiosk.tc.confirm")})["catch"](function(data){$scope.errorMessage=data.CHRmu,$("#modalErrorMessage").modal("show"),$state.go("kiosk.tc.home")})},$scope.onCancelar=function(){PumaService.cancelReadBarcode(),$state.go("kiosk.tc.payee")},$scope.onLogout=function(){Auth.logout(),$state.go("kiosk.finish")},$scope.updateNipCeldas=function(data){"*"===data&&$scope.np_arr.push(!0),4096===data&&$scope.np_arr.pop(),0===$scope.np_arr.length?($("#casilla_01").attr("src","assets/images/k_ast_01.png"),$("#casilla_02").attr("src","assets/images/k_ast_01.png"),$("#casilla_03").attr("src","assets/images/k_ast_01.png"),$("#casilla_04").attr("src","assets/images/k_ast_01.png")):1===$scope.np_arr.length?($("#casilla_01").attr("src","assets/images/k_ast_02.png"),$("#casilla_02").attr("src","assets/images/k_ast_01.png"),$("#casilla_03").attr("src","assets/images/k_ast_01.png"),$("#casilla_04").attr("src","assets/images/k_ast_01.png")):2===$scope.np_arr.length?($("#casilla_01").attr("src","assets/images/k_ast_02.png"),$("#casilla_02").attr("src","assets/images/k_ast_02.png"),$("#casilla_03").attr("src","assets/images/k_ast_01.png"),$("#casilla_04").attr("src","assets/images/k_ast_01.png")):3===$scope.np_arr.length?($("#casilla_01").attr("src","assets/images/k_ast_02.png"),$("#casilla_02").attr("src","assets/images/k_ast_02.png"),$("#casilla_03").attr("src","assets/images/k_ast_02.png"),$("#casilla_04").attr("src","assets/images/k_ast_01.png")):4===$scope.np_arr.length&&($("#casilla_01").attr("src","assets/images/k_ast_02.png"),$("#casilla_02").attr("src","assets/images/k_ast_02.png"),$("#casilla_03").attr("src","assets/images/k_ast_02.png"),$("#casilla_04").attr("src","assets/images/k_ast_02.png"));
},$scope.iniciarSesion=function(){Auth.loginWincor(function(event){$scope.np_arr=[],$state.go("kiosk.tc.nip")},function(result){$scope.updateNipCeldas(result.data)},function(){$state.go("kiosk.tc.wait")}).then(function(data){$scope.nipErrorConteo=0,$scope.nipMessage="Ingresa tu NIP",$scope.errorMessage=null,$scope.userData=data,Principal.identity().then(function(account){$scope.account=account,$scope.isAuthenticated=Principal.isAuthenticated,$scope.validatePayment()})})["catch"](function(err){err&&"NUMERO DE NIP INVALIDO"===err.CHRmu?($scope.nipErrorConteo=$scope.nipErrorConteo+1,$scope.nipErrorConteo<3?$timeout(function(){$scope.nipMessage="NIP invalido, captura de nuevo tu NIP",$scope.np_arr=[],$scope.iniciarSesion()},2e3):($scope.nipErrorConteo=0,$scope.np_arr=[],$scope.nipMessage="Ingresa tu NIP",$scope.mensajeError="Limite de intentos",$state.go("kiosk.error"),$timeout(function(){$state.go("kiosk.home")},5e3))):err&&err.isTimeout?($scope.mensajeError="El tiempo de espera ha finalizado",$state.go("kiosk.timeout"),$timeout(function(){$state.go("kiosk.home")},5e3)):err&&-4===err.code?($scope.mensajeError="Se ha cancelado la operacion",$state.go("kiosk.error"),$timeout(function(){$state.go("kiosk.home")},5e3)):(console.log(err),$scope.mensajeError="El servicio no esta disponible por el momento",$state.go("kiosk.error"),$timeout(function(){$state.go("kiosk.home")},5e3))})}}).constant("ID_BIXE","165").constant("ID_OTROS","165").constant("ID_AMEX","2230"),angular.module("SucursApps").config(function($stateProvider){$stateProvider.state("kiosk.trans",{parent:"kiosk",url:"/trans",data:{roles:["cliente"]},views:{"fullscreen@":{templateUrl:"scripts/app/kiosk/trans/kiosk-trans.html",controller:"KioskTransController"},"navbar@":{templateUrl:"scripts/components/navbar/navbar-kiosk.html"}}}).state("kiosk.trans.home",{parent:"kiosk.trans",url:"/home",templateUrl:"scripts/app/kiosk/trans/kiosk-trans-home.html"}).state("kiosk.trans.confirm",{parent:"kiosk.trans",url:"/confirm",templateUrl:"scripts/app/kiosk/trans/kiosk-trans-confirm.html"}).state("kiosk.trans.error",{parent:"kiosk.trans",url:"/error",templateUrl:"scripts/app/kiosk/kiosk-trans-error.html"}).state("kiosk.trans.ok",{parent:"kiosk.trans",url:"/ok",templateUrl:"scripts/app/kiosk/kiosk-trans-ok.html"}).state("kiosk.trans.wait",{parent:"kiosk.trans",url:"/wait",templateUrl:"scripts/app/kiosk/kiosk-wait.html"})}),angular.module("SucursApps").controller("KioskTransController",function($rootScope,$scope,$state,$timeout,Principal,Auth,McaDetalleCuentaService,McaTransferService){$scope.command={},$scope.account={},$scope.listBancos=[],$scope.isSpeiAccount=!1,$scope.onConfirmContinuarClick=function(){$state.go("kiosk.trans.wait"),18===$scope.command.destAccount.length?($scope.command.clabe=$scope.command.destAccount,$scope.command.reference=moment().format("YYMMDD"),$scope.command.description="Transferencia SPEI",$scope.command.beneficiario="Beneficiario SPEI",McaTransferService.doTransferSPEI($scope.command,$scope.ACCOUNT_TYPE).then(function(data){$scope.confirmation=data,$state.go("kiosk.trans.ok")})["catch"](function(data){$scope.errorMessage=data.CHRmu,$state.go("kiosk.trans.error")})):($scope.command.accountNumber=$scope.command.destAccount,McaTransferService.doTransferThird($scope.command,$scope.ACCOUNT_TYPE).then(function(data){$scope.confirmation=data,$state.go("kiosk.trans.ok")})["catch"](function(data){$scope.errorMessage=data.CHRmu,$state.go("kiosk.trans.error")}))},$scope.onLogout=function(){Auth.logout(),$state.go("kiosk.finish")},Principal.identity().then(function(account){$scope.account=account,$scope.isAuthenticated=Principal.isAuthenticated,McaDetalleCuentaService.getAccount().then(function(data){$scope.command.datosPersonales=data.datosPersonales,$scope.command.consultaSaldosBXI=data.consultaSaldosBXI}),McaTransferService.getBancos().then(function(data){$scope.listBancos=data})})}),angular.module("SucursApps").config(function($stateProvider){$stateProvider.state("kiosk.mc",{parent:"kiosk",url:"/mc","abstract":!0,data:{roles:["cliente"]},views:{"fullscreen@":{templateUrl:"scripts/app/kiosk/mc/kiosk-mc.html",controller:"KioskMcController"},"navbar@":{templateUrl:"scripts/components/navbar/navbar-kiosk.html"}}}).state("kiosk.mc.home",{parent:"kiosk.mc",url:"/home",templateUrl:"scripts/app/kiosk/mc/kiosk-mc-home.html"}).state("kiosk.mc.wait",{parent:"kiosk.mc",url:"/wait",templateUrl:"scripts/app/kiosk/kiosk-wait.html"}).state("kiosk.mc.error",{parent:"kiosk.mc",url:"/error",templateUrl:"scripts/app/kiosk/kiosk-trans-error.html"}).state("kiosk.mc.ok",{parent:"kiosk.mc",url:"/ok",templateUrl:"scripts/app/kiosk/kiosk-trans-ok.html"}).state("kiosk.mc.read_card",{parent:"kiosk.mc",url:"/read_card",templateUrl:"scripts/app/kiosk/kiosk-read-card.html"}).state("kiosk.mc.nip",{parent:"kiosk.mc",url:"/nip",templateUrl:"scripts/app/kiosk/kiosk-nip.html"}).state("kiosk.mc.nip_error",{parent:"kiosk.mc",url:"/nip_error",templateUrl:"scripts/app/kiosk/kiosk-nip-error.html"})}),angular.module("SucursApps").controller("KioskMcController",function($rootScope,$scope,$state,$timeout,Principal,Auth,PumaService,McaEstadoCuentaService,McaCuentaService){$scope.command={},$scope.account={},$scope.accountBeneficiaries={},$scope.currentInfo={},$scope.onHomeActivateEmailClick=function(){$scope.nipErrorConteo=0,$state.go("kiosk.mc.read_card"),$scope.iniciarSesion("kiosk.mc.ae.home")},$scope.onHomeUpdateEmailClick=function(){$scope.nipErrorConteo=0,$state.go("kiosk.mc.read_card"),$scope.iniciarSesion("kiosk.mc.au.home")},$scope.onHomeActualizarBeneficiariosClick=function(){$scope.nipErrorConteo=0,$state.go("kiosk.mc.read_card"),$scope.iniciarSesion("kiosk.mc.benef.home")},$scope.onHomeActualizarDomicilioClick=function(){$scope.nipErrorConteo=0,$state.go("kiosk.mc.read_card"),$scope.iniciarSesion("kiosk.mc.addr.home")},$scope.onCancelar=function(){PumaService.cancelReadBarcode(),$state.go("kiosk.mc.home")},$scope.onLogout=function(){Auth.logout(),$state.go("kiosk.finish")},$scope.updateNipCeldas=function(data){"*"===data&&$scope.np_arr.push(!0),4096===data&&$scope.np_arr.pop(),0===$scope.np_arr.length?($("#casilla_01").attr("src","assets/images/k_ast_01.png"),$("#casilla_02").attr("src","assets/images/k_ast_01.png"),$("#casilla_03").attr("src","assets/images/k_ast_01.png"),$("#casilla_04").attr("src","assets/images/k_ast_01.png")):1===$scope.np_arr.length?($("#casilla_01").attr("src","assets/images/k_ast_02.png"),$("#casilla_02").attr("src","assets/images/k_ast_01.png"),$("#casilla_03").attr("src","assets/images/k_ast_01.png"),$("#casilla_04").attr("src","assets/images/k_ast_01.png")):2===$scope.np_arr.length?($("#casilla_01").attr("src","assets/images/k_ast_02.png"),$("#casilla_02").attr("src","assets/images/k_ast_02.png"),$("#casilla_03").attr("src","assets/images/k_ast_01.png"),$("#casilla_04").attr("src","assets/images/k_ast_01.png")):3===$scope.np_arr.length?($("#casilla_01").attr("src","assets/images/k_ast_02.png"),$("#casilla_02").attr("src","assets/images/k_ast_02.png"),$("#casilla_03").attr("src","assets/images/k_ast_02.png"),$("#casilla_04").attr("src","assets/images/k_ast_01.png")):4===$scope.np_arr.length&&($("#casilla_01").attr("src","assets/images/k_ast_02.png"),$("#casilla_02").attr("src","assets/images/k_ast_02.png"),$("#casilla_03").attr("src","assets/images/k_ast_02.png"),$("#casilla_04").attr("src","assets/images/k_ast_02.png"))},$scope.iniciarSesion=function(toState){Auth.loginWincor(function(event){$scope.np_arr=[],$state.go("kiosk.mc.nip")},function(result){$scope.updateNipCeldas(result.data)},function(){$state.go("kiosk.mc.wait")}).then(function(data){$scope.nipErrorConteo=0,$scope.nipMessage="Ingresa tu NIP",$scope.errorMessage=null,$scope.userData=data,Principal.identity().then(function(account){$scope.account=account,$scope.isAuthenticated=Principal.isAuthenticated,angular.isFunction(toState)?toState():$state.go(toState)})})["catch"](function(err){err&&"NUMERO DE NIP INVALIDO"===err.CHRmu?($scope.nipErrorConteo=$scope.nipErrorConteo+1,$scope.nipErrorConteo<3?$timeout(function(){$scope.nipMessage="NIP invalido, captura de nuevo tu NIP",$scope.np_arr=[],$scope.iniciarSesion(toState)},2e3):($scope.nipErrorConteo=0,$scope.np_arr=[],$scope.nipMessage="Ingresa tu NIP",$scope.mensajeError="Limite de intentos",$state.go("kiosk.error"),$timeout(function(){$state.go("kiosk.home")},5e3))):err&&err.isTimeout?($scope.mensajeError="El tiempo de espera ha finalizado",$state.go("kiosk.timeout"),$timeout(function(){$state.go("kiosk.home")},5e3)):err&&-4===err.code?($scope.mensajeError="Se ha cancelado la operacion",$state.go("kiosk.error"),$timeout(function(){$state.go("kiosk.home")},5e3)):(console.log(err),$scope.mensajeError="El servicio no esta disponible por el momento",$state.go("kiosk.error"),$timeout(function(){$state.go("kiosk.home")},5e3))})}}),angular.module("SucursApps").config(function($stateProvider){$stateProvider.state("kiosk.mc.benef",{parent:"kiosk.mc",url:"/benef","abstract":!0,resolve:{authorize:["Auth",function(Auth){return Auth.authorize(void 0,"kiosk.home")}]},views:{"fullscreen@":{templateUrl:"scripts/app/kiosk/shared/kiosk-template.html",controller:"KioskMcBenefController"},"navbar@":{templateUrl:"scripts/components/navbar/navbar-kiosk-logged.html",controller:"NavbarKioskController"}}}).state("kiosk.mc.benef.home",{parent:"kiosk.mc.benef",url:"/home",templateUrl:"scripts/app/kiosk/mc/benef/kiosk-mc-benef-home.html"}).state("kiosk.mc.benef.add",{parent:"kiosk.mc.benef",url:"/add",templateUrl:"scripts/app/kiosk/mc/benef/kiosk-mc-benef-add.html"}).state("kiosk.mc.benef.add-2",{parent:"kiosk.mc.benef",url:"/add-2",templateUrl:"scripts/app/kiosk/mc/benef/kiosk-mc-benef-add-2.html"}).state("kiosk.mc.benef.edit",{parent:"kiosk.mc.benef",url:"/edit",templateUrl:"scripts/app/kiosk/mc/benef/kiosk-mc-benef-edit.html"}).state("kiosk.mc.benef.edit-2",{parent:"kiosk.mc.benef",url:"/edit-2",templateUrl:"scripts/app/kiosk/mc/benef/kiosk-mc-benef-edit-2.html"}).state("kiosk.mc.benef.wait",{parent:"kiosk.mc.benef",url:"/wait",templateUrl:"scripts/app/kiosk/kiosk-wait.html"}).state("kiosk.mc.benef.error",{parent:"kiosk.mc.benef",url:"/error",templateUrl:"scripts/app/kiosk/kiosk-trans-error.html"}).state("kiosk.mc.benef.ok",{parent:"kiosk.mc.benef",url:"/ok",templateUrl:"scripts/app/kiosk/kiosk-trans-ok.html"})}),angular.module("SucursApps").controller("KioskMcBenefController",function($rootScope,$scope,$state,$timeout,$q,Principal,Auth,PumaService,McaEstadoCuentaService,McaCuentaService){$scope.command={},$scope.showDomicilio=!0,$scope.estados=[],$scope.municipios=[],$scope.accountBeneficiaries=[],$scope.idDomicilioTitular=!1,$scope.onEditarBeneficiarioClick=function(item){$scope.command=item,$scope.command.fechaNacimiento=moment($scope.command.fechaNacimiento,"YYYYMMDD").format("YYYY-MM-DD"),$scope.command.registroFederal=item.registroFederal.trim(),angular.forEach($scope.estados,function(value){value.id==$scope.command.codigoEstado&&($scope.command.estado_seleccionado=value,angular.forEach($scope.command.estado_seleccionado.municipios.municipio,function(value){value.id==$scope.command.codigoDelegacion&&($scope.command.municipio_seleccionado=value)}))}),$state.go("kiosk.mc.benef.edit")},$scope.onBeneficiariosAgregarClick=function(item){$state.go("kiosk.mc.benef.add")},$scope.onEditGuardarBeneficiarioClick=function(){$scope.command.fechaNacimiento=moment($scope.command.fechaNacimiento,"YYYY-MM-DD").format("YYYYMMDD"),McaCuentaService.updateBeneficiary($scope.command).then(function(data){$scope.confirm=data,$state.go("kiosk.mc.benef.ok")})["catch"](function(data){$state.go("kiosk.mc.benef.error"),$scope.mensajeError=data.CHRmu})},$scope.onAddGuardarBeneficiarioClick=function(){$scope.command.fechaNacimiento=moment($scope.command.fechaNacimiento,"YYYY-MM-DD").format("YYYYMMDD"),$scope.command.pais="MEX",McaCuentaService.addBeneficiary($scope.command).then(function(data){$scope.confirm=data,$state.go("kiosk.mc.benef.ok")})["catch"](function(data){$state.go("kiosk.mc.benef.error"),$scope.mensajeError=data.CHRmu})},$scope.validaPorcentajeBenef=function(newVal,oldVal){var deferred=$q.defer(),totalProcentajes=0;return angular.forEach($scope.accountBeneficiaries.datosBeneficiarioArray,function(item,key){console.log(key+": "+item.porcentajeBenef),totalProcentajes+=item.porcentajeBenef}),0===newVal&&deferred.reject("El porcentaje debe ser mayor a 0"),totalProcentajes>100&&deferred.reject("El porcentaje total de beneficiarios no debe exceder de 100"),deferred.promise},$scope.onBeneficiarioClick=function(data){console.log("onBeneficiarioClick: "+data)},Principal.identity().then(function(account){$scope.account=account,$scope.isAuthenticated=Principal.isAuthenticated,$scope.command={},$scope.$watch("command.porcentajeBenef",function(newVal,oldVal){$scope.validaPorcentajeBenef(newVal,oldVal)["catch"](function(value){$scope.errorMessage=value,$("#modalErrorMessage").modal("show")})},!0),McaCuentaService.listAccountBeneficiaries().then(function(data){$scope.accountBeneficiaries=data})["catch"](function(data){$state.go("kiosk.mc.benef.error"),$scope.mensajeError=data.CHRmu}),McaCuentaService.getEstadosMexico().then(function(data){$scope.estados=data.mexico.estado})}),$scope.onLogout=function(){Auth.logout(),$state.go("kiosk.finish")}}),angular.module("SucursApps").config(function($stateProvider){$stateProvider.state("kiosk.mc.addr",{parent:"kiosk.mc",url:"/addr","abstract":!0,resolve:{authorize:["Auth",function(Auth){return Auth.authorize(void 0,"kiosk.home")}]},views:{"fullscreen@":{templateUrl:"scripts/app/kiosk/shared/kiosk-template.html",controller:"KioskMcAddrController"},"navbar@":{templateUrl:"scripts/components/navbar/navbar-kiosk-logged.html",controller:"NavbarKioskController"}}}).state("kiosk.mc.addr.home",{parent:"kiosk.mc.addr",url:"/home",templateUrl:"scripts/app/kiosk/mc/addr/kiosk-mc-addr-home.html"}).state("kiosk.mc.addr.wait",{parent:"kiosk.mc.addr",url:"/wait",templateUrl:"scripts/app/kiosk/kiosk-wait.html"}).state("kiosk.mc.addr.error",{parent:"kiosk.mc.addr",url:"/error",templateUrl:"scripts/app/kiosk/kiosk-trans-error.html"}).state("kiosk.mc.addr.ok",{parent:"kiosk.mc.addr",url:"/ok",templateUrl:"scripts/app/kiosk/kiosk-trans-ok.html"})}),angular.module("SucursApps").controller("KioskMcAddrController",function($rootScope,$scope,$state,$timeout,$q,Principal,Auth,McaCuentaService,McaEstadoCuentaService){$scope.command={},$scope.estados=[],$scope.municipios=[],$scope.onActualizarClick=function(){McaCuentaService.updateDomAlt($scope.command).then(function(data){$scope.confirm=data,$state.go("kiosk.mc.addr.ok")})["catch"](function(data){$state.go("kiosk.mc.addr.error"),$scope.mensajeError=data.CHRmu})},$scope.viewActualizarDomicilio=function(){McaCuentaService.getAccountAddress().then(function(data){$scope.command=data.respDetalleDomicilios[0],McaCuentaService.getEstadosMexico().then(function(data){$scope.estados=data.mexico.estado,angular.forEach($scope.estados,function(value){value.id==$scope.command.codigoEstado&&($scope.command.estado_seleccionado=value,angular.forEach($scope.command.estado_seleccionado.municipios.municipio,function(value){value.id==$scope.command.delegacionmunicipio&&($scope.command.municipio_seleccionado=value)}))})})})},Principal.identity().then(function(account){$scope.account=account,$scope.isAuthenticated=Principal.isAuthenticated,$scope.command={},McaEstadoCuentaService.consultaEnvio().then(function(data){"A"===data.statusImpresion?$scope.viewActualizarDomicilio():($scope.mensajeError="Este servicio no esta disponible para tu cuenta",$state.go("kiosk.mc.addr.error"))})}),$scope.onLogout=function(){Auth.logout(),$state.go("kiosk.finish")}});